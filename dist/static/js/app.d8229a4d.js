(function(){"use strict";var e={678:function(e,t,s){s.r(t);class r{constructor(){this.recorder=null,this.events=[],this.isRecording=!1,this.listeners=[],this.recordingId=null,this.recordingStartTime=null,this.maxRecordingDuration=18e4,console.log("GlobalRecorderï¼šåˆå§‹åŒ–å®Œæˆ")}static getInstance(){return r.instance||(r.instance=new r),r.instance}addListener(e){this.listeners.push(e)}removeListener(e){const t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}emit(e,t){this.listeners.forEach((s=>{try{s(e,t)}catch(r){console.error("ç›‘å¬å™¨æ‰§è¡Œé”™è¯¯:",r)}}))}async startRecording(e={}){if(this.isRecording)return console.warn("å½•åˆ¶å·²åœ¨è¿›è¡Œä¸­"),!1;try{if(console.log("GlobalRecorderï¼šå¼€å§‹å½•åˆ¶..."),this.recordingId=`rec_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,this.recordingStartTime=Date.now(),this.events=[],"undefined"===typeof window.rrweb)throw new Error("rrwebåº“æœªæ‰¾åˆ°ï¼Œè¯·ç¡®ä¿å·²æ­£ç¡®å¼•å…¥");if(this.recorder=window.rrweb.record({emit:e=>{this.events.push(e),console.log("GlobalRecorderï¼šè®°å½•äº‹ä»¶ï¼Œç±»å‹:",e.type,"æ€»æ•°:",this.events.length)},checkoutEveryNms:3e4,recordCanvas:!0,collectFonts:!0,inlineStylesheet:!0,...e}),this.recorder&&"function"===typeof this.recorder)return this.isRecording=!0,this.emit("started",{recordingId:this.recordingId}),console.log("GlobalRecorderï¼šå½•åˆ¶å¼€å§‹æˆåŠŸ"),!0;throw new Error("å½•åˆ¶å™¨åˆå§‹åŒ–å¤±è´¥")}catch(t){return console.error("GlobalRecorderï¼šå¼€å§‹å½•åˆ¶å¤±è´¥:",t),this.isRecording=!1,this.emit("error",t),!1}}startTimeoutTimer(){this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=setTimeout((()=>{this.handleRecordingTimeout()}),this.maxRecordingDuration),console.log("å…¨å±€å½•åˆ¶å™¨ï¼šè¶…æ—¶å®šæ—¶å™¨å·²å¯åŠ¨ï¼Œ",this.maxRecordingDuration/1e3,"ç§’åè¶…æ—¶")}async handleRecordingTimeout(){if(console.log("å…¨å±€å½•åˆ¶å™¨ï¼šå½•åˆ¶è¶…æ—¶ï¼Œè‡ªåŠ¨åœæ­¢å½•åˆ¶"),this.isRecording)try{await this.stopRecording(),this.emit("timeout",{duration:this.maxRecordingDuration,message:"å½•åˆ¶æ—¶é—´è¶…è¿‡3åˆ†é’Ÿï¼Œå·²è‡ªåŠ¨åœæ­¢"})}catch(e){console.error("è¶…æ—¶åœæ­¢å½•åˆ¶å¤±è´¥:",e)}}clearTimeoutTimer(){this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null,console.log("å…¨å±€å½•åˆ¶å™¨ï¼šè¶…æ—¶å®šæ—¶å™¨å·²æ¸…é™¤"))}async stopRecording(){if(!this.isRecording)return console.warn("å½•åˆ¶æœªå¼€å§‹"),null;try{console.log("GlobalRecorderï¼šåœæ­¢å½•åˆ¶..."),this.recorder&&"function"===typeof this.recorder&&this.recorder(),this.isRecording=!1;const e=[...this.events];return console.log("GlobalRecorderï¼šå½•åˆ¶åœæ­¢æˆåŠŸ, äº‹ä»¶æ•°é‡:",e.length),console.log("GlobalRecorderï¼šå‰3ä¸ªäº‹ä»¶:",e.slice(0,3)),this.emit("stopped",{events:e}),e}catch(e){return console.error("GlobalRecorderï¼šåœæ­¢å½•åˆ¶å¤±è´¥:",e),this.isRecording=!1,this.emit("error",e),null}}getRecordingStatus(){return{isRecording:this.isRecording,recordingId:this.recordingId,eventCount:this.events.length,startTime:this.recordingStartTime}}async stopRecordingAndProcess(e={}){try{console.log("GlobalRecorderï¼šåœæ­¢å½•åˆ¶å¹¶å¤„ç†æ•°æ®...");const t=await this.stopRecording();if(!t||0===t.length)return{success:!1,error:"å½•åˆ¶æ•°æ®ä¸ºç©º"};console.log("GlobalRecorderï¼šå¼€å§‹å¤„ç†å½•åˆ¶æ•°æ®ï¼Œäº‹ä»¶æ•°é‡:",t.length);const s=t.filter((e=>e&&void 0!==e.type&&e.timestamp));if(0===s.length)return{success:!1,error:"å½•åˆ¶æ•°æ®æ ¼å¼æ— æ•ˆ"};console.log("GlobalRecorderï¼šæœ‰æ•ˆäº‹ä»¶æ•°é‡:",s.length);const r=this.recordingStartTime?Date.now()-this.recordingStartTime:0,a={recordingId:this.recordingId,events:s,startTime:new Date(this.recordingStartTime).toISOString(),endTime:(new Date).toISOString(),duration:r,totalEvents:s.length,...e},o=JSON.stringify(a),i=new Blob([o]).size;if(console.log("GlobalRecorderï¼šåŸå§‹æ•°æ®å¤§å°:",i,"å­—èŠ‚"),"undefined"===typeof window.pako)throw new Error("pakoå‹ç¼©åº“æœªæ‰¾åˆ°ï¼Œè¯·ç¡®ä¿å·²æ­£ç¡®å¼•å…¥");const n=window.pako.gzip(o),l=n.length,c=(100*(1-l/i)).toFixed(2)+"%";console.log("GlobalRecorderï¼šå‹ç¼©åå¤§å°:",l,"å­—èŠ‚ï¼Œå‹ç¼©ç‡:",c);const d={...a,compressedEvents:Array.from(n)},u={success:!0,recordingResult:{events:s,duration:r,eventCount:s.length},data:{recordingId:this.recordingId,startTime:a.startTime,endTime:a.endTime,duration:r,finalData:d,sizes:{original:i,compressed:l},compressionRatio:c}};return console.log("GlobalRecorderï¼šæ•°æ®å¤„ç†å®Œæˆ"),u}catch(t){return console.error("GlobalRecorderï¼šå¤„ç†å½•åˆ¶æ•°æ®å¤±è´¥:",t),{success:!1,error:t.message}}}async finishRecording(e={}){console.log("GlobalRecorderï¼šæ”¶åˆ°å®Œæˆå½•åˆ¶è¯·æ±‚ï¼Œä¸šåŠ¡æ•°æ®:",e);try{const t=await this.stopRecordingAndProcess(e);return this.emit("recording-finished",t),t}catch(t){console.error("GlobalRecorderï¼šå®Œæˆå½•åˆ¶å¤±è´¥:",t);const e={success:!1,error:t.message,message:"å½•åˆ¶å®Œæˆå¤„ç†å¤±è´¥"};return this.emit("recording-finished",e),e}}}t["default"]=r},6164:function(e,t,s){var r=s(5471),a=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},o=[],i={name:"App"},n=i,l=s(1656),c=(0,l.A)(n,a,o,!1,null,null,null),d=c.exports,u=s(173),p=function(){var e=this,t=e._self._c;return t("div",{staticClass:"simple-record"},[t("van-nav-bar",{attrs:{title:"é¡µé¢å½•åˆ¶",fixed:""}}),t("div",{staticClass:"content"},[t("div",{staticClass:"control-section"},[t("div",{staticClass:"status-info"},[t("div",{staticClass:"status-text"},[e.isRecording||e.recordData?e._e():t("span",[e._v("å‡†å¤‡å½•åˆ¶")]),e.isRecording?t("span",[e._v("æ­£åœ¨å½•åˆ¶ä¸­...")]):e._e(),!e.isRecording&&e.recordData?t("span",[e._v("å½•åˆ¶å®Œæˆ")]):e._e()]),e.isRecording?t("div",{staticClass:"recording-indicator"},[t("div",{staticClass:"red-dot"}),t("span",[e._v("REC")])]):e._e()]),t("div",{staticClass:"control-buttons"},[e.isRecording||e.recordData?e._e():t("van-button",{attrs:{type:"primary",size:"large",block:"",round:"",loading:e.loading,icon:"video-o"},on:{click:e.startRecord}},[e._v(" å¼€å§‹å½•åˆ¶ ")]),e.isRecording?t("van-button",{attrs:{type:"danger",size:"large",block:"",round:"",loading:e.loading,icon:"stop"},on:{click:e.stopRecord}},[e._v(" åœæ­¢å½•åˆ¶ ")]):e._e(),!e.isRecording&&e.recordData?t("div",{staticClass:"action-buttons"},[t("van-button",{attrs:{type:"primary",size:"large",round:"",icon:"play"},on:{click:e.playRecord}},[e._v(" æ’­æ”¾å›æ”¾ ")]),t("van-button",{attrs:{type:"info",size:"large",round:"",loading:e.downloading,icon:"download"},on:{click:e.downloadCompressedFile}},[e._v(" ä¸‹è½½å‹ç¼©æ–‡ä»¶ ")]),t("van-button",{attrs:{type:"success",size:"large",round:"",loading:e.uploading,icon:"cloud-upload"},on:{click:e.uploadRecord}},[e._v(" ä¸Šä¼ å½•åˆ¶ ")]),t("van-button",{attrs:{size:"large",round:"",icon:"refresh"},on:{click:e.resetRecord}},[e._v(" é‡æ–°å½•åˆ¶ ")])],1):e._e()],1)]),e.recordData?t("div",{staticClass:"record-info"},[t("van-cell-group",{attrs:{title:"å½•åˆ¶ä¿¡æ¯"}},[t("van-cell",{attrs:{title:"å½•åˆ¶æ—¶é•¿",value:e.recordDuration}}),t("van-cell",{attrs:{title:"äº‹ä»¶æ•°é‡",value:e.recordData.events?e.recordData.events.length:0}}),t("van-cell",{attrs:{title:"æ•°æ®å¤§å°",value:e.recordSize}}),t("van-cell",{attrs:{title:"å½•åˆ¶æ—¶é—´",value:e.recordTime}})],1)],1):e._e(),e.showPlayer?t("div",{staticClass:"player-section"},[t("div",{staticClass:"player-header"},[t("h3",[e._v("å½•åˆ¶å›æ”¾")]),t("van-button",{attrs:{size:"small",icon:"cross"},on:{click:e.closePlayer}},[e._v("å…³é—­")])],1),t("div",{ref:"playerContainer",staticClass:"player-container"}),t("div",{staticClass:"player-controls"},[t("van-button",{attrs:{size:"small",icon:e.isPlaying?"pause":"play"},on:{click:e.togglePlay}},[e._v(" "+e._s(e.isPlaying?"æš‚åœ":"æ’­æ”¾")+" ")]),t("van-button",{attrs:{size:"small",icon:"replay"},on:{click:e.resetPlayer}},[e._v("é‡æ’­")])],1)]):e._e(),t("div",{staticClass:"demo-section"},[t("van-cell-group",{attrs:{title:"æ¼”ç¤ºæ“ä½œåŒºåŸŸ"}},[t("van-cell",{attrs:{title:"ç‚¹å‡»è¿™é‡Œ","is-link":""},on:{click:e.demoClick}}),t("van-field",{attrs:{label:"è¾“å…¥æ–‡æœ¬",placeholder:"åœ¨è¿™é‡Œè¾“å…¥ä¸€äº›æ–‡å­—"},model:{value:e.demoText,callback:function(t){e.demoText=t},expression:"demoText"}}),t("van-cell",{attrs:{title:"åˆ‡æ¢å¼€å…³"},scopedSlots:e._u([{key:"right-icon",fn:function(){return[t("van-switch",{model:{value:e.demoSwitch,callback:function(t){e.demoSwitch=t},expression:"demoSwitch"}})]},proxy:!0}])})],1),t("div",{staticClass:"demo-buttons"},[t("van-button",{attrs:{type:"primary"},on:{click:e.demoAlert}},[e._v("æ˜¾ç¤ºå¼¹çª—")]),t("van-button",{attrs:{type:"warning"},on:{click:e.demoToast}},[e._v("æ˜¾ç¤ºæç¤º")])],1)],1),t("div",{staticClass:"navigation-section"},[t("van-cell-group",{attrs:{title:"å½•åˆ¶æ¨¡å¼"}},[t("van-cell",{attrs:{title:"å¤šé¡µé¢å½•åˆ¶","is-link":""},on:{click:e.goToMultiPage}})],1)],1)])],1)},h=[],m=(s(2505),{name:"SimpleRecord",data(){return{isRecording:!1,loading:!1,uploading:!1,downloading:!1,recordData:null,recordTime:"",stopFn:null,events:[],showPlayer:!1,player:null,isPlaying:!1,demoText:"",demoSwitch:!1}},computed:{recordDuration(){if(!this.recordData||!this.recordData.metadata)return"0ç§’";const e=Math.round(this.recordData.metadata.duration/1e3);return`${e}ç§’`},recordSize(){if(!this.recordData)return"0KB";const e=JSON.stringify(this.recordData).length;return`${(e/1024).toFixed(2)}KB`}},methods:{async startRecord(){this.loading=!0;try{if(await this.waitForPageLoad(),this.events=[],this.recordData=null,"undefined"===typeof window.rrweb)throw new Error("rrwebåº“æœªæ‰¾åˆ°ï¼Œè¯·ç¡®ä¿å·²æ­£ç¡®å¼•å…¥");console.log("SimpleRecordï¼šå¼€å§‹å½•åˆ¶ï¼Œrrwebç‰ˆæœ¬:",window.rrweb),this.stopFn=window.rrweb.record({emit:e=>{this.events.push(e),console.log("SimpleRecordï¼šè®°å½•äº‹ä»¶ï¼Œç±»å‹:",e.type,"æ€»æ•°:",this.events.length)},recordCanvas:!0,collectFonts:!0,checkoutEveryNms:3e4}),this.isRecording=!0,this.recordTime=(new Date).toLocaleString(),this.$toast.success("å¼€å§‹å½•åˆ¶"),console.log("SimpleRecordï¼šå½•åˆ¶å¯åŠ¨æˆåŠŸï¼ŒstopFn:",typeof this.stopFn)}catch(e){console.error("å½•åˆ¶å¤±è´¥:",e),this.$toast.fail("å½•åˆ¶å¤±è´¥: "+e.message)}finally{this.loading=!1}},async stopRecord(){this.loading=!0;try{this.stopFn&&(this.stopFn(),this.stopFn=null),this.isRecording=!1,this.recordData={events:this.events,metadata:{recordTime:Date.now(),eventsCount:this.events.length,duration:this.events.length>0?this.events[this.events.length-1].timestamp-this.events[0].timestamp:0}},this.$toast.success("å½•åˆ¶å®Œæˆ")}catch(e){console.error("åœæ­¢å½•åˆ¶å¤±è´¥:",e),this.$toast.fail("åœæ­¢å½•åˆ¶å¤±è´¥")}finally{this.loading=!1}},async playRecord(){if(this.recordData&&this.recordData.events)if(this.recordData.events.length<2)this.$toast.fail("å½•åˆ¶äº‹ä»¶ä¸è¶³ï¼Œæ— æ³•å›æ”¾");else{this.showPlayer=!0,await this.$nextTick();try{if(this.$refs.playerContainer&&(this.$refs.playerContainer.innerHTML=""),"undefined"===typeof window.rrwebPlayer)throw new Error("rrweb-playeråº“æœªæ‰¾åˆ°ï¼Œè¯·ç¡®ä¿å·²æ­£ç¡®å¼•å…¥");this.player=new window.rrwebPlayer({target:this.$refs.playerContainer,props:{events:this.recordData.events,width:375,height:400,autoPlay:!1,showController:!0,skipInactive:!0,speed:1}}),this.isPlaying=!1,this.$toast.success("å½•åˆ¶åŠ è½½æˆåŠŸ"),this.player&&this.player.addEventListener&&this.player.addEventListener("finish",(()=>{this.isPlaying=!1}))}catch(e){console.error("æ’­æ”¾å¤±è´¥:",e),this.$toast.fail("æ’­æ”¾å¤±è´¥: "+e.message),this.showPlayer=!1}}else this.$toast.fail("æ²¡æœ‰å½•åˆ¶æ•°æ®")},async uploadRecord(){if(this.recordData){this.uploading=!0;try{const e=await this.generateCompressedFile();if(!e.success)return void this.$toast.fail(e.message);console.log("ä¸Šä¼ æ•°æ®:",e.data),console.log("æ–‡ä»¶å¤§å°:",(e.size/1024/1024).toFixed(2)+"MB"),await new Promise((e=>setTimeout(e,2e3))),this.$toast.success(`ä¸Šä¼ æˆåŠŸ (${(e.size/1024/1024).toFixed(2)}MB)`)}catch(e){console.error("ä¸Šä¼ å¤±è´¥:",e),this.$toast.fail("ä¸Šä¼ å¤±è´¥")}finally{this.uploading=!1}}else this.$toast.fail("æ²¡æœ‰å½•åˆ¶æ•°æ®")},async generateCompressedFile(){try{const e=2097152;let t=this.optimizeRecordData(this.recordData);if("undefined"===typeof window.pako)throw new Error("pakoå‹ç¼©åº“æœªæ‰¾åˆ°ï¼Œè¯·ç¡®ä¿å·²æ­£ç¡®å¼•å…¥");const s=JSON.stringify(t),r=window.pako.gzip(s),a={compressed:!0,data:Array.from(r),originalSize:s.length,compressedSize:r.length,metadata:t.metadata,timestamp:(new Date).toISOString()},o=JSON.stringify(a),i=o.length;if(console.log("æ–‡ä»¶å¤§å°æ£€æŸ¥:"),console.log("åŸå§‹æ•°æ®:",(s.length/1024).toFixed(2)+"KB"),console.log("å‹ç¼©å:",(r.length/1024).toFixed(2)+"KB"),console.log("æœ€ç»ˆJSON:",(i/1024).toFixed(2)+"KB"),console.log("å‹ç¼©æ¯”:",(100*(1-r.length/s.length)).toFixed(2)+"%"),i>e){const s=this.furtherOptimizeData(t),r=window.pako.gzip(JSON.stringify(s)),a={compressed:!0,data:Array.from(r),originalSize:JSON.stringify(s).length,compressedSize:r.length,metadata:s.metadata,timestamp:(new Date).toISOString(),optimized:!0},o=JSON.stringify(a),i=o.length;return console.log("è¿›ä¸€æ­¥ä¼˜åŒ–å:",(i/1024).toFixed(2)+"KB"),i>e?{success:!1,message:`æ–‡ä»¶è¿‡å¤§ (${(i/1024/1024).toFixed(2)}MB)ï¼Œè¯·ç¼©çŸ­å½•åˆ¶æ—¶é—´`}:{success:!0,data:a,size:i,optimized:!0}}return{success:!0,data:a,size:i,optimized:!1}}catch(e){return console.error("å‹ç¼©å¤±è´¥:",e),{success:!1,message:"æ•°æ®å‹ç¼©å¤±è´¥"}}},optimizeRecordData(e){const t={events:e.events.map((e=>{const t={type:e.type,timestamp:e.timestamp};if(e.data)switch(t.data={},e.type){case 0:case 1:t.data={href:e.data.href,width:e.data.width,height:e.data.height};break;case 2:t.data={node:e.data.node,initialOffset:e.data.initialOffset};break;case 3:t.data={source:e.data.source,type:e.data.type,id:e.data.id},e.data.positions&&(t.data.positions=e.data.positions),e.data.texts&&(t.data.texts=e.data.texts),e.data.attributes&&(t.data.attributes=e.data.attributes);break;default:t.data=e.data}return t})),metadata:e.metadata};return t},furtherOptimizeData(e){const t=[],s=100;let r=0;return e.events.forEach((e=>{(0===e.type||1===e.type||2===e.type||e.timestamp-r>=s)&&(t.push(e),r=e.timestamp)})),{events:t,metadata:{...e.metadata,originalEventsCount:e.events.length,sampledEventsCount:t.length,optimized:!0}}},async downloadCompressedFile(){if(this.recordData){this.downloading=!0;try{const e=await this.generateCompressedFile();if(!e.success)return void this.$toast.fail(e.message);const t=(new Date).toISOString().replace(/[:.]/g,"-"),s=`record-compressed-${t}.json`,r=JSON.stringify(e.data,null,2);this.downloadFile(r,s,"application/json");const a=(e.size/1024).toFixed(2),o=e.optimized?" (å·²ä¼˜åŒ–)":"";this.$toast.success(`æ–‡ä»¶å·²ä¸‹è½½ (${a}KB)${o}`)}catch(e){console.error("ä¸‹è½½å¤±è´¥:",e),this.$toast.fail("ä¸‹è½½å¤±è´¥")}finally{this.downloading=!1}}else this.$toast.fail("æ²¡æœ‰å½•åˆ¶æ•°æ®")},downloadFile(e,t,s){const r=new Blob([e],{type:s}),a=URL.createObjectURL(r),o=document.createElement("a");o.href=a,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},resetRecord(){this.recordData=null,this.events=[],this.closePlayer(),this.$toast.success("å·²é‡ç½®ï¼Œå¯ä»¥é‡æ–°å½•åˆ¶")},togglePlay(){if(this.player)try{this.isPlaying?"function"===typeof this.player.pause&&this.player.pause():"function"===typeof this.player.play&&this.player.play(),this.isPlaying=!this.isPlaying}catch(e){console.warn("æ’­æ”¾æ§åˆ¶å‡ºé”™:",e),this.$toast.fail("æ’­æ”¾æ§åˆ¶å¤±è´¥")}},resetPlayer(){if(this.player)try{"function"===typeof this.player.goto?this.player.goto(0):"function"===typeof this.player.setCurrentTime&&this.player.setCurrentTime(0),this.isPlaying=!1}catch(e){console.warn("é‡ç½®æ’­æ”¾å™¨å‡ºé”™:",e),this.$toast.fail("é‡ç½®å¤±è´¥")}},closePlayer(){if(this.player){try{"function"===typeof this.player.destroy?this.player.destroy():"function"===typeof this.player.$destroy?this.player.$destroy():this.player.$el&&this.player.$el.parentNode&&this.player.$el.parentNode.removeChild(this.player.$el)}catch(e){console.warn("æ’­æ”¾å™¨é”€æ¯æ—¶å‡ºç°è­¦å‘Š:",e)}this.player=null}this.$refs.playerContainer&&(this.$refs.playerContainer.innerHTML=""),this.showPlayer=!1,this.isPlaying=!1},waitForPageLoad(){return new Promise((e=>{"complete"===document.readyState?setTimeout(e,500):window.addEventListener("load",(()=>{setTimeout(e,500)}))}))},demoClick(){this.$toast("ä½ ç‚¹å‡»äº†æ¼”ç¤ºæŒ‰é’®")},demoAlert(){this.$dialog.alert({message:"è¿™æ˜¯ä¸€ä¸ªæ¼”ç¤ºå¼¹çª—"})},demoToast(){this.$toast.success("è¿™æ˜¯ä¸€ä¸ªæ¼”ç¤ºæç¤º")},goToMultiPage(){this.$router.push("/multi-page")}},beforeDestroy(){this.isRecording&&this.stopFn&&this.stopFn(),this.closePlayer()}}),g=m,v=(0,l.A)(g,p,h,!1,null,"14bad980",null),y=(v.exports,function(){var e=this,t=e._self._c;return t("div",{staticClass:"multi-page-record"},[t("van-nav-bar",{attrs:{title:"å¤šé¡µé¢å½•åˆ¶",fixed:""}}),t("div",{staticClass:"content"},[t("div",{staticClass:"control-section"},[t("div",{staticClass:"status-info"},[t("div",{staticClass:"status-text"},[e.isRecording||e.recordData?e._e():t("span",[e._v("å‡†å¤‡å½•åˆ¶")]),e.isRecording?t("span",[e._v("æ­£åœ¨å½•åˆ¶ä¸­... ("+e._s(e.currentPage)+")")]):e._e(),!e.isRecording&&e.recordData?t("span",[e._v("å½•åˆ¶å®Œæˆ")]):e._e()]),e.isRecording?t("div",{staticClass:"recording-indicator"},[t("div",{staticClass:"red-dot"}),t("span",[e._v("REC")])]):e._e()]),t("div",{staticClass:"control-buttons"},[e.isRecording||e.recordData?e._e():t("van-button",{attrs:{type:"primary",size:"large",block:"",round:"",loading:e.loading,icon:"video-o"},on:{click:e.startRecord}},[e._v(" å¼€å§‹å½•åˆ¶ ")]),e.isRecording?t("van-button",{attrs:{type:"danger",size:"large",block:"",round:"",loading:e.loading,icon:"stop"},on:{click:e.stopRecord}},[e._v(" åœæ­¢å½•åˆ¶ ")]):e._e(),!e.isRecording&&e.recordData?t("div",{staticClass:"action-buttons"},[t("van-button",{attrs:{type:"primary",size:"large",round:"",icon:"play"},on:{click:e.playRecord}},[e._v(" æ’­æ”¾å›æ”¾ ")]),t("van-button",{attrs:{type:"info",size:"large",round:"",loading:e.downloading,icon:"download"},on:{click:e.downloadCompressedFile}},[e._v(" ä¸‹è½½å‹ç¼©æ–‡ä»¶ ")]),t("van-button",{attrs:{type:"success",size:"large",round:"",loading:e.uploading,icon:"cloud-upload"},on:{click:e.uploadRecord}},[e._v(" ä¸Šä¼ å½•åˆ¶ ")]),t("van-button",{attrs:{size:"large",round:"",icon:"refresh"},on:{click:e.resetRecord}},[e._v(" é‡æ–°å½•åˆ¶ ")])],1):e._e()],1)]),e.isRecording?t("div",{staticClass:"navigation-section"},[t("van-cell-group",{attrs:{title:"é¡µé¢å¯¼èˆª (å½•åˆ¶ä¸­å¯è·³è½¬)"}},[t("van-cell",{class:{active:"é¦–é¡µ"===e.currentPage},attrs:{title:"é¦–é¡µ","is-link":""},on:{click:function(t){return e.navigateTo("home")}}}),t("van-cell",{class:{active:"äº§å“åˆ—è¡¨"===e.currentPage},attrs:{title:"äº§å“åˆ—è¡¨","is-link":""},on:{click:function(t){return e.navigateTo("products")}}}),t("van-cell",{class:{active:"äº§å“è¯¦æƒ…"===e.currentPage},attrs:{title:"äº§å“è¯¦æƒ…","is-link":""},on:{click:function(t){return e.navigateTo("product-detail")}}}),t("van-cell",{class:{active:"è´­ä¹°é¡µé¢"===e.currentPage},attrs:{title:"è´­ä¹°é¡µé¢","is-link":""},on:{click:function(t){return e.navigateTo("purchase")}}}),t("van-cell",{class:{active:"èµå›é¡µé¢"===e.currentPage},attrs:{title:"èµå›é¡µé¢","is-link":""},on:{click:function(t){return e.navigateTo("redeem")}}})],1)],1):e._e(),e.recordData?t("div",{staticClass:"record-info"},[t("van-cell-group",{attrs:{title:"å½•åˆ¶ä¿¡æ¯"}},[t("van-cell",{attrs:{title:"å½•åˆ¶æ—¶é•¿",value:e.recordDuration}}),t("van-cell",{attrs:{title:"äº‹ä»¶æ•°é‡",value:e.recordData.events?e.recordData.events.length:0}}),t("van-cell",{attrs:{title:"é¡µé¢æ•°é‡",value:e.visitedPages.length}}),t("van-cell",{attrs:{title:"æ•°æ®å¤§å°",value:e.recordSize}}),t("van-cell",{attrs:{title:"å½•åˆ¶æ—¶é—´",value:e.recordTime}})],1),t("van-cell-group",{attrs:{title:"è®¿é—®é¡µé¢"}},e._l(e.visitedPages,(function(e,s){return t("van-cell",{key:s,attrs:{title:`${s+1}. ${e.name}`,value:e.duration}})})),1)],1):e._e(),e.showPlayer?t("div",{staticClass:"player-section"},[t("div",{staticClass:"player-header"},[t("h3",[e._v("å½•åˆ¶å›æ”¾")]),t("van-button",{attrs:{size:"small",icon:"cross"},on:{click:e.closePlayer}},[e._v("å…³é—­")])],1),t("div",{ref:"playerContainer",staticClass:"player-container"}),t("div",{staticClass:"player-controls"},[t("van-button",{attrs:{size:"small",icon:e.isPlaying?"pause":"play"},on:{click:e.togglePlay}},[e._v(" "+e._s(e.isPlaying?"æš‚åœ":"æ’­æ”¾")+" ")]),t("van-button",{attrs:{size:"small",icon:"replay"},on:{click:e.resetPlayer}},[e._v("é‡æ’­")])],1)]):e._e(),t("div",{staticClass:"current-page-content"},[t(e.currentPageComponent,{tag:"component",on:{"page-change":e.onPageChange}})],1)])],1)}),f=[],R=function(){var e=this,t=e._self._c;return t("div",{staticClass:"home-page"},[e._m(0),t("div",{staticClass:"features"},[t("div",{staticClass:"feature-item",on:{click:function(t){return e.handleClick("å®‰å…¨ä¿éšœ")}}},[t("div",{staticClass:"feature-icon"},[e._v("ğŸ›¡ï¸")]),t("div",{staticClass:"feature-text"},[e._v("å®‰å…¨ä¿éšœ")])]),t("div",{staticClass:"feature-item",on:{click:function(t){return e.handleClick("æ”¶ç›Šç¨³å®š")}}},[t("div",{staticClass:"feature-icon"},[e._v("ğŸ“ˆ")]),t("div",{staticClass:"feature-text"},[e._v("æ”¶ç›Šç¨³å®š")])]),t("div",{staticClass:"feature-item",on:{click:function(t){return e.handleClick("ä¸“ä¸šæœåŠ¡")}}},[t("div",{staticClass:"feature-icon"},[e._v("ğŸ‘¨â€ğŸ’¼")]),t("div",{staticClass:"feature-text"},[e._v("ä¸“ä¸šæœåŠ¡")])])]),t("div",{staticClass:"demo-actions"},[t("van-button",{attrs:{type:"primary",block:""},on:{click:e.showDialog}},[e._v("æŸ¥çœ‹è¯¦æƒ…")]),t("van-field",{attrs:{label:"ç”¨æˆ·å§“å",placeholder:"è¯·è¾“å…¥æ‚¨çš„å§“å"},model:{value:e.userInput,callback:function(t){e.userInput=t},expression:"userInput"}}),t("van-button",{attrs:{type:"info",block:""},on:{click:e.submitInfo}},[e._v("æäº¤ä¿¡æ¯")])],1)])},b=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"welcome-banner"},[t("h2",[e._v("æ¬¢è¿ä½¿ç”¨ç†è´¢äº§å“")]),t("p",[e._v("ä¸ºæ‚¨æä¾›ä¸“ä¸šçš„ç†è´¢æœåŠ¡")])])}],w={name:"HomePage",data(){return{userInput:""}},methods:{handleClick(e){this.$toast(`ç‚¹å‡»äº†${e}`)},showDialog(){this.$dialog.alert({title:"äº§å“è¯¦æƒ…",message:"æˆ‘ä»¬æä¾›å¤šç§ç†è´¢äº§å“ï¼Œæ»¡è¶³ä¸åŒå®¢æˆ·çš„éœ€æ±‚ã€‚"})},submitInfo(){this.userInput?this.$toast.success(`æ¬¢è¿ ${this.userInput}ï¼`):this.$toast.fail("è¯·è¾“å…¥å§“å")}}},C=w,_=(0,l.A)(C,R,b,!1,null,"34f6a022",null),k=_.exports,$=function(){var e=this,t=e._self._c;return t("div",{staticClass:"products-page"},[e._m(0),t("div",{staticClass:"filter-section"},[t("van-field",{attrs:{placeholder:"æœç´¢äº§å“åç§°"},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}}),t("div",{staticClass:"filter-buttons"},e._l(e.productTypes,(function(s){return t("van-button",{key:s,attrs:{size:"small",type:e.selectedType===s?"primary":"default"},on:{click:function(t){return e.filterByType(s)}}},[e._v(" "+e._s(s)+" ")])})),1)],1),t("div",{staticClass:"products-list"},e._l(e.filteredProducts,(function(s){return t("div",{key:s.id,staticClass:"product-card",on:{click:function(t){return e.selectProduct(s)}}},[t("div",{staticClass:"product-header"},[t("h4",[e._v(e._s(s.name))]),t("span",{staticClass:"product-rate"},[e._v(e._s(s.rate)+"%")])]),t("div",{staticClass:"product-info"},[t("div",{staticClass:"info-item"},[t("span",{staticClass:"label"},[e._v("èµ·è´­é‡‘é¢:")]),t("span",{staticClass:"value"},[e._v(e._s(s.minAmount)+"ä¸‡")])]),t("div",{staticClass:"info-item"},[t("span",{staticClass:"label"},[e._v("æœŸé™:")]),t("span",{staticClass:"value"},[e._v(e._s(s.period))])]),t("div",{staticClass:"info-item"},[t("span",{staticClass:"label"},[e._v("é£é™©ç­‰çº§:")]),t("span",{staticClass:"value"},[e._v(e._s(s.riskLevel))])])]),t("div",{staticClass:"product-actions"},[t("van-button",{attrs:{size:"small",type:"info"},on:{click:function(t){return t.stopPropagation(),e.viewDetail(s)}}},[e._v("æŸ¥çœ‹è¯¦æƒ…")]),t("van-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return t.stopPropagation(),e.buyProduct(s)}}},[e._v("ç«‹å³è´­ä¹°")])],1)])})),0)])},P=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-header"},[t("h3",[e._v("ç†è´¢äº§å“åˆ—è¡¨")]),t("p",[e._v("ä¸ºæ‚¨ç²¾é€‰ä¼˜è´¨ç†è´¢äº§å“")])])}],x={name:"ProductsPage",data(){return{searchText:"",selectedType:"å…¨éƒ¨",productTypes:["å…¨éƒ¨","ç¨³å¥å‹","å¹³è¡¡å‹","è¿›å–å‹"],products:[{id:1,name:"ç¨³å¥å¢åˆ©1å·",rate:4.2,minAmount:1,period:"90å¤©",riskLevel:"R2",type:"ç¨³å¥å‹"},{id:2,name:"å¹³è¡¡æ”¶ç›Š2å·",rate:5.8,minAmount:5,period:"180å¤©",riskLevel:"R3",type:"å¹³è¡¡å‹"},{id:3,name:"è¿›å–æˆé•¿3å·",rate:7.5,minAmount:10,period:"365å¤©",riskLevel:"R4",type:"è¿›å–å‹"},{id:4,name:"ç¨³å¥ä¿æœ¬4å·",rate:3.8,minAmount:1,period:"60å¤©",riskLevel:"R1",type:"ç¨³å¥å‹"}]}},computed:{filteredProducts(){let e=this.products;return"å…¨éƒ¨"!==this.selectedType&&(e=e.filter((e=>e.type===this.selectedType))),this.searchText&&(e=e.filter((e=>e.name.toLowerCase().includes(this.searchText.toLowerCase())))),e}},methods:{filterByType(e){this.selectedType=e,this.$toast(`ç­›é€‰: ${e}`)},selectProduct(e){this.$toast(`é€‰æ‹©äº† ${e.name}`)},viewDetail(e){this.$toast(`æŸ¥çœ‹ ${e.name} è¯¦æƒ…`)},buyProduct(e){this.$toast(`è´­ä¹° ${e.name}`)}}},S=x,T=(0,l.A)(S,$,P,!1,null,"02f66d73",null),F=T.exports,z=function(){var e=this,t=e._self._c;return t("div",{staticClass:"product-detail-page"},[t("div",{staticClass:"product-banner"},[t("h3",[e._v(e._s(e.product.name))]),t("div",{staticClass:"rate-display"},[e._v(e._s(e.product.rate)+"%")]),t("p",[e._v("é¢„æœŸå¹´åŒ–æ”¶ç›Šç‡")])]),t("div",{staticClass:"product-details"},[t("van-cell-group",{attrs:{title:"äº§å“ä¿¡æ¯"}},[t("van-cell",{attrs:{title:"èµ·è´­é‡‘é¢",value:`${e.product.minAmount}ä¸‡å…ƒ`}}),t("van-cell",{attrs:{title:"äº§å“æœŸé™",value:e.product.period}}),t("van-cell",{attrs:{title:"é£é™©ç­‰çº§",value:e.product.riskLevel}}),t("van-cell",{attrs:{title:"å‹Ÿé›†çŠ¶æ€",value:"å‹Ÿé›†ä¸­"}})],1),t("van-cell-group",{attrs:{title:"æ”¶ç›Šè¯´æ˜"}},[t("van-cell",{attrs:{title:"æ”¶ç›Šç±»å‹",value:"éä¿æœ¬æµ®åŠ¨æ”¶ç›Š"}}),t("van-cell",{attrs:{title:"è®¡æ¯æ–¹å¼",value:"æŒ‰æ—¥è®¡æ¯"}}),t("van-cell",{attrs:{title:"åˆ°æœŸå¤„ç†",value:"è‡ªåŠ¨èµå›"}})],1)],1),t("div",{staticClass:"demo-interactions"},[t("van-field",{attrs:{label:"æŠ•èµ„é‡‘é¢",placeholder:"è¯·è¾“å…¥æŠ•èµ„é‡‘é¢",type:"number"},model:{value:e.investAmount,callback:function(t){e.investAmount=t},expression:"investAmount"}}),t("van-field",{attrs:{label:"å®¢æˆ·å§“å",placeholder:"è¯·è¾“å…¥å§“å"},model:{value:e.customerName,callback:function(t){e.customerName=t},expression:"customerName"}}),t("van-switch",{model:{value:e.agreeTerms,callback:function(t){e.agreeTerms=t},expression:"agreeTerms"}}),t("span",{staticStyle:{"margin-left":"10px"}},[e._v("æˆ‘å·²é˜…è¯»å¹¶åŒæ„äº§å“åè®®")])],1),t("div",{staticClass:"action-buttons"},[t("van-button",{attrs:{type:"primary",block:""},on:{click:e.purchaseProduct}},[e._v("ç«‹å³è´­ä¹°")]),t("van-button",{attrs:{type:"info",block:""},on:{click:e.addToFavorites}},[e._v("åŠ å…¥æ”¶è—")])],1)])},D=[],A={name:"ProductDetailPage",data(){return{product:{name:"ç¨³å¥å¢åˆ©1å·",rate:4.2,minAmount:1,period:"90å¤©",riskLevel:"R2"},investAmount:"",customerName:"",agreeTerms:!1}},methods:{purchaseProduct(){this.agreeTerms?this.$toast.success("è·³è½¬åˆ°è´­ä¹°é¡µé¢"):this.$toast.fail("è¯·å…ˆåŒæ„äº§å“åè®®")},addToFavorites(){this.$toast.success("å·²åŠ å…¥æ”¶è—")}}},I=A,N=(0,l.A)(I,z,D,!1,null,"5eb9d020",null),O=N.exports,E=function(){var e=this,t=e._self._c;return t("div",{staticClass:"purchase-page"},[e._m(0),t("div",{staticClass:"purchase-form"},[t("van-cell-group",{attrs:{title:"è´­ä¹°ä¿¡æ¯"}},[t("van-cell",{attrs:{title:"äº§å“åç§°",value:"ç¨³å¥å¢åˆ©1å·"}}),t("van-cell",{attrs:{title:"é¢„æœŸæ”¶ç›Šç‡",value:"4.2%"}})],1),t("van-cell-group",{attrs:{title:"æŠ•èµ„ä¿¡æ¯"}},[t("van-field",{attrs:{label:"æŠ•èµ„é‡‘é¢",placeholder:"è¯·è¾“å…¥æŠ•èµ„é‡‘é¢",type:"number"},model:{value:e.form.amount,callback:function(t){e.$set(e.form,"amount",t)},expression:"form.amount"}}),t("van-field",{attrs:{label:"æŠ•èµ„äººå§“å",placeholder:"è¯·è¾“å…¥å§“å"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),t("van-field",{attrs:{label:"æ‰‹æœºå·ç ",placeholder:"è¯·è¾“å…¥æ‰‹æœºå·"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}}),t("van-field",{attrs:{label:"èº«ä»½è¯å·",placeholder:"è¯·è¾“å…¥èº«ä»½è¯å·"},model:{value:e.form.idCard,callback:function(t){e.$set(e.form,"idCard",t)},expression:"form.idCard"}})],1),t("div",{staticClass:"risk-notice"},[t("h4",[e._v("é£é™©æç¤º")]),t("p",[e._v("æœ¬äº§å“ä¸ºéä¿æœ¬æµ®åŠ¨æ”¶ç›Šå‹äº§å“ï¼Œå­˜åœ¨æŠ•èµ„é£é™©ï¼Œè¯·æ‚¨ä»”ç»†é˜…è¯»äº§å“è¯´æ˜ä¹¦ã€‚")]),t("div",{staticClass:"agree-section"},[t("van-switch",{model:{value:e.form.agreeRisk,callback:function(t){e.$set(e.form,"agreeRisk",t)},expression:"form.agreeRisk"}}),t("span",[e._v("æˆ‘å·²å……åˆ†äº†è§£äº§å“é£é™©")])],1)]),t("div",{staticClass:"demo-actions"},[t("van-button",{attrs:{type:"warning",block:""},on:{click:e.calculateIncome}},[e._v("è®¡ç®—æ”¶ç›Š")]),t("van-button",{attrs:{type:"primary",block:""},on:{click:e.confirmPurchase}},[e._v("ç¡®è®¤è´­ä¹°")])],1)],1)])},M=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-header"},[t("h3",[e._v("äº§å“è´­ä¹°")])])}],B={name:"PurchasePage",data(){return{form:{amount:"",name:"",phone:"",idCard:"",agreeRisk:!1}}},methods:{calculateIncome(){if(!this.form.amount)return void this.$toast.fail("è¯·è¾“å…¥æŠ•èµ„é‡‘é¢");const e=(1e4*this.form.amount*.042*90/365).toFixed(2);this.$toast.success(`é¢„è®¡æ”¶ç›Š: ${e}å…ƒ`)},confirmPurchase(){this.form.agreeRisk?this.form.amount&&this.form.name?this.$toast.success("è´­ä¹°æˆåŠŸï¼"):this.$toast.fail("è¯·å¡«å†™å®Œæ•´ä¿¡æ¯"):this.$toast.fail("è¯·å…ˆç¡®è®¤é£é™©æç¤º")}}},L=B,W=(0,l.A)(L,E,M,!1,null,"75a3e44c",null),q=W.exports,j=function(){var e=this,t=e._self._c;return t("div",{staticClass:"redeem-page"},[e._m(0),t("div",{staticClass:"redeem-form"},[t("van-cell-group",{attrs:{title:"æŒä»“ä¿¡æ¯"}},[t("van-cell",{attrs:{title:"äº§å“åç§°",value:"ç¨³å¥å¢åˆ©1å·"}}),t("van-cell",{attrs:{title:"æŒæœ‰é‡‘é¢",value:"50,000.00å…ƒ"}}),t("van-cell",{attrs:{title:"ç´¯è®¡æ”¶ç›Š",value:"1,245.67å…ƒ"}}),t("van-cell",{attrs:{title:"æŒæœ‰å¤©æ•°",value:"45å¤©"}})],1),t("van-cell-group",{attrs:{title:"èµå›ä¿¡æ¯"}},[t("van-field",{attrs:{label:"èµå›é‡‘é¢",placeholder:"è¯·è¾“å…¥èµå›é‡‘é¢",type:"number"},model:{value:e.form.redeemAmount,callback:function(t){e.$set(e.form,"redeemAmount",t)},expression:"form.redeemAmount"}}),t("van-cell",{attrs:{title:"èµå›ç±»å‹"},scopedSlots:e._u([{key:"right-icon",fn:function(){return[t("van-switch",{on:{change:e.onRedeemTypeChange},model:{value:e.form.isFullRedeem,callback:function(t){e.$set(e.form,"isFullRedeem",t)},expression:"form.isFullRedeem"}}),t("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.form.isFullRedeem?"å…¨éƒ¨èµå›":"éƒ¨åˆ†èµå›"))])]},proxy:!0}])}),t("van-field",{attrs:{label:"åˆ°è´¦é“¶è¡Œå¡",placeholder:"è¯·è¾“å…¥é“¶è¡Œå¡å·"},model:{value:e.form.bankCard,callback:function(t){e.$set(e.form,"bankCard",t)},expression:"form.bankCard"}})],1),t("div",{staticClass:"redeem-notice"},[t("h4",[e._v("èµå›è¯´æ˜")]),e._m(1),t("div",{staticClass:"agree-section"},[t("van-switch",{model:{value:e.form.agreeRedeem,callback:function(t){e.$set(e.form,"agreeRedeem",t)},expression:"form.agreeRedeem"}}),t("span",[e._v("æˆ‘å·²äº†è§£èµå›è§„åˆ™")])],1)]),t("div",{staticClass:"demo-actions"},[t("van-button",{attrs:{type:"warning",block:""},on:{click:e.calculateFee}},[e._v("è®¡ç®—æ‰‹ç»­è´¹")]),t("van-button",{attrs:{type:"danger",block:""},on:{click:e.confirmRedeem}},[e._v("ç¡®è®¤èµå›")])],1)],1)])},H=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-header"},[t("h3",[e._v("äº§å“èµå›")])])},function(){var e=this,t=e._self._c;return t("ul",[t("li",[e._v("èµå›ç”³è¯·æäº¤åä¸å¯æ’¤é”€")]),t("li",[e._v("èµ„é‡‘å°†åœ¨T+1ä¸ªå·¥ä½œæ—¥åˆ°è´¦")]),t("li",[e._v("éƒ¨åˆ†èµå›æœ€ä½ä¿ç•™é‡‘é¢1ä¸‡å…ƒ")])])}],J={name:"RedeemPage",data(){return{form:{redeemAmount:"",isFullRedeem:!1,bankCard:"",agreeRedeem:!1}}},methods:{onRedeemTypeChange(e){this.form.redeemAmount=e?"50000":""},calculateFee(){if(!this.form.redeemAmount)return void this.$toast.fail("è¯·è¾“å…¥èµå›é‡‘é¢");const e=(.001*this.form.redeemAmount).toFixed(2);this.$toast.success(`æ‰‹ç»­è´¹: ${e}å…ƒ`)},confirmRedeem(){this.form.agreeRedeem?this.form.redeemAmount&&this.form.bankCard?this.$toast.success("èµå›ç”³è¯·æäº¤æˆåŠŸï¼"):this.$toast.fail("è¯·å¡«å†™å®Œæ•´ä¿¡æ¯"):this.$toast.fail("è¯·å…ˆç¡®è®¤èµå›è§„åˆ™")}}},G=J,K=(0,l.A)(G,j,H,!1,null,"37ca8da5",null),U=K.exports,V={name:"MultiPageRecord",components:{HomePage:k,ProductsPage:F,ProductDetailPage:O,PurchasePage:q,RedeemPage:U},data(){return{isRecording:!1,loading:!1,uploading:!1,downloading:!1,recordData:null,recordTime:"",stopFn:null,events:[],currentPage:"é¦–é¡µ",currentPageComponent:"HomePage",visitedPages:[],pageStartTime:null,showPlayer:!1,player:null,isPlaying:!1}},computed:{recordDuration(){if(!this.recordData||!this.recordData.metadata)return"0ç§’";const e=Math.round(this.recordData.metadata.duration/1e3);return`${e}ç§’`},recordSize(){if(!this.recordData)return"0KB";const e=JSON.stringify(this.recordData).length;return`${(e/1024).toFixed(2)}KB`}},methods:{async startRecord(){this.loading=!0;try{if(await this.waitForPageLoad(),this.events=[],this.recordData=null,this.visitedPages=[],this.pageStartTime=Date.now(),this.visitedPages.push({name:this.currentPage,startTime:this.pageStartTime,url:window.location.href}),"undefined"===typeof window.rrweb)throw new Error("rrwebåº“æœªæ‰¾åˆ°ï¼Œè¯·ç¡®ä¿å·²æ­£ç¡®å¼•å…¥");this.stopFn=window.rrweb.record({emit:e=>{e.pageInfo={pageName:this.currentPage,url:window.location.href,timestamp:Date.now()},this.events.push(e)},recordCanvas:!0,collectFonts:!0,recordCrossOriginIframes:!0}),this.isRecording=!0,this.recordTime=(new Date).toLocaleString(),this.$toast.success("å¼€å§‹å½•åˆ¶ï¼Œå¯ä»¥è·³è½¬é¡µé¢")}catch(e){console.error("å½•åˆ¶å¤±è´¥:",e),this.$toast.fail("å½•åˆ¶å¤±è´¥")}finally{this.loading=!1}},async stopRecord(){this.loading=!0;try{if(this.stopFn&&(this.stopFn(),this.stopFn=null),this.visitedPages.length>0){const e=this.visitedPages[this.visitedPages.length-1];e.endTime||(e.endTime=Date.now(),e.duration=`${Math.round((e.endTime-e.startTime)/1e3)}ç§’`)}this.isRecording=!1,this.recordData={events:this.events,metadata:{recordTime:Date.now(),eventsCount:this.events.length,duration:this.events.length>0?this.events[this.events.length-1].timestamp-this.events[0].timestamp:0,visitedPages:this.visitedPages,totalPages:this.visitedPages.length}},this.$toast.success("å½•åˆ¶å®Œæˆ")}catch(e){console.error("åœæ­¢å½•åˆ¶å¤±è´¥:",e),this.$toast.fail("åœæ­¢å½•åˆ¶å¤±è´¥")}finally{this.loading=!1}},navigateTo(e){if(!this.isRecording)return;if(this.visitedPages.length>0){const e=this.visitedPages[this.visitedPages.length-1];e.endTime||(e.endTime=Date.now(),e.duration=`${Math.round((e.endTime-e.startTime)/1e3)}ç§’`)}const t={home:{name:"é¦–é¡µ",component:"HomePage"},products:{name:"äº§å“åˆ—è¡¨",component:"ProductsPage"},"product-detail":{name:"äº§å“è¯¦æƒ…",component:"ProductDetailPage"},purchase:{name:"è´­ä¹°é¡µé¢",component:"PurchasePage"},redeem:{name:"èµå›é¡µé¢",component:"RedeemPage"}},s=t[e];if(s){this.currentPage=s.name,this.currentPageComponent=s.component;const t=Date.now();this.visitedPages.push({name:s.name,startTime:t,url:window.location.href+"#"+e}),this.$toast(`å·²åˆ‡æ¢åˆ°${s.name}`)}},onPageChange(e){console.log("é¡µé¢å˜åŒ–:",e)},async playRecord(){if(this.recordData&&this.recordData.events)if(this.recordData.events.length<2)this.$toast.fail("å½•åˆ¶äº‹ä»¶ä¸è¶³ï¼Œæ— æ³•å›æ”¾");else{this.showPlayer=!0,await this.$nextTick();try{if(this.$refs.playerContainer&&(this.$refs.playerContainer.innerHTML=""),"undefined"===typeof window.rrwebPlayer)throw new Error("rrweb-playeråº“æœªæ‰¾åˆ°ï¼Œè¯·ç¡®ä¿å·²æ­£ç¡®å¼•å…¥");this.player=new window.rrwebPlayer({target:this.$refs.playerContainer,props:{events:this.recordData.events,width:375,height:400,autoPlay:!1,showController:!0,skipInactive:!0,speed:1}}),this.isPlaying=!1,this.$toast.success("å½•åˆ¶åŠ è½½æˆåŠŸ"),this.player&&this.player.addEventListener&&this.player.addEventListener("finish",(()=>{this.isPlaying=!1}))}catch(e){console.error("æ’­æ”¾å¤±è´¥:",e),this.$toast.fail("æ’­æ”¾å¤±è´¥: "+e.message),this.showPlayer=!1}}else this.$toast.fail("æ²¡æœ‰å½•åˆ¶æ•°æ®")},async downloadCompressedFile(){if(this.recordData){this.downloading=!0;try{const e=await this.generateCompressedFile();if(!e.success)return void this.$toast.fail(e.message);const t=(new Date).toISOString().replace(/[:.]/g,"-"),s=`multi-page-record-${t}.json`,r=JSON.stringify(e.data,null,2);this.downloadFile(r,s,"application/json");const a=(e.size/1024).toFixed(2),o=e.optimized?" (å·²ä¼˜åŒ–)":"";this.$toast.success(`æ–‡ä»¶å·²ä¸‹è½½ (${a}KB)${o}`)}catch(e){console.error("ä¸‹è½½å¤±è´¥:",e),this.$toast.fail("ä¸‹è½½å¤±è´¥")}finally{this.downloading=!1}}else this.$toast.fail("æ²¡æœ‰å½•åˆ¶æ•°æ®")},async uploadRecord(){if(this.recordData){this.uploading=!0;try{const e=await this.generateCompressedFile();if(!e.success)return void this.$toast.fail(e.message);console.log("ä¸Šä¼ æ•°æ®:",e.data),console.log("æ–‡ä»¶å¤§å°:",(e.size/1024/1024).toFixed(2)+"MB"),console.log("è®¿é—®é¡µé¢:",this.visitedPages),await new Promise((e=>setTimeout(e,2e3))),this.$toast.success(`ä¸Šä¼ æˆåŠŸ (${(e.size/1024/1024).toFixed(2)}MB)`)}catch(e){console.error("ä¸Šä¼ å¤±è´¥:",e),this.$toast.fail("ä¸Šä¼ å¤±è´¥")}finally{this.uploading=!1}}else this.$toast.fail("æ²¡æœ‰å½•åˆ¶æ•°æ®")},async generateCompressedFile(){try{const e=2097152;let t=this.optimizeRecordData(this.recordData);const s=JSON.stringify(t);if("undefined"===typeof window.pako)throw new Error("pakoå‹ç¼©åº“æœªæ‰¾åˆ°ï¼Œè¯·ç¡®ä¿å·²æ­£ç¡®å¼•å…¥");const r=window.pako.gzip(s),a={compressed:!0,data:Array.from(r),originalSize:s.length,compressedSize:r.length,metadata:t.metadata,timestamp:(new Date).toISOString()},o=JSON.stringify(a),i=o.length;if(console.log("å¤šé¡µé¢å½•åˆ¶å‹ç¼©ä¿¡æ¯:"),console.log("åŸå§‹æ•°æ®:",(s.length/1024).toFixed(2)+"KB"),console.log("å‹ç¼©å:",(r.length/1024).toFixed(2)+"KB"),console.log("æœ€ç»ˆJSON:",(i/1024).toFixed(2)+"KB"),i>e){const s=this.furtherOptimizeData(t),r=window.pako.gzip(JSON.stringify(s)),a={compressed:!0,data:Array.from(r),originalSize:JSON.stringify(s).length,compressedSize:r.length,metadata:s.metadata,timestamp:(new Date).toISOString(),optimized:!0},o=JSON.stringify(a),i=o.length;return i>e?{success:!1,message:`æ–‡ä»¶è¿‡å¤§ (${(i/1024/1024).toFixed(2)}MB)ï¼Œè¯·ç¼©çŸ­å½•åˆ¶æ—¶é—´`}:{success:!0,data:a,size:i,optimized:!0}}return{success:!0,data:a,size:i,optimized:!1}}catch(e){return{success:!1,message:"æ•°æ®å‹ç¼©å¤±è´¥"}}},optimizeRecordData(e){const t={events:e.events.map((e=>{const t={type:e.type,timestamp:e.timestamp,pageInfo:e.pageInfo};if(e.data)switch(t.data={},e.type){case 0:case 1:t.data={href:e.data.href,width:e.data.width,height:e.data.height};break;case 2:t.data={node:e.data.node,initialOffset:e.data.initialOffset};break;case 3:t.data={source:e.data.source,type:e.data.type,id:e.data.id},e.data.positions&&(t.data.positions=e.data.positions),e.data.texts&&(t.data.texts=e.data.texts),e.data.attributes&&(t.data.attributes=e.data.attributes);break;default:t.data=e.data}return t})),metadata:e.metadata};return t},furtherOptimizeData(e){const t=[],s=150;let r=0;return e.events.forEach((e=>{(0===e.type||1===e.type||2===e.type||e.timestamp-r>=s)&&(t.push(e),r=e.timestamp)})),{events:t,metadata:{...e.metadata,originalEventsCount:e.events.length,sampledEventsCount:t.length,optimized:!0}}},downloadFile(e,t,s){const r=new Blob([e],{type:s}),a=URL.createObjectURL(r),o=document.createElement("a");o.href=a,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},waitForPageLoad(){return new Promise((e=>{"complete"===document.readyState?setTimeout(e,500):window.addEventListener("load",(()=>{setTimeout(e,500)}))}))},resetRecord(){this.recordData=null,this.events=[],this.visitedPages=[],this.currentPage="é¦–é¡µ",this.currentPageComponent="HomePage",this.closePlayer(),this.$toast.success("å·²é‡ç½®ï¼Œå¯ä»¥é‡æ–°å½•åˆ¶")},togglePlay(){if(this.player)try{this.isPlaying?"function"===typeof this.player.pause&&this.player.pause():"function"===typeof this.player.play&&this.player.play(),this.isPlaying=!this.isPlaying}catch(e){console.warn("æ’­æ”¾æ§åˆ¶å‡ºé”™:",e),this.$toast.fail("æ’­æ”¾æ§åˆ¶å¤±è´¥")}},resetPlayer(){if(this.player)try{"function"===typeof this.player.goto?this.player.goto(0):"function"===typeof this.player.setCurrentTime&&this.player.setCurrentTime(0),this.isPlaying=!1}catch(e){console.warn("é‡ç½®æ’­æ”¾å™¨å‡ºé”™:",e),this.$toast.fail("é‡ç½®å¤±è´¥")}},closePlayer(){if(this.player){try{"function"===typeof this.player.destroy?this.player.destroy():"function"===typeof this.player.$destroy?this.player.$destroy():this.player.$el&&this.player.$el.parentNode&&this.player.$el.parentNode.removeChild(this.player.$el)}catch(e){console.warn("æ’­æ”¾å™¨é”€æ¯æ—¶å‡ºç°è­¦å‘Š:",e)}this.player=null}this.$refs.playerContainer&&(this.$refs.playerContainer.innerHTML=""),this.showPlayer=!1,this.isPlaying=!1}},beforeDestroy(){this.isRecording&&this.stopFn&&this.stopFn(),this.closePlayer()}},X=V,Q=(0,l.A)(X,y,f,!1,null,"23cfd779",null),Y=(Q.exports,function(){var e=this,t=e._self._c;return t("div",{staticClass:"router-index"},[t("van-nav-bar",{attrs:{title:"è·¯ç”±å¯¼èˆª",fixed:""}}),t("div",{staticClass:"content"},[t("div",{staticClass:"section"},[t("h3",[e._v("å½•åˆ¶åŠŸèƒ½")]),t("van-cell-group",[t("van-cell",{attrs:{title:"å•é¡µé¢å½•åˆ¶","is-link":"",to:"/SimpleRecord"}}),t("van-cell",{attrs:{title:"å¤šé¡µé¢å½•åˆ¶","is-link":"",to:"/multi-page"}})],1)],1),t("div",{staticClass:"section"},[t("h3",[e._v("ä¸šåŠ¡é¡µé¢")]),t("van-cell-group",[t("van-cell",{attrs:{title:"äº§å“åˆ—è¡¨","is-link":"",to:"/"}}),t("van-cell",{attrs:{title:"äº§å“è¯¦æƒ…","is-link":"",to:"/product/1"}}),t("van-cell",{attrs:{title:"ä¼ ç»Ÿè´­ä¹°æµç¨‹","is-link":"",to:"/purchase/1"}}),t("van-cell",{attrs:{title:"äº§å“èµå›","is-link":"",to:"/redeem/1"}}),t("van-cell",{attrs:{title:"å½•åˆ¶å›æ”¾","is-link":"",to:"/player"}})],1)],1),t("div",{staticClass:"section"},[t("h3",[e._v("æ–°åˆ†æ­¥è´­ä¹°æµç¨‹")]),t("van-cell-group",[t("van-cell",{attrs:{title:"æ­¥éª¤1ï¼šç¡®è®¤äº§å“","is-link":"",to:{name:"PurchaseStepOne",query:{id:1}}}}),t("van-cell",{attrs:{title:"æ­¥éª¤2ï¼šå¡«å†™ä¿¡æ¯","is-link":"",to:{name:"PurchaseStepTwo",query:{id:1}}}}),t("van-cell",{attrs:{title:"æ­¥éª¤3ï¼šç¡®è®¤è´­ä¹°","is-link":"",to:{name:"PurchaseStepThree",query:{id:1}}}}),t("van-cell",{attrs:{title:"æ­¥éª¤4ï¼šè´­ä¹°å®Œæˆ","is-link":"",to:{name:"PurchaseStepFour",query:{id:1}}}})],1)],1),t("div",{staticClass:"section"},[t("h3",[e._v("Pagesç»„ä»¶")]),t("van-cell-group",[t("van-cell",{attrs:{title:"é¦–é¡µç»„ä»¶","is-link":"",to:"/pages/home"}}),t("van-cell",{attrs:{title:"äº§å“é¡µé¢","is-link":"",to:"/pages/products"}}),t("van-cell",{attrs:{title:"äº§å“è¯¦æƒ…é¡µé¢","is-link":"",to:"/pages/product-detail"}}),t("van-cell",{attrs:{title:"è´­ä¹°é¡µé¢","is-link":"",to:"/pages/purchase"}}),t("van-cell",{attrs:{title:"èµå›é¡µé¢","is-link":"",to:"/pages/redeem"}})],1)],1),e._m(0)])],1)}),Z=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"section"},[t("h3",[e._v("å½•åˆ¶æµ‹è¯•è¯´æ˜")]),t("div",{staticClass:"test-guide"},[t("h4",[e._v("æµ‹è¯•æ–°çš„å½•åˆ¶åŠŸèƒ½ï¼š")]),t("ol",[t("li",[e._v('ç‚¹å‡»"äº§å“åˆ—è¡¨"è¿›å…¥ä¸»é¡µé¢')]),t("li",[e._v('ç‚¹å‡»"å¼€å§‹å½•åˆ¶"æŒ‰é’®ï¼Œä¼šå¼¹å‡ºå½•åˆ¶æƒé™ç”³è¯·å¼¹æ¡†')]),t("li",[e._v('ç‚¹å‡»"åŒæ„å½•åˆ¶"å¼€å§‹å½•åˆ¶ï¼Œä¼šæ˜¾ç¤ºå½•åˆ¶çŠ¶æ€å’Œæ—¶é—´')]),t("li",[e._v('ç‚¹å‡»ä»»æ„äº§å“çš„"ç«‹å³è´­ä¹°"æŒ‰é’®')]),t("li",[e._v('é€‰æ‹©"åˆ†æ­¥è´­ä¹°æµç¨‹"')]),t("li",[e._v("æŒ‰æ­¥éª¤å®Œæˆè´­ä¹°æµç¨‹ï¼ˆæ³¨æ„ï¼šè¶…è¿‡3åˆ†é’Ÿä¼šæç¤ºäº¤æ˜“å¤±è´¥ï¼‰")]),t("li",[e._v("åœ¨æœ€åä¸€æ­¥ä¼šè‡ªåŠ¨åœæ­¢å½•åˆ¶å¹¶æ˜¾ç¤ºå½•åˆ¶ç»“æœ")])]),t("h4",[e._v("åŠŸèƒ½ç‰¹ç‚¹ï¼š")]),t("ul",[t("li",[e._v("âœ… å½•åˆ¶å‰éœ€è¦ç”¨æˆ·åŒæ„")]),t("li",[e._v("âœ… å®æ—¶æ˜¾ç¤ºå½•åˆ¶æ—¶é—´")]),t("li",[e._v("âœ… 3åˆ†é’Ÿå½•åˆ¶è¶…æ—¶ä¿æŠ¤")]),t("li",[e._v("âœ… åˆ†æ­¥éª¤é¡µé¢é—´è·³è½¬ç»§ç»­å½•åˆ¶")]),t("li",[e._v("âœ… è¡¨å•æ•°æ®åœ¨æ­¥éª¤é—´è‡ªåŠ¨ä¿å­˜")]),t("li",[e._v("âœ… è´­ä¹°å®Œæˆåè‡ªåŠ¨åœæ­¢å½•åˆ¶")]),t("li",[e._v("âœ… å½•åˆ¶æ•°æ®å‹ç¼©å’Œä¸Šä¼ ")])])])])}],ee={name:"RouterIndex"},te=ee,se=(0,l.A)(te,Y,Z,!1,null,"0fd5bf03",null),re=(se.exports,function(){var e=this,t=e._self._c;return t("div",{staticClass:"home"},[t("van-nav-bar",{attrs:{title:"æ‰‹æœºé“¶è¡Œç†è´¢äº§å“",fixed:""}}),t("div",{staticClass:"content"},[t("div",{staticClass:"welcome-banner"},[e._m(0),t("div",{staticClass:"banner-image"},[t("van-icon",{attrs:{name:"gold-coin-o",size:"40",color:"#1989fa"}})],1)]),t("div",{staticClass:"main-features"},[t("van-grid",{attrs:{"column-num":2,gutter:16}},[t("van-grid-item",{attrs:{icon:"gold-coin-o",text:"ç†è´¢äº§å“"},on:{click:function(t){return e.$router.push("/products")}}}),t("van-grid-item",{attrs:{icon:"video-o",text:"å½•åˆ¶å›æ”¾"},on:{click:function(t){return e.$router.push("/player")}}})],1)],1),t("div",{staticClass:"features-section"},[e._m(1),t("van-cell-group",[t("van-cell",{attrs:{title:"å®Œæ•´å½•åˆ¶",label:"è®°å½•è´­ä¹°å’Œèµå›çš„å®Œæ•´æ“ä½œæµç¨‹",icon:"video"}}),t("van-cell",{attrs:{title:"æ•°æ®å‹ç¼©",label:"ä½¿ç”¨pakoå‹ç¼©æŠ€æœ¯ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´",icon:"compress"}}),t("van-cell",{attrs:{title:"å›æ”¾åŠŸèƒ½",label:"æ”¯æŒæ“ä½œå›æ”¾ï¼Œä¾¿äºå®¡æ ¸å’Œå¤ç›˜",icon:"play-circle"}}),t("van-cell",{attrs:{title:"å®‰å…¨å¯é ",label:"æ•°æ®åŠ å¯†ä¼ è¾“ï¼Œä¿éšœæ“ä½œå®‰å…¨",icon:"shield"}})],1)],1),t("div",{staticClass:"quick-actions"},[t("van-button",{attrs:{type:"primary",size:"large",block:"",round:""},on:{click:function(t){return e.$router.push("/products")}}},[e._v(" å¼€å§‹ä½“éªŒ ")])],1)])],1)}),ae=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"banner-content"},[t("h2",[e._v("æ™ºèƒ½å½•åˆ¶ç³»ç»Ÿ")]),t("p",[e._v("ä¸ºæ‚¨çš„æ¯ä¸€ç¬”ç†è´¢æ“ä½œæä¾›å®Œæ•´çš„å¯å›æº¯è®°å½•")])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"section-title"},[t("h3",[e._v("åŠŸèƒ½ç‰¹è‰²")])])}],oe={name:"Home"},ie=oe,ne=(0,l.A)(ie,re,ae,!1,null,"c1752790",null),le=(ne.exports,function(){var e=this,t=e._self._c;return t("RecordWrapper",{ref:"recordWrapper",attrs:{"show-controls":!1,"auto-start":!1,"stop-on-destroy":!1,"require-consent":!0,metadata:{action:"browse_products"}},on:{"record-started":e.onRecordStarted,"record-declined":e.onRecordDeclined,"record-timeout":e.onRecordTimeout,"timeout-confirmed":e.onTimeoutConfirmed}},[t("div",{staticClass:"product-list"},[t("van-nav-bar",{attrs:{title:"ç†è´¢äº§å“","left-arrow":"",fixed:""},on:{"click-left":function(t){return e.$router.back()}}}),t("van-dialog",{attrs:{title:"é€‰æ‹©è´­ä¹°æµç¨‹","show-cancel-button":!0,"confirm-button-text":"åˆ†æ­¥è´­ä¹°æµç¨‹","cancel-button-text":"ä¼ ç»Ÿå•é¡µè´­ä¹°","before-close":e.handleModeDialogClose,"close-on-click-overlay":!1},model:{value:e.showModeSelection,callback:function(t){e.showModeSelection=t},expression:"showModeSelection"}},[t("div",{staticClass:"mode-dialog-content"},[t("div",{staticClass:"dialog-icon"},[t("van-icon",{attrs:{name:"shopping-cart-o",size:"48",color:"#1989fa"}})],1),t("p",{staticClass:"dialog-text"},[e._v(" è¯·é€‰æ‹©æ‚¨å–œæ¬¢çš„è´­ä¹°æ–¹å¼ï¼š ")]),t("div",{staticClass:"mode-options"},[t("div",{staticClass:"mode-option"},[t("h4",[e._v("ğŸ“ åˆ†æ­¥è´­ä¹°æµç¨‹")]),t("p",[e._v("â€¢ åˆ†æ­¥éª¤å¼•å¯¼ï¼Œæ“ä½œç®€å•")]),t("p",[e._v("â€¢ æ”¯æŒå½•åˆ¶å›æ”¾")]),t("p",[e._v("â€¢ æ•°æ®è‡ªåŠ¨ä¿å­˜")])]),t("div",{staticClass:"mode-option"},[t("h4",[e._v("âš¡ ä¼ ç»Ÿå•é¡µè´­ä¹°")]),t("p",[e._v("â€¢ ä¸€é¡µå®Œæˆæ‰€æœ‰æ“ä½œ")]),t("p",[e._v("â€¢ å¿«é€Ÿä¾¿æ·")]),t("p",[e._v("â€¢ é€‚åˆç†Ÿæ‚‰ç”¨æˆ·")])])])])]),t("div",{staticClass:"content"},[t("div",{staticClass:"stats-card"},[t("div",{staticClass:"stat-item"},[t("div",{staticClass:"stat-number"},[e._v(e._s(e.products.length))]),t("div",{staticClass:"stat-label"},[e._v("åœ¨å”®äº§å“")])]),t("div",{staticClass:"stat-divider"}),t("div",{staticClass:"stat-item"},[t("div",{staticClass:"stat-number"},[e._v("4.2%-9.5%")]),t("div",{staticClass:"stat-label"},[e._v("æ”¶ç›ŠåŒºé—´")])])]),t("div",{staticClass:"products-container"},e._l(e.products,(function(s){return t("div",{key:s.id,staticClass:"product-card",on:{click:function(t){return e.goToDetail(s.id)}}},[t("div",{staticClass:"product-header"},[t("div",{staticClass:"product-info"},[t("h3",{staticClass:"product-name"},[e._v(e._s(s.name))]),t("p",{staticClass:"product-desc"},[e._v(e._s(s.description))])]),t("div",{staticClass:"product-return"},[t("div",{staticClass:"return-rate"},[e._v(e._s(s.expectedReturn))]),t("div",{staticClass:"return-label"},[e._v("é¢„æœŸæ”¶ç›Šç‡")])])]),t("div",{staticClass:"product-details"},[t("div",{staticClass:"detail-item"},[t("span",{staticClass:"detail-label"},[e._v("èµ·è´­é‡‘é¢")]),t("span",{staticClass:"detail-value"},[e._v(e._s(s.minAmount))])]),t("div",{staticClass:"detail-item"},[t("span",{staticClass:"detail-label"},[e._v("é£é™©ç­‰çº§")]),t("van-tag",{attrs:{type:"ä½é£é™©"===s.riskLevel?"success":"ä¸­é£é™©"===s.riskLevel?"warning":"danger",size:"small"}},[e._v(" "+e._s(s.riskLevel)+" ")])],1)]),t("div",{staticClass:"product-actions"},[t("van-button",{attrs:{size:"small",type:"primary",round:""},on:{click:function(t){return t.stopPropagation(),e.handlePurchaseClick(s.id)}}},[e._v(" ç«‹å³è´­ä¹° ")]),t("van-button",{attrs:{size:"small",plain:"",round:""},on:{click:function(t){return t.stopPropagation(),e.goToRedeem(s.id)}}},[e._v(" äº§å“èµå› ")])],1)])})),0)])],1)])}),ce=[],de=function(){var e=this,t=e._self._c;return t("div",{staticClass:"record-wrapper"},[t("van-dialog",{attrs:{title:"å½•åˆ¶æƒé™ç”³è¯·","show-cancel-button":!0,"confirm-button-text":"åŒæ„å½•åˆ¶","cancel-button-text":"ä¸åŒæ„","before-close":e.handleDialogClose,"close-on-click-overlay":!1},model:{value:e.showRecordDialog,callback:function(t){e.showRecordDialog=t},expression:"showRecordDialog"}},[t("div",{staticClass:"record-dialog-content"},[t("div",{staticClass:"dialog-icon"},[t("van-icon",{attrs:{name:"video-o",size:"48",color:"#1989fa"}})],1),t("p",{staticClass:"dialog-text"},[e._v(" ä¸ºäº†æ›´å¥½åœ°è®°å½•æ‚¨çš„æ“ä½œæµç¨‹ï¼Œæˆ‘ä»¬éœ€è¦å½•åˆ¶æ‚¨åœ¨æ­¤é¡µé¢çš„æ“ä½œè¡Œä¸ºã€‚ ")]),t("p",{staticClass:"dialog-note"},[e._v(" â€¢ å½•åˆ¶ä»…ç”¨äºæ“ä½œæµç¨‹åˆ†æ"),t("br"),e._v(" â€¢ å½•åˆ¶æ•°æ®ä¼šè¿›è¡ŒåŠ å¯†å¤„ç†"),t("br"),e._v(" â€¢ æ‚¨å¯ä»¥éšæ—¶åœæ­¢å½•åˆ¶ ")])])]),t("van-dialog",{attrs:{title:"äº¤æ˜“è¶…æ—¶","show-cancel-button":!1,"confirm-button-text":"ç¡®å®š"},on:{confirm:e.handleTimeout},model:{value:e.showTimeoutDialog,callback:function(t){e.showTimeoutDialog=t},expression:"showTimeoutDialog"}},[t("div",{staticClass:"timeout-dialog-content"},[t("div",{staticClass:"dialog-icon"},[t("van-icon",{attrs:{name:"warning-o",size:"48",color:"#ff6b35"}})],1),t("p",{staticClass:"dialog-text"},[e._v(" å½•åˆ¶æ—¶é—´å·²è¶…è¿‡3åˆ†é’Ÿï¼Œäº¤æ˜“å¤±è´¥ã€‚è¯·é‡æ–°å¼€å§‹æ“ä½œã€‚ ")])])]),e.showIndicator&&e.isRecording?t("div",{staticClass:"record-indicator"},[t("div",{staticClass:"record-dot"}),t("span",[e._v("æ­£åœ¨å½•åˆ¶ "+e._s(e.recordingTime))])]):e._e(),e.showControls?t("div",{staticClass:"record-controls"},[e.isRecording?t("van-button",{attrs:{type:"danger",size:"small",round:"",loading:e.loading,icon:"pause"},on:{click:e.stopRecord}},[e._v(" åœæ­¢å½•åˆ¶ ")]):t("van-button",{attrs:{type:"primary",size:"small",round:"",loading:e.loading,icon:"video-o"},on:{click:e.showRecordingConsent}},[e._v(" å¼€å§‹å½•åˆ¶ ")])],1):e._e(),t("div",{staticClass:"content-wrapper"},[e._t("default")],2)],1)},ue=[],pe=s(678),he={name:"RecordWrapper",props:{showIndicator:{type:Boolean,default:!1},showControls:{type:Boolean,default:!0},recordOptions:{type:Object,default:()=>({})},autoStart:{type:Boolean,default:!1},metadata:{type:Object,default:()=>({})},stopOnDestroy:{type:Boolean,default:!1},timeoutDuration:{type:Number,default:18e4},requireConsent:{type:Boolean,default:!0}},data(){return{globalRecorder:null,isRecording:!1,loading:!1,showRecordDialog:!1,showTimeoutDialog:!1,recordingStartTime:null,recordingTimer:null,timeoutTimer:null,recordingTime:"00:00",hasUserConsent:!1}},async mounted(){this.globalRecorder=pe["default"].getInstance(),this.globalRecorder.addListener(this.onRecordEvent);const e=this.globalRecorder.getRecordingStatus();this.isRecording=e.isRecording,this.isRecording&&this.startRecordingTimer(),this.autoStart&&!this.isRecording&&setTimeout((()=>{this.requireConsent&&!this.hasUserConsent?(console.log("RecordWrapperï¼šæ˜¾ç¤ºå½•åˆ¶åŒæ„å¼¹æ¡†"),this.showRecordingConsent()):(console.log("RecordWrapperï¼šè‡ªåŠ¨å¼€å§‹å½•åˆ¶"),this.startRecord())}),500)},beforeDestroy(){this.clearTimers(),this.globalRecorder&&this.globalRecorder.removeListener(this.onRecordEvent),this.isRecording&&this.stopOnDestroy&&this.stopRecord()},methods:{showRecordingConsent(){this.requireConsent&&!this.isRecording?this.showRecordDialog=!0:this.requireConsent||this.isRecording||this.startRecord()},handleDialogClose(e){this.showRecordDialog=!1,"confirm"===e?(this.hasUserConsent=!0,this.startRecord()):(this.$toast("å·²å–æ¶ˆå½•åˆ¶"),this.$emit("record-declined"))},async startRecord(){if(!this.loading&&!this.isRecording){this.loading=!0;try{const e=await this.globalRecorder.startRecording({...this.metadata,component:this.$options.name,route:this.$route.path,startTime:(new Date).toISOString()});e?(this.recordingStartTime=Date.now(),this.startRecordingTimer(),this.startTimeoutTimer(),this.$emit("record-started"),this.$toast.success("å¼€å§‹å½•åˆ¶")):this.$toast.fail("å½•åˆ¶å¯åŠ¨å¤±è´¥")}catch(e){console.error("å¯åŠ¨å½•åˆ¶å¤±è´¥:",e),this.$toast.fail("å½•åˆ¶å¯åŠ¨å¤±è´¥")}finally{this.loading=!1}}},async stopRecord(){if(!this.loading&&this.isRecording){this.loading=!0;try{this.clearTimers();const e=await this.globalRecorder.stopRecording();this.$emit("record-stopped",e),e?this.$toast.success("å½•åˆ¶å·²å®Œæˆ"):this.$toast.fail("å½•åˆ¶åœæ­¢å¤±è´¥")}catch(e){console.error("åœæ­¢å½•åˆ¶å¤±è´¥:",e),this.$toast.fail("å½•åˆ¶åœæ­¢å¤±è´¥")}finally{this.loading=!1}}},async stopRecordingAndProcess(e={}){if(this.loading||!this.isRecording)return{success:!1,error:"å½•åˆ¶æœªå¼€å§‹æˆ–å·²åœæ­¢"};this.loading=!0;try{this.clearTimers();const t=await this.globalRecorder.stopRecordingAndProcess({...e,component:this.$options.name,route:this.$route.path,stopTime:(new Date).toISOString()});if(console.log("RecordWrapperï¼šå½•åˆ¶æ•°æ®å¤„ç†ç»“æœ:",t),t.success){const s=await this.uploadVideoData(t.data,e);console.log("RecordWrapperï¼šè§†é¢‘ä¸Šä¼ ç»“æœ:",s);const r={success:!0,events:t.recordingResult.events,data:t.data,uploadResult:s,stats:{originalSize:t.data.sizes.original,compressedSize:t.data.sizes.compressed,compressionRatio:t.data.compressionRatio,eventCount:t.data.finalData.totalEvents}};return this.$emit("record-processed",r),this.$toast.success("å½•åˆ¶æ•°æ®å¤„ç†å¹¶ä¸Šä¼ æˆåŠŸ"),r}{console.warn("RecordWrapperï¼šå½•åˆ¶æ•°æ®å¤„ç†å¤±è´¥:",t.error);const e={success:!1,error:t.error,message:"å½•åˆ¶æ•°æ®ä¸ºç©º"===t.error?"è¯·å…ˆå¼€å§‹å½•åˆ¶ï¼Œç„¶åè¿›è¡Œæ“ä½œ":"å½•åˆ¶è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯"};return this.$emit("record-process-failed",e),this.$toast.fail("å½•åˆ¶æ•°æ®å¤„ç†å¤±è´¥: "+t.error),e}}catch(t){console.error("RecordWrapperï¼šåœæ­¢å½•åˆ¶å¹¶å¤„ç†æ•°æ®å¤±è´¥:",t);const e={success:!1,error:t.message};return this.$emit("record-process-failed",e),this.$toast.fail("å½•åˆ¶å¤„ç†å¤±è´¥: "+t.message),e}finally{this.loading=!1}},async uploadVideoData(e,t={}){try{console.log("RecordWrapperï¼šå¼€å§‹ä¸Šä¼ è§†é¢‘æ•°æ®...");const s={recordingInfo:{duration:e.duration,eventCount:e.finalData.totalEvents,startTime:e.startTime,endTime:e.endTime,compressionRatio:e.compressionRatio},eventsData:e.finalData.compressedEvents,sizes:e.sizes,businessInfo:{...t,component:this.$options.name,route:this.$route.path,userAgent:navigator.userAgent,timestamp:Date.now()},metadata:{...this.metadata,recordingId:e.recordingId||`rec_${Date.now()}`,version:"1.0"}};console.log("RecordWrapperï¼šå‡†å¤‡ä¸Šä¼ çš„æ•°æ®å¤§å°:",JSON.stringify(s).length,"å­—èŠ‚");const r=await fetch("/api/upload-video-recording",{method:"POST",headers:{"Content-Type":"application/json","X-Recording-Type":"video-session"},body:JSON.stringify(s)});if(!r.ok)throw new Error(`ä¸Šä¼ è¯·æ±‚å¤±è´¥: ${r.status} ${r.statusText}`);const a=await r.json();return console.log("RecordWrapperï¼šè§†é¢‘ä¸Šä¼ æˆåŠŸ:",a),{success:!0,uploadId:a.uploadId||a.id,videoUrl:a.videoUrl||a.url,size:JSON.stringify(s).length,timestamp:Date.now(),response:a}}catch(s){console.error("RecordWrapperï¼šè§†é¢‘ä¸Šä¼ å¤±è´¥:",s);try{const r=`video_recording_${Date.now()}`,a={...e,additionalInfo:t,uploadFailedAt:(new Date).toISOString(),error:s.message};return localStorage.setItem(r,JSON.stringify(a)),console.log("RecordWrapperï¼šè§†é¢‘æ•°æ®å·²ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨:",r),{success:!1,error:s.message,localStorageKey:r,fallbackStorage:!0,message:"ä¸Šä¼ å¤±è´¥ï¼Œæ•°æ®å·²ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨"}}catch(r){return console.error("RecordWrapperï¼šæœ¬åœ°å­˜å‚¨ä¹Ÿå¤±è´¥:",r),{success:!1,error:s.message,localError:r.message,message:"ä¸Šä¼ å¤±è´¥ä¸”æœ¬åœ°å­˜å‚¨å¤±è´¥"}}}},startRecordingTimer(){this.recordingTimer&&clearInterval(this.recordingTimer),this.recordingTimer=setInterval((()=>{if(this.recordingStartTime){const e=Date.now()-this.recordingStartTime;this.recordingTime=this.formatTime(e)}}),1e3)},startTimeoutTimer(){this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=setTimeout((()=>{this.handleRecordingTimeout()}),this.timeoutDuration)},async handleRecordingTimeout(){console.log("å½•åˆ¶è¶…æ—¶ï¼Œåœæ­¢å½•åˆ¶"),this.showTimeoutDialog=!0,this.isRecording&&await this.stopRecord(),this.$emit("record-timeout")},handleTimeout(){this.showTimeoutDialog=!1,this.$emit("timeout-confirmed")},clearTimers(){this.recordingTimer&&(clearInterval(this.recordingTimer),this.recordingTimer=null),this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)},formatTime(e){const t=Math.floor(e/1e3),s=Math.floor(t/60),r=t%60;return`${s.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`},getRecordingStatus(){return this.globalRecorder?this.globalRecorder.getRecordingStatus():null},onRecordEvent(e,t){switch(e){case"started":this.isRecording=!0;break;case"stopped":this.isRecording=!1,this.clearTimers(),this.recordingTime="00:00";break;case"error":this.isRecording=!1,this.clearTimers(),console.error("å½•åˆ¶é”™è¯¯:",t);break}},async finishRecording(e={}){console.log("RecordWrapperï¼šæ”¶åˆ°å®Œæˆå½•åˆ¶è¯·æ±‚ï¼Œä¸šåŠ¡æ•°æ®:",e);try{if(!this.isRecording){console.warn("RecordWrapperï¼šå½•åˆ¶æœªå¼€å§‹ï¼Œæ— æ³•å®Œæˆå½•åˆ¶");const e={success:!1,error:"å½•åˆ¶æœªå¼€å§‹",message:"è¯·å…ˆå¼€å§‹å½•åˆ¶ï¼Œç„¶åè¿›è¡Œæ“ä½œ"};return this.$emit("recording-finished",e),e}const t=await this.globalRecorder.finishRecording(e);return console.log("RecordWrapperï¼šå½•åˆ¶å®Œæˆç»“æœ:",t),this.$emit("recording-finished",t),t}catch(t){console.error("RecordWrapperï¼šå®Œæˆå½•åˆ¶å¤±è´¥:",t);const e={success:!1,error:t.message,message:"å½•åˆ¶å®Œæˆå¤„ç†å¤±è´¥"};return this.$emit("recording-finished",e),e}}}},me=he,ge=(0,l.A)(me,de,ue,!1,null,"5cf00da6",null),ve=ge.exports,ye={name:"ProductList",components:{RecordWrapper:ve},data(){return{showModeSelection:!1,selectedProductId:null,preferredPurchaseMode:"step",products:[{id:1,name:"ç¨³å¥å¢é•¿ç†è´¢äº§å“",description:"ä½é£é™©ï¼Œç¨³å®šæ”¶ç›Šï¼Œé€‚åˆä¿å®ˆå‹æŠ•èµ„è€…",expectedReturn:"4.2%",minAmount:"1000å…ƒ",riskLevel:"ä½é£é™©",image:"https://img.yzcdn.cn/vant/cat.jpeg"},{id:2,name:"å¹³è¡¡é…ç½®ç†è´¢äº§å“",description:"ä¸­ç­‰é£é™©ï¼Œå‡è¡¡æ”¶ç›Šï¼Œé€‚åˆç¨³å¥å‹æŠ•èµ„è€…",expectedReturn:"6.8%",minAmount:"5000å…ƒ",riskLevel:"ä¸­é£é™©",image:"https://img.yzcdn.cn/vant/cat.jpeg"},{id:3,name:"æˆé•¿æœºä¼šç†è´¢äº§å“",description:"é«˜é£é™©é«˜æ”¶ç›Šï¼Œé€‚åˆç§¯æå‹æŠ•èµ„è€…",expectedReturn:"9.5%",minAmount:"10000å…ƒ",riskLevel:"é«˜é£é™©",image:"https://img.yzcdn.cn/vant/cat.jpeg"}]}},methods:{goToDetail(e){this.$router.push(`/product/${e}`)},handlePurchaseClick(e){this.selectedProductId=e,this.checkRecordingStatus().then((t=>{t?this.goToPurchase(e,"step"):this.triggerRecordingConsent()}))},triggerRecordingConsent(){this.$refs.recordWrapper?.showRecordingConsent()},async checkRecordingStatus(){try{const e=(await Promise.resolve().then(s.bind(s,678))).default,t=e.getInstance(),r=t.getRecordingStatus();return r.isRecording}catch(e){return console.error("æ£€æŸ¥å½•åˆ¶çŠ¶æ€å¤±è´¥:",e),!1}},handleModeDialogClose(e){this.showModeSelection=!1,"confirm"===e?this.selectPurchaseMode("step"):"cancel"===e&&this.selectPurchaseMode("single")},selectPurchaseMode(e){this.preferredPurchaseMode=e,this.goToPurchase(this.selectedProductId,e)},goToPurchase(e,t="step"){"step"===t?this.$router.push({name:"PurchaseStepOne",query:{id:e}}):this.$router.push(`/purchase/${e}`)},goToRedeem(e){this.$router.push(`/redeem/${e}`)},onRecordStarted(){console.log("äº§å“åˆ—è¡¨ï¼šå½•åˆ¶å¼€å§‹"),this.$toast.success("å½•åˆ¶å·²å¼€å§‹ï¼Œç°åœ¨å¯ä»¥è¿›è¡Œè´­ä¹°æ“ä½œ"),this.selectedProductId&&this.goToPurchase(this.selectedProductId,"step")},onRecordDeclined(){console.log("äº§å“åˆ—è¡¨ï¼šç”¨æˆ·æ‹’ç»å½•åˆ¶"),this.$toast("å·²å–æ¶ˆå½•åˆ¶ï¼Œå°†ä½¿ç”¨ä¼ ç»Ÿè´­ä¹°æµç¨‹"),this.selectedProductId&&this.goToPurchase(this.selectedProductId,"single")},onRecordTimeout(){console.log("äº§å“åˆ—è¡¨ï¼šå½•åˆ¶è¶…æ—¶"),this.$toast.fail("å½•åˆ¶è¶…æ—¶ï¼Œäº¤æ˜“å·²å–æ¶ˆ"),this.showModeSelection=!1},onTimeoutConfirmed(){console.log("äº§å“åˆ—è¡¨ï¼šè¶…æ—¶ç¡®è®¤"),this.showModeSelection=!1}}},fe=ye,Re=(0,l.A)(fe,le,ce,!1,null,"624eb8e7",null),be=Re.exports,we=function(){var e=this,t=e._self._c;return t("div",{staticClass:"product-detail"},[t("van-nav-bar",{attrs:{title:"äº§å“è¯¦æƒ…","left-arrow":""},on:{"click-left":function(t){return e.$router.back()}}}),e.product?t("div",{staticClass:"content"},[t("van-card",{attrs:{title:e.product.name,desc:e.product.description,price:e.product.expectedReturn,thumb:e.product.image},scopedSlots:e._u([{key:"tags",fn:function(){return[t("van-tag",{attrs:{type:"ä½é£é™©"===e.product.riskLevel?"success":"ä¸­é£é™©"===e.product.riskLevel?"warning":"danger"}},[e._v(" "+e._s(e.product.riskLevel)+" ")])]},proxy:!0}],null,!1,269412469)}),t("van-cell-group",{attrs:{title:"äº§å“ä¿¡æ¯"}},[t("van-cell",{attrs:{title:"é¢„æœŸæ”¶ç›Šç‡",value:e.product.expectedReturn}}),t("van-cell",{attrs:{title:"èµ·è´­é‡‘é¢",value:e.product.minAmount}}),t("van-cell",{attrs:{title:"äº§å“æœŸé™",value:e.product.term}}),t("van-cell",{attrs:{title:"é£é™©ç­‰çº§",value:e.product.riskLevel}}),t("van-cell",{attrs:{title:"æŠ•èµ„æ–¹å‘",value:e.product.investmentDirection}})],1),t("van-cell-group",{attrs:{title:"äº§å“ç‰¹è‰²"}},e._l(e.product.features,(function(e,s){return t("van-cell",{key:s,attrs:{title:e}})})),1),t("div",{staticClass:"actions"},[t("van-button",{attrs:{type:"primary",size:"large",block:""},on:{click:e.goToPurchase}},[e._v(" ç«‹å³è´­ä¹° ")]),t("van-button",{staticStyle:{"margin-top":"12px"},attrs:{size:"large",block:""},on:{click:e.goToRedeem}},[e._v(" äº§å“èµå› ")])],1)],1):e._e()],1)},Ce=[],_e={name:"ProductDetail",data(){return{product:null,products:{1:{id:1,name:"ç¨³å¥å¢é•¿ç†è´¢äº§å“",description:"ä½é£é™©ï¼Œç¨³å®šæ”¶ç›Šï¼Œé€‚åˆä¿å®ˆå‹æŠ•èµ„è€…",expectedReturn:"4.2%",minAmount:"1000å…ƒ",term:"90å¤©",riskLevel:"ä½é£é™©",investmentDirection:"è´§å¸å¸‚åœºå·¥å…·ã€å€ºåˆ¸",image:"https://img.yzcdn.cn/vant/cat.jpeg",features:["æœ¬é‡‘å®‰å…¨ä¿éšœ","æ”¶ç›Šç¨³å®šå¯é¢„æœŸ","æµåŠ¨æ€§è¾ƒå¥½","é€‚åˆä¿å®ˆæŠ•èµ„è€…"]},2:{id:2,name:"å¹³è¡¡é…ç½®ç†è´¢äº§å“",description:"ä¸­ç­‰é£é™©ï¼Œå‡è¡¡æ”¶ç›Šï¼Œé€‚åˆç¨³å¥å‹æŠ•èµ„è€…",expectedReturn:"6.8%",minAmount:"5000å…ƒ",term:"180å¤©",riskLevel:"ä¸­é£é™©",investmentDirection:"å€ºåˆ¸ã€è‚¡ç¥¨ã€åŸºé‡‘",image:"https://img.yzcdn.cn/vant/cat.jpeg",features:["é£é™©æ”¶ç›Šå¹³è¡¡","æŠ•èµ„ç»„åˆå¤šæ ·åŒ–","ä¸“ä¸šå›¢é˜Ÿç®¡ç†","é€‚åˆç¨³å¥æŠ•èµ„è€…"]},3:{id:3,name:"æˆé•¿æœºä¼šç†è´¢äº§å“",description:"é«˜é£é™©é«˜æ”¶ç›Šï¼Œé€‚åˆç§¯æå‹æŠ•èµ„è€…",expectedReturn:"9.5%",minAmount:"10000å…ƒ",term:"365å¤©",riskLevel:"é«˜é£é™©",investmentDirection:"è‚¡ç¥¨ã€æœŸè´§ã€è‚¡æƒæŠ•èµ„",image:"https://img.yzcdn.cn/vant/cat.jpeg",features:["é«˜æ”¶ç›Šæ½œåŠ›","æˆé•¿æ€§æŠ•èµ„æœºä¼š","é£é™©æ§åˆ¶æœºåˆ¶","é€‚åˆç§¯ææŠ•èµ„è€…"]}}}},created(){this.loadProduct()},methods:{loadProduct(){const e=parseInt(this.$route.params.id);this.product=this.products[e]},goToPurchase(){this.$router.push(`/purchase/${this.product.id}`)},goToRedeem(){this.$router.push(`/redeem/${this.product.id}`)}},watch:{$route(){this.loadProduct()}}},ke=_e,$e=(0,l.A)(ke,we,Ce,!1,null,"abe6d008",null),Pe=($e.exports,function(){var e=this,t=e._self._c;return t("RecordWrapper",{attrs:{"auto-start":!1,"show-controls":!1,"stop-on-destroy":!0,metadata:{action:"purchase",productId:e.productId}},on:{"record-started":e.onRecordStarted,"record-stopped":e.onRecordStopped}},[t("div",{staticClass:"purchase"},[t("van-nav-bar",{attrs:{title:"äº§å“è´­ä¹°","left-arrow":"",fixed:""},on:{"click-left":function(t){return e.$router.back()}}}),e.product?t("div",{staticClass:"content"},[t("div",{staticClass:"product-info-card"},[t("div",{staticClass:"product-header"},[t("h3",{staticClass:"product-name"},[e._v(e._s(e.product.name))]),t("div",{staticClass:"product-return"},[e._v(e._s(e.product.expectedReturn))])]),t("p",{staticClass:"product-desc"},[e._v(e._s(e.product.description))])]),t("div",{staticClass:"steps-container"},[t("van-steps",{attrs:{active:e.currentStep,direction:"horizontal"}},[t("van-step",[e._v("ç¡®è®¤äº§å“")]),t("van-step",[e._v("å¡«å†™ä¿¡æ¯")]),t("van-step",[e._v("ç¡®è®¤è´­ä¹°")]),t("van-step",[e._v("è´­ä¹°å®Œæˆ")])],1)],1),t("div",{staticClass:"step-content"},[0===e.currentStep?t("div",{staticClass:"step-card"},[t("h4",{staticClass:"step-title"},[e._v("äº§å“ç¡®è®¤")]),t("van-cell-group",[t("van-cell",{attrs:{title:"äº§å“åç§°",value:e.product.name}}),t("van-cell",{attrs:{title:"é¢„æœŸæ”¶ç›Šç‡",value:e.product.expectedReturn}}),t("van-cell",{attrs:{title:"èµ·è´­é‡‘é¢",value:e.product.minAmount}}),t("van-cell",{attrs:{title:"äº§å“æœŸé™",value:e.product.term}})],1),t("div",{staticClass:"step-actions"},[t("van-button",{attrs:{type:"primary",size:"large",block:"",round:""},on:{click:e.nextStep}},[e._v(" ç¡®è®¤äº§å“ä¿¡æ¯ ")])],1)],1):e._e(),1===e.currentStep?t("div",{staticClass:"step-card"},[t("h4",{staticClass:"step-title"},[e._v("å¡«å†™è´­ä¹°ä¿¡æ¯")]),t("van-form",{ref:"purchaseForm",on:{submit:e.onFormSubmit}},[t("van-field",{attrs:{name:"amount",label:"è´­ä¹°é‡‘é¢",placeholder:"è¯·è¾“å…¥è´­ä¹°é‡‘é¢",type:"number",rules:[{required:!0,message:"è¯·å¡«å†™è´­ä¹°é‡‘é¢"}]},model:{value:e.purchaseForm.amount,callback:function(t){e.$set(e.purchaseForm,"amount",t)},expression:"purchaseForm.amount"}}),t("van-field",{attrs:{name:"bankCard",label:"é“¶è¡Œå¡å·",placeholder:"è¯·è¾“å…¥é“¶è¡Œå¡å·",rules:[{required:!0,message:"è¯·å¡«å†™é“¶è¡Œå¡å·"}]},model:{value:e.purchaseForm.bankCard,callback:function(t){e.$set(e.purchaseForm,"bankCard",t)},expression:"purchaseForm.bankCard"}}),t("van-field",{attrs:{name:"password",label:"äº¤æ˜“å¯†ç ",placeholder:"è¯·è¾“å…¥äº¤æ˜“å¯†ç ",type:"password",rules:[{required:!0,message:"è¯·å¡«å†™äº¤æ˜“å¯†ç "}]},model:{value:e.purchaseForm.password,callback:function(t){e.$set(e.purchaseForm,"password",t)},expression:"purchaseForm.password"}}),t("div",{staticClass:"step-actions"},[t("van-button",{attrs:{type:"primary",size:"large",block:"",round:""},on:{click:e.validateAndNext}},[e._v(" ä¸‹ä¸€æ­¥ ")])],1)],1)],1):e._e(),2===e.currentStep?t("div",{staticClass:"step-card"},[t("h4",{staticClass:"step-title"},[e._v("ç¡®è®¤è´­ä¹°ä¿¡æ¯")]),t("van-cell-group",[t("van-cell",{attrs:{title:"äº§å“åç§°",value:e.product.name}}),t("van-cell",{attrs:{title:"è´­ä¹°é‡‘é¢",value:`Â¥${e.purchaseForm.amount}`}}),t("van-cell",{attrs:{title:"é¢„æœŸæ”¶ç›Š",value:e.expectedProfit}}),t("van-cell",{attrs:{title:"é“¶è¡Œå¡å·",value:e.maskedBankCard}})],1),t("div",{staticClass:"risk-notice"},[t("van-notice-bar",{attrs:{"left-icon":"warning-o",text:"æŠ•èµ„æœ‰é£é™©ï¼Œç†è´¢äº§å“ä¸ä¿è¯æœ¬é‡‘å’Œæ”¶ç›Šï¼Œè¿‡å¾€ä¸šç»©ä¸ä»£è¡¨æœªæ¥è¡¨ç°"}})],1),t("div",{staticClass:"step-actions"},[t("van-button",{attrs:{type:"primary",size:"large",block:"",round:"",loading:e.purchasing},on:{click:e.confirmPurchase}},[e._v(" ç¡®è®¤è´­ä¹° ")])],1)],1):e._e(),3===e.currentStep?t("div",{staticClass:"step-card success-card"},[t("div",{staticClass:"success-content"},[t("van-icon",{attrs:{name:"success",size:"50",color:"#07c160"}}),t("h3",[e._v("è´­ä¹°æˆåŠŸï¼")]),t("p",[e._v("æ‚¨å·²æˆåŠŸè´­ä¹°ç†è´¢äº§å“")]),t("van-cell-group",[t("van-cell",{attrs:{title:"è®¢å•å·",value:e.orderNo}}),t("van-cell",{attrs:{title:"è´­ä¹°æ—¶é—´",value:e.purchaseTime}}),t("van-cell",{attrs:{title:"è´­ä¹°é‡‘é¢",value:`Â¥${e.purchaseForm.amount}`}}),t("van-cell",{attrs:{title:"é¢„æœŸæ”¶ç›Š",value:e.expectedProfit}}),e.recordingResult?t("van-cell",{attrs:{title:"å½•åˆ¶çŠ¶æ€",value:e.recordingResult.success?"å½•åˆ¶å®Œæˆ":"å½•åˆ¶å¤±è´¥"}}):e._e(),e.recordingResult&&e.recordingResult.dataSize?t("van-cell",{attrs:{title:"å½•åˆ¶æ•°æ®å¤§å°",value:e.recordingResult.dataSize}}):e._e(),e.recordingResult&&e.recordingResult.compressionRatio?t("van-cell",{attrs:{title:"å‹ç¼©ç‡",value:e.recordingResult.compressionRatio}}):e._e()],1),e.recordingResult&&e.recordingResult.success&&e.recordingResult.events?t("div",{staticClass:"replay-section"},[t("h4",[e._v("è´­ä¹°æµç¨‹å›æ”¾")]),t("div",{staticClass:"replay-controls"},[t("van-button",{attrs:{type:"primary",size:"small",disabled:e.isReplaying},on:{click:e.startReplay}},[e._v(" "+e._s(e.isReplaying?"æ­£åœ¨å›æ”¾...":"å¼€å§‹å›æ”¾")+" ")]),e.isReplaying?t("van-button",{attrs:{size:"small"},on:{click:e.stopReplay}},[e._v(" åœæ­¢å›æ”¾ ")]):e._e()],1),t("div",{staticClass:"replay-container",attrs:{id:"replay-container"}})]):e._e(),e.recordingResult&&e.recordingResult.success?t("div",{staticClass:"recording-success-section"},[t("h4",[e._v("å½•åˆ¶çŠ¶æ€")]),t("van-notice-bar",{attrs:{type:"success",text:"å½•åˆ¶æ•°æ®å¤„ç†å¹¶ä¸Šä¼ æˆåŠŸ"}}),t("div",{staticClass:"success-info",staticStyle:{"margin-top":"12px"}},[t("div",{staticClass:"success-item"},[t("span",{staticClass:"label"},[e._v("äº‹ä»¶æ•°é‡:")]),t("span",{staticClass:"value"},[e._v(e._s(e.recordingResult.recordingResult?e.recordingResult.recordingResult.eventCount:e.recordingResult.data?e.recordingResult.data.finalData.totalEvents:0))])]),t("div",{staticClass:"success-item"},[t("span",{staticClass:"label"},[e._v("åŸå§‹å¤§å°:")]),t("span",{staticClass:"value"},[e._v(e._s(e.formatFileSize(e.recordingResult.stats.originalSize)))])]),t("div",{staticClass:"success-item"},[t("span",{staticClass:"label"},[e._v("å‹ç¼©å¤§å°:")]),t("span",{staticClass:"value"},[e._v(e._s(e.formatFileSize(e.recordingResult.stats.compressedSize)))])]),t("div",{staticClass:"success-item"},[t("span",{staticClass:"label"},[e._v("å‹ç¼©ç‡:")]),t("span",{staticClass:"value"},[e._v(e._s(e.recordingResult.stats.compressionRatio))])]),t("div",{staticClass:"success-item"},[t("span",{staticClass:"label"},[e._v("ä¸Šä¼ çŠ¶æ€:")]),t("van-tag",{attrs:{type:e.recordingResult.uploadResult.success?"success":"danger"}},[e._v(" "+e._s(e.recordingResult.uploadResult.success?"æˆåŠŸ":"å¤±è´¥")+" ")])],1),e.recordingResult.uploadResult.success?t("div",{staticClass:"success-item"},[t("span",{staticClass:"label"},[e._v("ä¸Šä¼ ID:")]),t("span",{staticClass:"value"},[e._v(e._s(e.recordingResult.uploadResult.uploadId))])]):e._e()]),t("div",{staticClass:"upload-details",staticStyle:{"margin-top":"16px"}},[t("h4",{staticStyle:{"font-size":"14px","margin-bottom":"8px"}},[e._v("ä¸Šä¼ ç»“æœè¯¦æƒ…:")]),t("div",{staticClass:"upload-result",staticStyle:{background:"#f7f8fa",padding:"12px","border-radius":"4px","font-size":"12px","overflow-x":"auto"}},[t("pre",{staticStyle:{margin:"0","white-space":"pre-wrap","word-break":"break-all"}},[e._v(e._s(JSON.stringify(e.recordingResult.uploadResult,null,2)))])])])],1):e.recordingResult&&!e.recordingResult.success?t("div",{staticClass:"recording-error-section"},[t("h4",[e._v("å½•åˆ¶çŠ¶æ€")]),t("van-notice-bar",{attrs:{type:"danger",text:e.recordingResult.message||e.recordingResult.error||"å½•åˆ¶å¤±è´¥"}}),t("div",{staticClass:"error-suggestion",staticStyle:{"margin-top":"12px",padding:"12px",background:"#fff2f0","border-radius":"4px"}},[t("p",{staticStyle:{margin:"0",color:"#ff4757","font-size":"14px"}},[t("van-icon",{staticStyle:{"margin-right":"4px"},attrs:{name:"info-o"}}),e._v(" å»ºè®®æ“ä½œæµç¨‹ï¼š ")],1),t("ol",{staticStyle:{margin:"8px 0 0 20px",color:"#666","font-size":"13px"}},[t("li",[e._v("è¿”å›äº§å“åˆ—è¡¨é¡µé¢")]),t("li",[e._v('ç‚¹å‡»"å¼€å§‹å½•åˆ¶"æŒ‰é’®')]),t("li",[e._v("å†æ¬¡è¿›è¡Œè´­ä¹°æ“ä½œ")])])])],1):t("div",{staticClass:"no-recording-section"},[t("h4",[e._v("å½•åˆ¶çŠ¶æ€")]),t("van-notice-bar",{attrs:{type:"warning",text:"æ²¡æœ‰å½•åˆ¶æ•°æ®ï¼Œè¯·ç¡®ä¿åœ¨æ“ä½œå‰å·²å¼€å§‹å½•åˆ¶"}})],1),t("div",{staticClass:"step-actions"},[e.recordingResult&&e.recordingResult.success?t("van-button",{attrs:{type:"primary",size:"large",block:"",round:""},on:{click:e.goHome}},[e._v(" è¿”å›é¦–é¡µ ")]):[t("van-button",{staticStyle:{"margin-bottom":"12px"},attrs:{type:"primary",size:"large",block:"",round:""},on:{click:e.goToProducts}},[e._v(" é‡æ–°å¼€å§‹å½•åˆ¶ ")]),t("van-button",{attrs:{type:"default",size:"large",block:"",round:""},on:{click:e.goHome}},[e._v(" è¿”å›é¦–é¡µ ")])]],2)],1)]):e._e()])]):e._e()],1)])}),xe=[],Se={name:"Purchase",components:{RecordWrapper:ve},data(){return{productId:null,product:null,currentStep:0,purchasing:!1,purchaseForm:{amount:"",bankCard:"",password:""},orderNo:"",purchaseTime:"",recordingResult:null,isReplaying:!1,replayPlayer:null,replayerObserver:null,products:{1:{id:1,name:"ç¨³å¥å¢é•¿ç†è´¢äº§å“",description:"ä½é£é™©ï¼Œç¨³å®šæ”¶ç›Šï¼Œé€‚åˆä¿å®ˆå‹æŠ•èµ„è€…",expectedReturn:"4.2%",minAmount:"1000å…ƒ",term:"90å¤©",image:"https://img.yzcdn.cn/vant/cat.jpeg"},2:{id:2,name:"å¹³è¡¡é…ç½®ç†è´¢äº§å“",description:"ä¸­ç­‰é£é™©ï¼Œå‡è¡¡æ”¶ç›Šï¼Œé€‚åˆç¨³å¥å‹æŠ•èµ„è€…",expectedReturn:"6.8%",minAmount:"5000å…ƒ",term:"180å¤©",image:"https://img.yzcdn.cn/vant/cat.jpeg"},3:{id:3,name:"æˆé•¿æœºä¼šç†è´¢äº§å“",description:"é«˜é£é™©é«˜æ”¶ç›Šï¼Œé€‚åˆç§¯æå‹æŠ•èµ„è€…",expectedReturn:"9.5%",minAmount:"10000å…ƒ",term:"365å¤©",image:"https://img.yzcdn.cn/vant/cat.jpeg"}}}},computed:{expectedProfit(){if(!this.purchaseForm.amount||!this.product)return"Â¥0";const e=parseFloat(this.product.expectedReturn)/100,t=this.purchaseForm.amount*e;return`Â¥${t.toFixed(2)}`},maskedBankCard(){if(!this.purchaseForm.bankCard)return"";const e=this.purchaseForm.bankCard;return e.replace(/(\d{4})\d+(\d{4})/,"$1****$2")}},created(){this.loadProduct()},methods:{async finishRecordingWithWrapper(){try{console.log("è´­ä¹°é¡µé¢ï¼šè°ƒç”¨RecordWrapperå®Œæˆå½•åˆ¶...");let e=null;if(this.$parent&&"RecordWrapper"===this.$parent.$options.name)e=this.$parent;else{const t=e=>{if("RecordWrapper"===e.$options.name)return e;for(let s of e.$children||[]){const e=t(s);if(e)return e}return null};e=t(this.$root)}if(e&&"function"===typeof e.finishRecording){const t=await e.finishRecording({purchaseInfo:{productId:this.productId,productName:this.product.name,amount:this.purchaseForm.amount,bankCard:this.maskedBankCard,orderNo:this.orderNo,timestamp:Date.now(),page:"Purchase"}});console.log("è´­ä¹°é¡µé¢ï¼šå½•åˆ¶å®Œæˆç»“æœ:",t),this.recordingResult=t}else console.warn("æœªæ‰¾åˆ°RecordWrapperç»„ä»¶æˆ–finishRecordingæ–¹æ³•"),this.recordingResult={success:!1,error:"æœªæ‰¾åˆ°å½•åˆ¶ç»„ä»¶",message:"å½•åˆ¶ç»„ä»¶ä¸å¯ç”¨"},this.$toast.fail("å½•åˆ¶ç»„ä»¶ä¸å¯ç”¨")}catch(e){console.error("è´­ä¹°é¡µé¢ï¼šè°ƒç”¨å½•åˆ¶å®Œæˆå¤±è´¥:",e),this.recordingResult={success:!1,error:e.message,message:"å½•åˆ¶å®Œæˆå¤±è´¥"},this.$toast.fail("å½•åˆ¶å®Œæˆå¤±è´¥: "+e.message)}},loadProduct(){this.productId=parseInt(this.$route.params.id),this.product=this.products[this.productId]},nextStep(){this.currentStep<3&&this.currentStep++},validateAndNext(){if(!this.purchaseForm.amount)return void this.$toast.fail("è¯·å¡«å†™è´­ä¹°é‡‘é¢");if(!this.purchaseForm.bankCard)return void this.$toast.fail("è¯·å¡«å†™é“¶è¡Œå¡å·");if(!this.purchaseForm.password)return void this.$toast.fail("è¯·å¡«å†™äº¤æ˜“å¯†ç ");const e=parseInt(this.product.minAmount.replace(/[^\d]/g,""));parseInt(this.purchaseForm.amount)<e?this.$toast.fail(`è´­ä¹°é‡‘é¢ä¸èƒ½å°‘äº${this.product.minAmount}`):this.purchaseForm.bankCard.length<16?this.$toast.fail("è¯·è¾“å…¥æ­£ç¡®çš„é“¶è¡Œå¡å·"):this.purchaseForm.password.length<6?this.$toast.fail("äº¤æ˜“å¯†ç è‡³å°‘6ä½æ•°"):this.nextStep()},onFormSubmit(){this.nextStep()},async confirmPurchase(){try{const e=(await Promise.resolve().then(s.bind(s,678))).default,t=e.getInstance(),r=t.getRecordingStatus();if(!r.isRecording)return void this.$toast.fail("è¯·å…ˆåœ¨äº§å“åˆ—è¡¨é¡µå¼€å§‹å½•åˆ¶")}catch(e){return console.error("æ£€æŸ¥å½•åˆ¶çŠ¶æ€å¤±è´¥:",e),void this.$toast.fail("å½•åˆ¶çŠ¶æ€æ£€æŸ¥å¤±è´¥")}this.purchasing=!0;try{await new Promise((e=>setTimeout(e,2e3))),this.orderNo="PO"+Date.now(),this.purchaseTime=(new Date).toLocaleString(),this.purchasing=!1,this.nextStep(),setTimeout((async()=>{console.log("è´­ä¹°æˆåŠŸé¡µé¢å·²æ˜¾ç¤ºï¼Œå¼€å§‹åœæ­¢å½•åˆ¶...");const e=(await Promise.resolve().then(s.bind(s,678))).default,t=e.getInstance(),r=t.getRecordingStatus();if(console.log("å½“å‰å½•åˆ¶çŠ¶æ€:",r),r.isRecording)try{await this.finishRecordingWithWrapper()}finally{}else console.warn("å½•åˆ¶å·²åœæ­¢ï¼Œå¯èƒ½åœ¨è´­ä¹°è¿‡ç¨‹ä¸­è¢«ä¸­æ–­"),this.recordingResult={success:!1,error:"å½•åˆ¶åœ¨è´­ä¹°è¿‡ç¨‹ä¸­è¢«ä¸­æ–­",message:"å½•åˆ¶çŠ¶æ€å¼‚å¸¸ï¼Œè¯·é‡æ–°å¼€å§‹å½•åˆ¶æµç¨‹"},this.$toast.fail("å½•åˆ¶çŠ¶æ€å¼‚å¸¸")}),1500)}catch(e){console.error("è´­ä¹°æµç¨‹å‡ºé”™:",e),this.purchasing=!1,this.$toast.fail("è´­ä¹°å¤±è´¥ï¼Œè¯·é‡è¯•")}},formatFileSize(e){if(0===e)return"0 B";const t=1024,s=["B","KB","MB","GB"],r=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,r)).toFixed(2))+" "+s[r]},async startReplay(){if(this.recordingResult&&this.recordingResult.events)try{this.isReplaying=!0;const e=document.getElementById("replay-container");if(!e)throw new Error("å›æ”¾å®¹å™¨æœªæ‰¾åˆ°");e.innerHTML="",e.style.width="100%",e.style.height="600px",e.style.position="relative",e.style.overflow="visible",e.style.border="1px solid #eee",e.style.borderRadius="4px",e.style.backgroundColor="#f5f5f5",console.log("Purchaseé¡µé¢ï¼šå¼€å§‹å›æ”¾ï¼Œäº‹ä»¶æ•°é‡:",this.recordingResult.events.length),console.log("Purchaseé¡µé¢ï¼šå‰å‡ ä¸ªäº‹ä»¶:",this.recordingResult.events.slice(0,3));const t=this.recordingResult.events;if(!Array.isArray(t)||t.length<2)throw new Error("å½•åˆ¶æ•°æ®æ ¼å¼ä¸æ­£ç¡®æˆ–äº‹ä»¶å¤ªå°‘");const s=t.some((e=>4===e.type)),r=t.some((e=>2===e.type));if(!s||!r)throw new Error("å½•åˆ¶æ•°æ®ç¼ºå°‘å¿…è¦çš„å…ƒä¿¡æ¯æˆ–å¿«ç…§");if("undefined"===typeof window.rrwebPlayer)throw new Error("rrweb-playeråº“æœªæ‰¾åˆ°ï¼Œè¯·ç¡®ä¿å·²æ­£ç¡®å¼•å…¥");const a=window.rrwebPlayer;console.log("Purchaseé¡µé¢ï¼šåˆ›å»ºrrweb-player"),this.replayPlayer=new a({target:e,props:{events:t,width:e.offsetWidth||375,height:550,autoPlay:!1,showController:!0,showWarning:!1,showDebug:!1,speed:1,speedOption:[.5,1,1.5,2,4],skipInactive:!1,mouseTail:!1,tags:{"virtual-styles":{}}}}),console.log("Purchaseé¡µé¢ï¼šrrweb-playeråˆ›å»ºæˆåŠŸ"),setTimeout((()=>{const t=e.querySelectorAll("iframe");t.forEach((e=>{e.hasAttribute("sandbox")&&e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups allow-modals"),e.style.width="100%",e.style.height="100%",e.style.border="none"})),console.log("Purchaseé¡µé¢ï¼šå·²å®Œæˆå›æ”¾å™¨åˆå§‹åŒ–")}),500),this.replayPlayer&&this.replayPlayer.$on&&(this.replayPlayer.$on("finish",(()=>{this.isReplaying=!1,console.log("Purchaseé¡µé¢ï¼šå›æ”¾å®Œæˆ")})),this.replayPlayer.$on("start",(()=>{console.log("Purchaseé¡µé¢ï¼šå›æ”¾å¼€å§‹")}))),this.$toast.success("å¼€å§‹å›æ”¾è´­ä¹°æµç¨‹")}catch(e){console.error("Purchaseé¡µé¢ï¼šå›æ”¾å¤±è´¥:",e),this.isReplaying=!1,this.$toast.fail("å›æ”¾å¤±è´¥: "+e.message);const t=document.getElementById("replay-container");t&&(t.innerHTML=`\n            <div style="text-align: center; padding: 50px; color: #f56c6c; background: white;">\n              <h4>å›æ”¾å¤±è´¥</h4>\n              <p style="font-size: 12px; margin-top: 10px;">${e.message}</p>\n              <p style="font-size: 10px; color: #999; margin-top: 10px;">\n                äº‹ä»¶æ•°é‡: ${this.recordingResult.events?this.recordingResult.events.length:0}\n              </p>\n            </div>\n          `)}else this.$toast.fail("æ²¡æœ‰å½•åˆ¶æ•°æ®å¯å›æ”¾")},setupReplayerObserver(e,t){console.log("Purchaseé¡µé¢ï¼šè®¾ç½®DOMç›‘å¬å™¨"),this.replayerObserver&&this.replayerObserver.disconnect(),this.replayerObserver=new MutationObserver((s=>{let r=!1;s.forEach((e=>{"childList"===e.type&&e.addedNodes.forEach((e=>{if(1===e.nodeType){const t=e.className||"",s=e.tagName||"";(t.includes("replayer")||t.includes("rr-")||"IFRAME"===s||e.querySelector&&(e.querySelector(".replayer-wrapper")||e.querySelector(".rr-player")||e.querySelector('[class*="rr-"]')))&&(console.log("DOMç›‘å¬å™¨ï¼šå‘ç°æ–°çš„å›æ”¾å™¨å…ƒç´ ",s,t),r=!0)}}))})),r&&setTimeout((()=>{this.forceFixReplayerPosition(e,t)}),100)})),this.replayerObserver.observe(document.body,{childList:!0,subtree:!0})},forceFixReplayerPosition(e,t){console.log("Purchaseé¡µé¢ï¼šå¼€å§‹å¼ºåˆ¶ä¿®å¤å›æ”¾å™¨ä½ç½®");const s=document.querySelectorAll('\n        .replayer-wrapper,\n        .rr-player,\n        [class*="rr-"],\n        [class*="replayer"],\n        iframe[src*="blob:"]\n      ');console.log("æ‰¾åˆ°çš„å›æ”¾å™¨ç›¸å…³å…ƒç´ æ•°é‡:",s.length);let r=!1;s.forEach(((s,a)=>{if(console.log(`å…ƒç´  ${a}:`,s.tagName,s.className,"çˆ¶å…ƒç´ :",s.parentElement?.className),e.contains(s)){if(!t.contains(s)&&s!==t){console.log("å°†å…ƒç´ ç§»åŠ¨åˆ°wrapperå†…:",s.className||s.tagName);try{t.appendChild(s),this.fixReplayerPosition(s,t),r=!0}catch(o){console.error("ç§»åŠ¨åˆ°wrapperå¤±è´¥:",o)}}}else{console.log("ç§»åŠ¨å…ƒç´ åˆ°å®¹å™¨å†…:",s.className||s.tagName);try{t.appendChild(s),this.fixReplayerPosition(s,t),r=!0}catch(o){console.error("ç§»åŠ¨å…ƒç´ å¤±è´¥:",o)}}}));const a=Array.from(document.body.children);a.forEach((e=>{if(e.className&&(e.className.includes("replayer")||e.className.includes("rr-")||"IFRAME"===e.tagName)){console.log("å‘ç°bodyä¸‹çš„å›æ”¾å™¨å…ƒç´ :",e.className||e.tagName);try{t.appendChild(e),this.fixReplayerPosition(e,t),r=!0}catch(s){console.error("ä»bodyç§»åŠ¨å…ƒç´ å¤±è´¥:",s)}}})),r?(console.log("Purchaseé¡µé¢ï¼šå·²ç§»åŠ¨å›æ”¾å™¨å…ƒç´ åˆ°æ­£ç¡®ä½ç½®"),console.log("æœ€ç»ˆå®¹å™¨ç»“æ„:",e.innerHTML.substring(0,300))):console.log("Purchaseé¡µé¢ï¼šæœªå‘ç°éœ€è¦ç§»åŠ¨çš„å›æ”¾å™¨å…ƒç´ ")},fixReplayerPosition(e,t){if(!e||!t)return;console.log("ä¿®å¤å›æ”¾å™¨å…ƒç´ :",e.tagName,e.className),e.style.position="relative",e.style.width="100%",e.style.height="400px",e.style.border="none",e.style.background="#fff",e.style.left="0",e.style.top="0",e.style.transform="none",e.style.margin="0",e.style.padding="0",e.style.display="block",e.style.visibility="visible",e.style.opacity="1";const s=e.querySelector("iframe");s&&(console.log("ä¿®å¤iframe:",s.src?s.src.substring(0,50):"no src"),s.style.width="100%",s.style.height="100%",s.style.border="none",s.style.display="block",s.style.visibility="visible",s.style.opacity="1",s.hasAttribute("sandbox")&&(console.log("ä¿®å¤iframe sandboxæƒé™"),s.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups allow-modals")));const r=e.querySelectorAll("video, canvas");r.forEach((e=>{console.log("ä¿®å¤è§†é¢‘/canvaså…ƒç´ :",e.tagName),e.style.display="block",e.style.visibility="visible",e.style.opacity="1",e.style.width="100%",e.style.height="auto"}));const a=e.querySelector(".rr-controller");a&&(a.style.position="absolute",a.style.bottom="0",a.style.left="0",a.style.right="0",a.style.height="auto",a.style.zIndex="10",a.style.display="block",a.style.visibility="visible"),console.log("å·²ä¿®å¤å›æ”¾å™¨ä½ç½®å’Œå¯è§æ€§:",e.className)},debugReplayerStructure(e){console.log("=== å›æ”¾å™¨DOMç»“æ„è°ƒè¯• ==="),console.log("å®¹å™¨:",e.id,e.className),console.log("å®¹å™¨å†…å®¹:",e.innerHTML.length,"å­—ç¬¦");const t=Array.from(e.children);t.forEach(((e,t)=>{console.log(`å­å…ƒç´  ${t}:`,e.tagName,e.className,{display:e.style.display||getComputedStyle(e).display,visibility:e.style.visibility||getComputedStyle(e).visibility,opacity:e.style.opacity||getComputedStyle(e).opacity,width:e.offsetWidth,height:e.offsetHeight});const s=e.querySelector("iframe");s&&console.log("  -> iframe:",{src:s.src?s.src.substring(0,50)+"...":"no src",display:s.style.display||getComputedStyle(s).display,visibility:s.style.visibility||getComputedStyle(s).visibility,width:s.offsetWidth,height:s.offsetHeight,loaded:s.contentDocument?"yes":"no"});const r=e.querySelectorAll("video, canvas");r.forEach(((e,t)=>{console.log(`  -> ${e.tagName} ${t}:`,{display:e.style.display||getComputedStyle(e).display,width:e.offsetWidth,height:e.offsetHeight})}))})),console.log("=== è°ƒè¯•ç»“æŸ ===")},stopReplay(){if(this.replayPlayer)try{this.replayPlayer.$destroy&&this.replayPlayer.$destroy(),this.replayPlayer=null}catch(t){console.error("åœæ­¢å›æ”¾å¤±è´¥:",t)}this.isReplaying=!1;const e=document.getElementById("replay-container");e&&(e.innerHTML='<div style="text-align: center; padding: 50px; color: #999;">å›æ”¾å·²åœæ­¢</div>')},goToProducts(){this.stopReplay(),this.$router.push("/products")},goHome(){this.stopReplay(),this.$router.push("/")},onRecordStarted(){console.log("è´­ä¹°æµç¨‹å½•åˆ¶å¼€å§‹"),this.$toast.success("å¼€å§‹å½•åˆ¶è´­ä¹°æµç¨‹")},onRecordStopped(e){console.log("è´­ä¹°æµç¨‹å½•åˆ¶å®Œæˆ:",e),this.$toast.success("è´­ä¹°æµç¨‹å½•åˆ¶å®Œæˆ")}},beforeDestroy(){this.stopReplay()}},Te=Se,Fe=(0,l.A)(Te,Pe,xe,!1,null,"510dfe0e",null),ze=(Fe.exports,function(){var e=this,t=e._self._c;return t("RecordWrapper",{attrs:{"auto-start":!1,"show-controls":!1,"stop-on-destroy":!0,metadata:{action:"redeem",productId:e.productId}},on:{"record-started":e.onRecordStarted,"record-stopped":e.onRecordStopped}},[t("div",{staticClass:"redeem"},[t("van-nav-bar",{attrs:{title:"äº§å“èµå›","left-arrow":"",fixed:""},on:{"click-left":function(t){return e.$router.back()}}}),e.product?t("div",{staticClass:"content"},[t("div",{staticClass:"product-info-card"},[t("div",{staticClass:"product-header"},[t("h3",{staticClass:"product-name"},[e._v(e._s(e.product.name))]),t("div",{staticClass:"product-return"},[e._v(e._s(e.product.expectedReturn))])]),t("p",{staticClass:"product-desc"},[e._v(e._s(e.product.description))])]),t("div",{staticClass:"steps-container"},[t("van-steps",{attrs:{active:e.currentStep,direction:"horizontal"}},[t("van-step",[e._v("é€‰æ‹©äº§å“")]),t("van-step",[e._v("å¡«å†™ä¿¡æ¯")]),t("van-step",[e._v("ç¡®è®¤èµå›")]),t("van-step",[e._v("èµå›å®Œæˆ")])],1)],1),t("div",{staticClass:"step-content"},[0===e.currentStep?t("div",{staticClass:"step-card"},[t("h4",{staticClass:"step-title"},[e._v("æŒæœ‰äº§å“")]),t("van-cell-group",[t("van-cell",{attrs:{title:"äº§å“åç§°",value:e.product.name}}),t("van-cell",{attrs:{title:"æŒæœ‰é‡‘é¢",value:"Â¥50,000"}}),t("van-cell",{attrs:{title:"ç´¯è®¡æ”¶ç›Š",value:"Â¥2,100"}}),t("van-cell",{attrs:{title:"æŒæœ‰å¤©æ•°",value:"45å¤©"}})],1),t("div",{staticClass:"step-actions"},[t("van-button",{attrs:{type:"primary",size:"large",block:"",round:""},on:{click:e.nextStep}},[e._v(" é€‰æ‹©æ­¤äº§å“èµå› ")])],1)],1):e._e(),1===e.currentStep?t("div",{staticClass:"step-card"},[t("h4",{staticClass:"step-title"},[e._v("å¡«å†™èµå›ä¿¡æ¯")]),t("van-form",{ref:"redeemForm",on:{submit:e.onFormSubmit}},[t("van-field",{attrs:{name:"redeemType",label:"èµå›ç±»å‹",placeholder:"è¯·é€‰æ‹©èµå›ç±»å‹",readonly:"",rules:[{required:!0,message:"è¯·é€‰æ‹©èµå›ç±»å‹"}]},on:{click:function(t){e.showRedeemTypePicker=!0}},model:{value:e.redeemForm.redeemType,callback:function(t){e.$set(e.redeemForm,"redeemType",t)},expression:"redeemForm.redeemType"}}),t("van-field",{attrs:{name:"amount",label:"èµå›é‡‘é¢",placeholder:"è¯·è¾“å…¥èµå›é‡‘é¢",type:"number",rules:[{required:!0,message:"è¯·å¡«å†™èµå›é‡‘é¢"}]},model:{value:e.redeemForm.amount,callback:function(t){e.$set(e.redeemForm,"amount",t)},expression:"redeemForm.amount"}}),t("van-field",{attrs:{name:"bankCard",label:"æ”¶æ¬¾é“¶è¡Œå¡",placeholder:"è¯·è¾“å…¥æ”¶æ¬¾é“¶è¡Œå¡å·",rules:[{required:!0,message:"è¯·å¡«å†™é“¶è¡Œå¡å·"}]},model:{value:e.redeemForm.bankCard,callback:function(t){e.$set(e.redeemForm,"bankCard",t)},expression:"redeemForm.bankCard"}}),t("van-field",{attrs:{name:"password",label:"äº¤æ˜“å¯†ç ",placeholder:"è¯·è¾“å…¥äº¤æ˜“å¯†ç ",type:"password",rules:[{required:!0,message:"è¯·å¡«å†™äº¤æ˜“å¯†ç "}]},model:{value:e.redeemForm.password,callback:function(t){e.$set(e.redeemForm,"password",t)},expression:"redeemForm.password"}}),t("div",{staticClass:"step-actions"},[t("van-button",{attrs:{type:"primary",size:"large",block:"",round:""},on:{click:e.validateAndNext}},[e._v(" ä¸‹ä¸€æ­¥ ")])],1)],1)],1):e._e(),2===e.currentStep?t("div",{staticClass:"step-card"},[t("h4",{staticClass:"step-title"},[e._v("ç¡®è®¤èµå›ä¿¡æ¯")]),t("van-cell-group",[t("van-cell",{attrs:{title:"äº§å“åç§°",value:e.product.name}}),t("van-cell",{attrs:{title:"èµå›ç±»å‹",value:e.redeemForm.redeemType}}),t("van-cell",{attrs:{title:"èµå›é‡‘é¢",value:`Â¥${e.redeemForm.amount}`}}),t("van-cell",{attrs:{title:"é¢„è®¡åˆ°è´¦",value:e.expectedArrival}}),t("van-cell",{attrs:{title:"æ”¶æ¬¾é“¶è¡Œå¡",value:e.maskedBankCard}})],1),t("div",{staticClass:"notice-section"},[t("van-notice-bar",{attrs:{"left-icon":"info-o",text:"åˆ°è´¦æ—¶é—´ï¼šT+1ä¸ªå·¥ä½œæ—¥åˆ°è´¦ï¼Œæœ¬äº§å“èµå›å…æ‰‹ç»­è´¹"}})],1),t("div",{staticClass:"step-actions"},[t("van-button",{attrs:{type:"primary",size:"large",block:"",round:"",loading:e.redeeming},on:{click:e.confirmRedeem}},[e._v(" ç¡®è®¤èµå› ")])],1)],1):e._e(),3===e.currentStep?t("div",{staticClass:"step-card success-card"},[t("div",{staticClass:"success-content"},[t("van-icon",{attrs:{name:"success",size:"50",color:"#07c160"}}),t("h3",[e._v("èµå›ç”³è¯·æˆåŠŸï¼")]),t("p",[e._v("æ‚¨çš„èµå›ç”³è¯·å·²æäº¤ï¼Œèµ„é‡‘å°†åœ¨T+1ä¸ªå·¥ä½œæ—¥åˆ°è´¦")]),t("van-cell-group",[t("van-cell",{attrs:{title:"èµå›å•å·",value:e.redeemNo}}),t("van-cell",{attrs:{title:"ç”³è¯·æ—¶é—´",value:e.redeemTime}}),t("van-cell",{attrs:{title:"èµå›é‡‘é¢",value:`Â¥${e.redeemForm.amount}`}}),t("van-cell",{attrs:{title:"é¢„è®¡åˆ°è´¦",value:e.expectedArrival}}),e.recordingResult?t("van-cell",{attrs:{title:"å½•åˆ¶çŠ¶æ€",value:e.recordingResult.success?"å½•åˆ¶å®Œæˆ":"å½•åˆ¶å¤±è´¥"}}):e._e(),e.recordingResult&&e.recordingResult.dataSize?t("van-cell",{attrs:{title:"å½•åˆ¶æ•°æ®å¤§å°",value:e.recordingResult.dataSize}}):e._e(),e.recordingResult&&e.recordingResult.compressionRatio?t("van-cell",{attrs:{title:"å‹ç¼©ç‡",value:e.recordingResult.compressionRatio}}):e._e()],1),e.recordingResult&&e.recordingResult.success&&e.recordingResult.events?t("div",{staticClass:"replay-section"},[t("h4",[e._v("èµå›æµç¨‹å›æ”¾")]),t("div",{staticClass:"replay-controls"},[t("van-button",{attrs:{type:"primary",size:"small",disabled:e.isReplaying},on:{click:e.startReplay}},[e._v(" "+e._s(e.isReplaying?"æ­£åœ¨å›æ”¾...":"å¼€å§‹å›æ”¾")+" ")]),e.isReplaying?t("van-button",{attrs:{size:"small"},on:{click:e.stopReplay}},[e._v(" åœæ­¢å›æ”¾ ")]):e._e()],1),t("div",{staticClass:"replay-container",staticStyle:{border:"1px solid #eee",background:"#f5f5f5","min-height":"300px","margin-top":"12px"},attrs:{id:"redeem-replay-container"}})]):e._e(),e.recordingResult&&e.recordingResult.success?t("div",{staticClass:"recording-success-section"},[t("h4",[e._v("å½•åˆ¶çŠ¶æ€")]),t("van-notice-bar",{attrs:{type:"success",text:"å½•åˆ¶æ•°æ®å¤„ç†å¹¶ä¸Šä¼ æˆåŠŸ"}}),t("div",{staticClass:"success-info",staticStyle:{"margin-top":"12px"}},[t("div",{staticClass:"success-item"},[t("span",{staticClass:"label"},[e._v("äº‹ä»¶æ•°é‡:")]),t("span",{staticClass:"value"},[e._v(e._s(e.recordingResult.recordingResult?e.recordingResult.recordingResult.eventCount:e.recordingResult.data?e.recordingResult.data.finalData.totalEvents:0))])]),t("div",{staticClass:"success-item"},[t("span",{staticClass:"label"},[e._v("åŸå§‹å¤§å°:")]),t("span",{staticClass:"value"},[e._v(e._s(e.formatFileSize(e.recordingResult.stats.originalSize)))])]),t("div",{staticClass:"success-item"},[t("span",{staticClass:"label"},[e._v("å‹ç¼©å¤§å°:")]),t("span",{staticClass:"value"},[e._v(e._s(e.formatFileSize(e.recordingResult.stats.compressedSize)))])]),t("div",{staticClass:"success-item"},[t("span",{staticClass:"label"},[e._v("å‹ç¼©ç‡:")]),t("span",{staticClass:"value"},[e._v(e._s(e.recordingResult.stats.compressionRatio))])]),t("div",{staticClass:"success-item"},[t("span",{staticClass:"label"},[e._v("ä¸Šä¼ çŠ¶æ€:")]),t("van-tag",{attrs:{type:e.recordingResult.uploadResult.success?"success":"danger"}},[e._v(" "+e._s(e.recordingResult.uploadResult.success?"æˆåŠŸ":"å¤±è´¥")+" ")])],1),e.recordingResult.uploadResult.success?t("div",{staticClass:"success-item"},[t("span",{staticClass:"label"},[e._v("ä¸Šä¼ ID:")]),t("span",{staticClass:"value"},[e._v(e._s(e.recordingResult.uploadResult.uploadId))])]):e._e()]),t("div",{staticClass:"upload-details",staticStyle:{"margin-top":"16px"}},[t("h4",{staticStyle:{"font-size":"14px","margin-bottom":"8px"}},[e._v("ä¸Šä¼ ç»“æœè¯¦æƒ…:")]),t("div",{staticClass:"upload-result",staticStyle:{background:"#f7f8fa",padding:"12px","border-radius":"4px","font-size":"12px","overflow-x":"auto"}},[t("pre",{staticStyle:{margin:"0","white-space":"pre-wrap","word-break":"break-all"}},[e._v(e._s(JSON.stringify(e.recordingResult.uploadResult,null,2)))])])])],1):e.recordingResult&&!e.recordingResult.success?t("div",{staticClass:"recording-error-section"},[t("h4",[e._v("å½•åˆ¶çŠ¶æ€")]),t("van-notice-bar",{attrs:{type:"danger",text:e.recordingResult.message||e.recordingResult.error||"å½•åˆ¶å¤±è´¥"}}),t("div",{staticClass:"error-suggestion",staticStyle:{"margin-top":"12px",padding:"12px",background:"#fff2f0","border-radius":"4px"}},[t("p",{staticStyle:{margin:"0",color:"#ff4757","font-size":"14px"}},[t("van-icon",{staticStyle:{"margin-right":"4px"},attrs:{name:"info-o"}}),e._v(" å»ºè®®æ“ä½œæµç¨‹ï¼š ")],1),t("ol",{staticStyle:{margin:"8px 0 0 20px",color:"#666","font-size":"13px"}},[t("li",[e._v("è¿”å›äº§å“åˆ—è¡¨é¡µé¢")]),t("li",[e._v('ç‚¹å‡»"å¼€å§‹å½•åˆ¶"æŒ‰é’®')]),t("li",[e._v("å†æ¬¡è¿›è¡Œèµå›æ“ä½œ")])])])],1):t("div",{staticClass:"no-recording-section"},[t("h4",[e._v("å½•åˆ¶çŠ¶æ€")]),t("van-notice-bar",{attrs:{type:"warning",text:"æ²¡æœ‰å½•åˆ¶æ•°æ®ï¼Œè¯·ç¡®ä¿åœ¨æ“ä½œå‰å·²å¼€å§‹å½•åˆ¶"}})],1),t("div",{staticClass:"step-actions"},[e.recordingResult&&e.recordingResult.success?t("van-button",{attrs:{type:"primary",size:"large",block:"",round:""},on:{click:e.goHome}},[e._v(" è¿”å›é¦–é¡µ ")]):[t("van-button",{staticStyle:{"margin-bottom":"12px"},attrs:{type:"primary",size:"large",block:"",round:""},on:{click:e.goToProducts}},[e._v(" é‡æ–°å¼€å§‹å½•åˆ¶ ")]),t("van-button",{attrs:{type:"default",size:"large",block:"",round:""},on:{click:e.goHome}},[e._v(" è¿”å›é¦–é¡µ ")])]],2)],1)]):e._e()])]):e._e(),t("van-action-sheet",{attrs:{actions:e.redeemTypeActions,"cancel-text":"å–æ¶ˆ",title:"é€‰æ‹©èµå›ç±»å‹"},on:{select:e.onRedeemTypeSelect},model:{value:e.showRedeemTypePicker,callback:function(t){e.showRedeemTypePicker=t},expression:"showRedeemTypePicker"}})],1)])}),De=[],Ae={name:"Redeem",components:{RecordWrapper:ve},data(){return{productId:null,product:null,currentStep:0,redeeming:!1,showRedeemTypePicker:!1,redeemForm:{redeemType:"",amount:"",bankCard:"",password:""},redeemNo:"",redeemTime:"",recordingResult:null,isReplaying:!1,replayPlayer:null,replayerObserver:null,redeemTypeActions:[{name:"å…¨éƒ¨èµå›",value:"full"},{name:"éƒ¨åˆ†èµå›",value:"partial"}],products:{1:{id:1,name:"ç¨³å¥å¢é•¿ç†è´¢äº§å“",description:"ä½é£é™©ï¼Œç¨³å®šæ”¶ç›Šï¼Œé€‚åˆä¿å®ˆå‹æŠ•èµ„è€…",expectedReturn:"4.2%",minAmount:"1000å…ƒ",term:"90å¤©",image:"https://img.yzcdn.cn/vant/cat.jpeg"},2:{id:2,name:"å¹³è¡¡é…ç½®ç†è´¢äº§å“",description:"ä¸­ç­‰é£é™©ï¼Œå‡è¡¡æ”¶ç›Šï¼Œé€‚åˆç¨³å¥å‹æŠ•èµ„è€…",expectedReturn:"6.8%",minAmount:"5000å…ƒ",term:"180å¤©",image:"https://img.yzcdn.cn/vant/cat.jpeg"},3:{id:3,name:"æˆé•¿æœºä¼šç†è´¢äº§å“",description:"é«˜é£é™©é«˜æ”¶ç›Šï¼Œé€‚åˆç§¯æå‹æŠ•èµ„è€…",expectedReturn:"9.5%",minAmount:"10000å…ƒ",term:"365å¤©",image:"https://img.yzcdn.cn/vant/cat.jpeg"}}}},computed:{expectedArrival(){return this.redeemForm.amount?`Â¥${this.redeemForm.amount}`:"Â¥0"},maskedBankCard(){if(!this.redeemForm.bankCard)return"";const e=this.redeemForm.bankCard;return e.replace(/(\d{4})\d+(\d{4})/,"$1****$2")}},created(){this.loadProduct()},methods:{loadProduct(){this.productId=parseInt(this.$route.params.id),this.product=this.products[this.productId]},nextStep(){this.currentStep<3&&this.currentStep++},validateAndNext(){this.redeemForm.redeemType?this.redeemForm.amount?this.redeemForm.bankCard?this.redeemForm.password?parseInt(this.redeemForm.amount)<=0?this.$toast.fail("èµå›é‡‘é¢å¿…é¡»å¤§äº0"):this.redeemForm.bankCard.length<16?this.$toast.fail("è¯·è¾“å…¥æ­£ç¡®çš„é“¶è¡Œå¡å·"):this.redeemForm.password.length<6?this.$toast.fail("äº¤æ˜“å¯†ç è‡³å°‘6ä½æ•°"):this.nextStep():this.$toast.fail("è¯·å¡«å†™äº¤æ˜“å¯†ç "):this.$toast.fail("è¯·å¡«å†™æ”¶æ¬¾é“¶è¡Œå¡å·"):this.$toast.fail("è¯·å¡«å†™èµå›é‡‘é¢"):this.$toast.fail("è¯·é€‰æ‹©èµå›ç±»å‹")},onFormSubmit(){this.nextStep()},onRedeemTypeSelect(e){this.redeemForm.redeemType=e.name,this.showRedeemTypePicker=!1},async confirmRedeem(){try{const e=(await Promise.resolve().then(s.bind(s,678))).default,t=e.getInstance(),r=t.getRecordingStatus();if(!r.isRecording)return void this.$toast.fail("è¯·å…ˆåœ¨äº§å“åˆ—è¡¨é¡µå¼€å§‹å½•åˆ¶")}catch(e){return console.error("æ£€æŸ¥å½•åˆ¶çŠ¶æ€å¤±è´¥:",e),void this.$toast.fail("å½•åˆ¶çŠ¶æ€æ£€æŸ¥å¤±è´¥")}this.redeeming=!0;try{await new Promise((e=>setTimeout(e,2e3))),this.redeemNo="RD"+Date.now(),this.redeemTime=(new Date).toLocaleString(),this.redeeming=!1,this.nextStep(),setTimeout((async()=>{console.log("èµå›æˆåŠŸé¡µé¢å·²æ˜¾ç¤ºï¼Œå¼€å§‹åœæ­¢å½•åˆ¶...");const e=(await Promise.resolve().then(s.bind(s,678))).default,t=e.getInstance(),r=t.getRecordingStatus();if(console.log("å½“å‰å½•åˆ¶çŠ¶æ€:",r),r.isRecording)try{await this.stopRecordingAndProcess()}finally{}else console.warn("å½•åˆ¶å·²åœæ­¢ï¼Œå¯èƒ½åœ¨èµå›è¿‡ç¨‹ä¸­è¢«ä¸­æ–­"),this.recordingResult={success:!1,error:"å½•åˆ¶åœ¨èµå›è¿‡ç¨‹ä¸­è¢«ä¸­æ–­",message:"å½•åˆ¶çŠ¶æ€å¼‚å¸¸ï¼Œè¯·é‡æ–°å¼€å§‹å½•åˆ¶æµç¨‹"},this.$toast.fail("å½•åˆ¶çŠ¶æ€å¼‚å¸¸")}),1500)}catch(e){console.error("èµå›æµç¨‹å‡ºé”™:",e),this.redeeming=!1,this.$toast.fail("èµå›å¤±è´¥ï¼Œè¯·é‡è¯•")}},async stopRecordingAndProcess(){try{const e=(await Promise.resolve().then(s.bind(s,678))).default,t=e.getInstance(),r=await t.stopRecordingAndProcess({redeemInfo:{productId:this.productId,productName:this.product.name,amount:this.redeemForm.amount,bankCard:this.maskedBankCard,redeemNo:this.redeemNo,timestamp:Date.now()}});if(console.log("èµå›é¡µé¢ï¼šå½•åˆ¶æ•°æ®å¤„ç†ç»“æœ:",r),r.success){const e=await t.uploadRecordingData(r.data);console.log("èµå›é¡µé¢ï¼šä¸Šä¼ ç»“æœ:",e),this.recordingResult={success:!0,events:r.recordingResult.events,data:r.data,uploadResult:e,stats:{originalSize:r.data.sizes.original,compressedSize:r.data.sizes.compressed,compressionRatio:r.data.compressionRatio,eventCount:r.data.finalData.totalEvents}},this.$toast.success("å½•åˆ¶æ•°æ®å¤„ç†å¹¶ä¸Šä¼ æˆåŠŸ")}else console.warn("èµå›é¡µé¢ï¼šå½•åˆ¶æ•°æ®å¤„ç†å¤±è´¥:",r.error),this.recordingResult={success:!1,error:r.error,message:"å½•åˆ¶æ•°æ®ä¸ºç©º"===r.error?"è¯·å…ˆåœ¨äº§å“åˆ—è¡¨é¡µé¢å¼€å§‹å½•åˆ¶ï¼Œç„¶åè¿›è¡Œèµå›æ“ä½œ":"å½•åˆ¶è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯"},this.$toast.fail("å½•åˆ¶æ•°æ®å¤„ç†å¤±è´¥: "+r.error)}catch(e){console.error("èµå›é¡µé¢ï¼šåœæ­¢å½•åˆ¶å¹¶å¤„ç†æ•°æ®å¤±è´¥:",e),this.recordingResult={success:!1,error:e.message},this.$toast.fail("å½•åˆ¶å¤„ç†å¤±è´¥: "+e.message)}},async processRecordingData(e){try{const t=JSON.stringify(e),s=new Blob([t]).size;if("undefined"===typeof window.pako)throw new Error("pakoå‹ç¼©åº“æœªæ‰¾åˆ°ï¼Œè¯·ç¡®ä¿å·²æ­£ç¡®å¼•å…¥");const r=window.pako,a=r.gzip(t),o=a.length,i=(100*(1-o/s)).toFixed(1)+"%";return{success:!0,events:e.events,originalSize:this.formatFileSize(s),compressedSize:o,dataSize:this.formatFileSize(o),compressionRatio:i,compressedSizeBytes:o,compressedData:Array.from(a),metadata:{...e.metadata,redeemNo:this.redeemNo,redeemAmount:this.redeemForm.amount,redeemType:this.redeemForm.redeemType,processTime:(new Date).toISOString()}}}catch(t){return console.error("å¤„ç†å½•åˆ¶æ•°æ®å¤±è´¥:",t),{success:!1,error:t.message}}},async optimizeRecordingData(e){try{let t=[...e.events];if(t=t.filter(((e,s)=>!(3===e.type&&1===e.data?.source&&s>0&&3===t[s-1].type))),t.length>1e3){const e=Math.ceil(t.length/1e3);t=t.filter(((t,s)=>s%e===0))}t=t.map((e=>{const t={...e};return e.data&&"object"===typeof e.data&&(delete t.data.isCustom,delete t.data.plugin),t}));const s={...e,events:t,metadata:{...e.metadata,optimized:!0,originalEventCount:e.events.length,optimizedEventCount:t.length}};return await this.processRecordingData(s)}catch(t){return console.error("ä¼˜åŒ–å½•åˆ¶æ•°æ®å¤±è´¥:",t),{success:!1,error:t.message}}},async uploadRecordingData(e){try{const t={type:"redeem_recording",redeemNo:this.redeemNo,productId:this.productId,compressedData:e.compressedData,metadata:e.metadata,size:e.compressedSizeBytes,compressionInfo:{originalSize:e.originalSize,compressedSize:e.dataSize,compressionRatio:e.compressionRatio}};console.log("ä¸Šä¼ å½•åˆ¶æ•°æ®:",t),await new Promise((e=>setTimeout(e,1e3))),this.$toast.success("å½•åˆ¶æ•°æ®ä¸Šä¼ æˆåŠŸ")}catch(t){console.error("ä¸Šä¼ å½•åˆ¶æ•°æ®å¤±è´¥:",t),this.$toast.fail("å½•åˆ¶æ•°æ®ä¸Šä¼ å¤±è´¥")}},formatFileSize(e){if(0===e)return"0 B";const t=1024,s=["B","KB","MB","GB"],r=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,r)).toFixed(2))+" "+s[r]},async startReplay(){if(this.recordingResult&&this.recordingResult.events)try{this.isReplaying=!0;const e=document.getElementById("replay-container");if(!e)throw new Error("å›æ”¾å®¹å™¨æœªæ‰¾åˆ°");e.innerHTML="",e.style.width="100%",e.style.height="600px",e.style.position="relative",e.style.overflow="visible",e.style.border="1px solid #eee",e.style.borderRadius="4px",e.style.backgroundColor="#f5f5f5",console.log("Redeemé¡µé¢ï¼šå¼€å§‹å›æ”¾ï¼Œäº‹ä»¶æ•°é‡:",this.recordingResult.events.length),console.log("Redeemé¡µé¢ï¼šå‰å‡ ä¸ªäº‹ä»¶:",this.recordingResult.events.slice(0,3));const t=this.recordingResult.events;if(!Array.isArray(t)||t.length<2)throw new Error("å½•åˆ¶æ•°æ®æ ¼å¼ä¸æ­£ç¡®æˆ–äº‹ä»¶å¤ªå°‘");const s=t.some((e=>4===e.type)),r=t.some((e=>2===e.type));if(!s||!r)throw new Error("å½•åˆ¶æ•°æ®ç¼ºå°‘å¿…è¦çš„å…ƒä¿¡æ¯æˆ–å¿«ç…§");if("undefined"===typeof window.rrwebPlayer)throw new Error("rrweb-playeråº“æœªæ‰¾åˆ°ï¼Œè¯·ç¡®ä¿å·²æ­£ç¡®å¼•å…¥");const a=window.rrwebPlayer;console.log("Redeemé¡µé¢ï¼šåˆ›å»ºrrweb-player"),this.replayPlayer=new a({target:e,props:{events:t,width:e.offsetWidth||375,height:550,autoPlay:!1,showController:!0,showWarning:!1,showDebug:!1,speed:1,speedOption:[.5,1,1.5,2,4],skipInactive:!1,mouseTail:!1,tags:{"virtual-styles":{}}}}),console.log("Redeemé¡µé¢ï¼šrrweb-playeråˆ›å»ºæˆåŠŸ"),setTimeout((()=>{const t=e.querySelectorAll("iframe");t.forEach((e=>{e.hasAttribute("sandbox")&&e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups allow-modals"),e.style.width="100%",e.style.height="100%",e.style.border="none"})),console.log("Redeemé¡µé¢ï¼šå·²å®Œæˆå›æ”¾å™¨åˆå§‹åŒ–")}),500),this.replayPlayer&&this.replayPlayer.$on&&(this.replayPlayer.$on("finish",(()=>{this.isReplaying=!1,console.log("Redeemé¡µé¢ï¼šå›æ”¾å®Œæˆ")})),this.replayPlayer.$on("start",(()=>{console.log("Redeemé¡µé¢ï¼šå›æ”¾å¼€å§‹")}))),this.$toast.success("å¼€å§‹å›æ”¾èµå›æµç¨‹")}catch(e){console.error("Redeemé¡µé¢ï¼šå›æ”¾å¤±è´¥:",e),this.isReplaying=!1,this.$toast.fail("å›æ”¾å¤±è´¥: "+e.message);const t=document.getElementById("replay-container");t&&(t.innerHTML=`\n            <div style="text-align: center; padding: 50px; color: #f56c6c; background: white;">\n              <h4>å›æ”¾å¤±è´¥</h4>\n              <p style="font-size: 12px; margin-top: 10px;">${e.message}</p>\n              <p style="font-size: 10px; color: #999; margin-top: 10px;">\n                äº‹ä»¶æ•°é‡: ${this.recordingResult.events?this.recordingResult.events.length:0}\n              </p>\n            </div>\n          `)}else this.$toast.fail("æ²¡æœ‰å½•åˆ¶æ•°æ®å¯å›æ”¾")},stopReplay(){if(this.replayPlayer)try{this.replayPlayer.$destroy&&this.replayPlayer.$destroy(),this.replayPlayer=null}catch(t){console.error("åœæ­¢å›æ”¾å¤±è´¥:",t)}this.isReplaying=!1;const e=document.getElementById("replay-container");e&&(e.innerHTML='<div style="text-align: center; padding: 50px; color: #999;">å›æ”¾å·²åœæ­¢</div>')},formatFileSize(e){if(0===e)return"0 B";const t=1024,s=["B","KB","MB","GB"],r=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,r)).toFixed(2))+" "+s[r]},goToProducts(){this.stopReplay(),this.$router.push("/products")},goHome(){this.stopReplay(),this.$router.push("/")},onRecordStarted(){console.log("èµå›æµç¨‹å½•åˆ¶å¼€å§‹"),this.$toast.success("å¼€å§‹å½•åˆ¶èµå›æµç¨‹")},onRecordStopped(e){console.log("èµå›æµç¨‹å½•åˆ¶å®Œæˆ:",e),this.$toast.success("èµå›æµç¨‹å½•åˆ¶å®Œæˆ")}},beforeDestroy(){this.stopReplay()}},Ie=Ae,Ne=(0,l.A)(Ie,ze,De,!1,null,"aa4658bc",null),Oe=(Ne.exports,function(){var e=this,t=e._self._c;return t("div",{staticClass:"record-player"},[t("van-nav-bar",{attrs:{title:"å½•åˆ¶å›æ”¾","left-arrow":""},on:{"click-left":function(t){return e.$router.back()}}}),t("div",{staticClass:"content"},[t("van-cell-group",{attrs:{title:"å½•åˆ¶è®°å½•"}},e._l(e.records,(function(s){return t("van-cell",{key:s.id,attrs:{title:s.title,label:s.description,value:s.duration,"is-link":""},on:{click:function(t){return e.playRecord(s)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("van-icon",{attrs:{name:"video-o"}})]},proxy:!0}],null,!0)})})),1),e.currentRecord?t("div",{staticClass:"player-container"},[t("h3",[e._v(e._s(e.currentRecord.title))]),t("div",{ref:"playerContainer",staticClass:"player"}),t("div",{staticClass:"player-controls"},[t("van-button",{attrs:{size:"small",icon:e.isPlaying?"pause":"play"},on:{click:e.togglePlay}},[e._v(" "+e._s(e.isPlaying?"æš‚åœ":"æ’­æ”¾")+" ")]),t("van-button",{attrs:{size:"small",icon:"replay"},on:{click:e.resetPlayer}},[e._v(" é‡æ’­ ")]),t("van-button",{attrs:{size:"small",icon:"cross"},on:{click:e.closePlayer}},[e._v(" å…³é—­ ")])],1)]):e._e(),0===e.records.length?t("div",{staticClass:"empty-state"},[t("van-icon",{attrs:{name:"video-o",size:"50",color:"#dcdee0"}}),t("p",[e._v("æš‚æ— å½•åˆ¶è®°å½•")]),t("van-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$router.push("/products")}}},[e._v(" å»ä½“éªŒå½•åˆ¶åŠŸèƒ½ ")])],1):e._e()],1)],1)}),Ee=[];class Me{constructor(e={}){this.events=[],this.isRecording=!1,this.stopRecording=null,this.metadata={},this.options={uploadUrl:"/api/record/upload",autoUpload:!0,compressData:!0,maxFileSize:10485760,...e},console.log("ScreenRecorderåˆå§‹åŒ–å®Œæˆï¼Œé…ç½®:",this.options)}async startRecording(e={}){if(this.isRecording)return console.log("å½•åˆ¶å·²åœ¨è¿›è¡Œä¸­"),!0;try{if(console.log("å¼€å§‹å½•åˆ¶ï¼Œå…ƒæ•°æ®:",e),this.metadata=e,this.events=[],"undefined"===typeof window.rrweb)throw new Error("rrwebåº“æœªæ‰¾åˆ°ï¼Œè¯·ç¡®ä¿å·²æ­£ç¡®å¼•å…¥");return this.stopRecording=window.rrweb.record({emit:e=>{this.events.push(e)},checkoutEveryNms:3e4,recordCanvas:!0,collectFonts:!0,inlineStylesheet:!0}),this.isRecording=!0,console.log("å½•åˆ¶å¼€å§‹æˆåŠŸ"),!0}catch(t){return console.error("å¼€å§‹å½•åˆ¶å¤±è´¥:",t),this.isRecording=!1,!1}}async stopRecording(){if(!this.isRecording)return console.log("æ²¡æœ‰æ­£åœ¨è¿›è¡Œçš„å½•åˆ¶"),null;try{console.log("åœæ­¢å½•åˆ¶..."),this.stopRecording&&(this.stopRecording(),this.stopRecording=null),this.isRecording=!1;const e={events:[...this.events],metadata:this.metadata,timestamp:Date.now(),duration:0,eventsCount:this.events.length};if(console.log("å½•åˆ¶åœæ­¢æˆåŠŸï¼Œäº‹ä»¶æ•°é‡:",this.events.length),this.options.autoUpload&&this.events.length>0){console.log("è‡ªåŠ¨ä¸Šä¼ å½•åˆ¶æ•°æ®...");const t=await this.uploadRecording(e);e.uploadResult=t}return this.events=[],this.metadata={},e}catch(e){return console.error("åœæ­¢å½•åˆ¶å¤±è´¥:",e),this.isRecording=!1,null}}async uploadRecording(e){try{console.log("å‡†å¤‡ä¸Šä¼ å½•åˆ¶æ•°æ®ï¼Œäº‹ä»¶æ•°é‡:",e.events.length);let t=e;this.options.compressData&&(console.log("å¼€å§‹å‹ç¼©å½•åˆ¶æ•°æ®..."),t=await this.compressRecordingData(e),console.log("æ•°æ®å‹ç¼©å®Œæˆ"));const s=this.getDataSize(t);s>this.options.maxFileSize&&console.warn("å½•åˆ¶æ•°æ®è¿‡å¤§:",this.formatFileSize(s)),console.log("ä¸Šä¼ æ•°æ®å¤§å°:",this.formatFileSize(s));const r=await this.mockUpload(t);return console.log("ä¸Šä¼ å®Œæˆ:",r),r}catch(t){return console.error("ä¸Šä¼ å½•åˆ¶æ•°æ®å¤±è´¥:",t),{success:!1,error:t.message}}}async compressRecordingData(e){try{if("undefined"===typeof window.pako)throw new Error("pakoå‹ç¼©åº“æœªæ‰¾åˆ°ï¼Œè¯·ç¡®ä¿å·²æ­£ç¡®å¼•å…¥");const t=JSON.stringify(e),s=new Blob([t]).size;console.log("åŸå§‹æ•°æ®å¤§å°:",this.formatFileSize(s));const r=window.pako.gzip(t),a=r.length;return console.log("å‹ç¼©åå¤§å°:",this.formatFileSize(a)),console.log("å‹ç¼©ç‡:",(100*(1-a/s)).toFixed(2)+"%"),{...e,compressed:!0,originalSize:s,compressedSize:a,compressedData:Array.from(r)}}catch(t){return console.error("å‹ç¼©æ•°æ®å¤±è´¥:",t),e}}async mockUpload(e){return await new Promise((e=>setTimeout(e,1e3+2e3*Math.random()))),{success:!0,uploadId:"upload_"+Date.now(),timestamp:Date.now(),message:"å½•åˆ¶æ•°æ®ä¸Šä¼ æˆåŠŸ"}}getDataSize(e){const t=JSON.stringify(e);return new Blob([t]).size}formatFileSize(e){if(0===e)return"0 B";const t=1024,s=["B","KB","MB","GB"],r=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,r)).toFixed(2))+" "+s[r]}addCustomEvent(e){this.isRecording&&this.events.push({type:5,timestamp:Date.now(),data:{tag:"custom",payload:e}})}getRecordingStatus(){return{isRecording:this.isRecording,eventsCount:this.events.length,metadata:this.metadata}}}var Be=Me,Le={name:"RecordPlayer",data(){return{records:[{id:1,title:"ç¨³å¥å¢é•¿ç†è´¢äº§å“ - è´­ä¹°æµç¨‹",description:"2024-01-15 14:30:25 | ç”¨æˆ·æ“ä½œå½•åˆ¶",duration:"2åˆ†30ç§’",action:"purchase",productId:1,events:[]},{id:2,title:"å¹³è¡¡é…ç½®ç†è´¢äº§å“ - èµå›æµç¨‹",description:"2024-01-15 16:45:12 | ç”¨æˆ·æ“ä½œå½•åˆ¶",duration:"1åˆ†45ç§’",action:"redeem",productId:2,events:[]}],currentRecord:null,player:null,isPlaying:!1}},methods:{async playRecord(e){this.currentRecord=e,await this.$nextTick();try{let t=e.events;if(e.compressed&&(t=Be.decompressData(e)),t&&0!==t.length||(t=this.generateDemoEvents()),t.length<2&&(t=this.generateDemoEvents()),"undefined"===typeof window.rrwebPlayer)throw new Error("rrweb-playeråº“æœªæ‰¾åˆ°ï¼Œè¯·ç¡®ä¿å·²æ­£ç¡®å¼•å…¥");this.player=new window.rrwebPlayer({target:this.$refs.playerContainer,props:{events:t,width:375,height:667,autoPlay:!1,showController:!0,tags:{"virtual-styles":{"background-color":"#f7f8fa"}}}}),setTimeout((()=>{const e=this.$refs.playerContainer.querySelectorAll("iframe");e.forEach((e=>{e.hasAttribute("sandbox")&&(console.log("ä¿®å¤RecordPlayer iframe sandboxæƒé™"),e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups allow-modals"))}))}),100),this.isPlaying=!1,this.$toast.success("å½•åˆ¶åŠ è½½æˆåŠŸ")}catch(t){console.error("æ’­æ”¾å½•åˆ¶å¤±è´¥:",t),this.$toast.fail("æ’­æ”¾å¤±è´¥: "+t.message)}},togglePlay(){if(this.player)try{this.isPlaying?this.player.pause():this.player.play(),this.isPlaying=!this.isPlaying}catch(e){console.error("æ’­æ”¾æ§åˆ¶å¤±è´¥:",e),this.$toast.fail("æ’­æ”¾æ§åˆ¶å¤±è´¥")}},resetPlayer(){if(this.player)try{this.player.goto(0),this.isPlaying=!1}catch(e){console.error("é‡ç½®æ’­æ”¾å™¨å¤±è´¥:",e)}},closePlayer(){if(this.player){try{this.player.destroy()}catch(e){console.error("é”€æ¯æ’­æ”¾å™¨å¤±è´¥:",e)}this.player=null}this.currentRecord=null,this.isPlaying=!1},generateDemoEvents(){const e=Date.now();return[{type:4,data:{href:window.location.origin,width:375,height:667},timestamp:e-5e3},{type:2,data:{node:{type:0,childNodes:[{type:1,name:"html",publicId:"",systemId:"",id:2},{type:2,tagName:"html",attributes:{lang:"zh-CN"},childNodes:[{type:2,tagName:"head",attributes:{},childNodes:[{type:2,tagName:"title",attributes:{},childNodes:[{type:3,textContent:"ç†è´¢äº§å“å½•åˆ¶æ¼”ç¤º",id:5}],id:4}],id:3},{type:2,tagName:"body",attributes:{style:"margin: 0; padding: 20px; font-family: Arial, sans-serif; background-color: #f7f8fa;"},childNodes:[{type:2,tagName:"div",attributes:{style:"text-align: center; padding: 40px 20px; background: white; border-radius: 8px; margin: 20px 0;"},childNodes:[{type:2,tagName:"h2",attributes:{style:"color: #323233; margin-bottom: 20px;"},childNodes:[{type:3,textContent:"ç†è´¢äº§å“å½•åˆ¶æ¼”ç¤º",id:8}],id:7},{type:2,tagName:"p",attributes:{style:"color: #969799; margin-bottom: 30px;"},childNodes:[{type:3,textContent:"è¿™æ˜¯ä¸€ä¸ªæ¼”ç¤ºå½•åˆ¶å›æ”¾çš„ç¤ºä¾‹",id:10}],id:9},{type:2,tagName:"button",attributes:{id:"demo-btn",style:"background: #1989fa; color: white; border: none; padding: 12px 24px; border-radius: 4px; cursor: pointer;"},childNodes:[{type:3,textContent:"ç‚¹å‡»æŒ‰é’®",id:12}],id:11}],id:6}],id:13}],id:14}],id:1}},timestamp:e-4e3},{type:3,data:{source:2,type:1,x:187,y:400},timestamp:e-3e3},{type:3,data:{source:2,type:2,x:187,y:400,id:11},timestamp:e-2e3},{type:3,data:{source:0,texts:[{id:12,value:"å·²ç‚¹å‡»ï¼"}]},timestamp:e-1e3}]}},beforeDestroy(){this.closePlayer()}},We=Le,qe=(0,l.A)(We,Oe,Ee,!1,null,"49073c18",null),je=(qe.exports,function(){var e=this,t=e._self._c;return t("RecordWrapper",{ref:"recordWrapper",attrs:{"auto-start":!0,"show-controls":!1,"stop-on-destroy":!1,"require-consent":!0,metadata:{action:"purchase-step-1",productId:e.productId,flow:"purchase-start"}},on:{"record-timeout":e.handleRecordTimeout,"timeout-confirmed":e.handleTimeoutConfirmed,"record-started":e.onRecordStarted,"record-declined":e.onRecordDeclined}},[t("div",{staticClass:"purchase-step"},[t("van-nav-bar",{attrs:{title:"ç¡®è®¤äº§å“","left-arrow":"",fixed:""},on:{"click-left":function(t){return e.$router.back()}}}),e.product?t("div",{staticClass:"content"},[t("div",{staticClass:"product-info-card"},[t("div",{staticClass:"product-header"},[t("h3",{staticClass:"product-name"},[e._v(e._s(e.product.name))]),t("div",{staticClass:"product-return"},[e._v(e._s(e.product.expectedReturn))])]),t("p",{staticClass:"product-desc"},[e._v(e._s(e.product.description))])]),t("div",{staticClass:"steps-container"},[t("van-steps",{attrs:{active:0,direction:"horizontal"}},[t("van-step",[e._v("ç¡®è®¤äº§å“")]),t("van-step",[e._v("å¡«å†™ä¿¡æ¯")]),t("van-step",[e._v("ç¡®è®¤è´­ä¹°")]),t("van-step",[e._v("è´­ä¹°å®Œæˆ")])],1)],1),t("div",{staticClass:"step-content"},[t("div",{staticClass:"step-card"},[t("h4",{staticClass:"step-title"},[e._v("äº§å“ç¡®è®¤")]),t("van-cell-group",[t("van-cell",{attrs:{title:"äº§å“åç§°",value:e.product.name}}),t("van-cell",{attrs:{title:"é¢„æœŸæ”¶ç›Šç‡",value:e.product.expectedReturn}}),t("van-cell",{attrs:{title:"èµ·è´­é‡‘é¢",value:e.product.minAmount}}),t("van-cell",{attrs:{title:"äº§å“æœŸé™",value:e.product.term}})],1),t("div",{staticClass:"step-actions"},[t("van-button",{attrs:{type:"primary",size:"large",block:"",round:""},on:{click:e.nextStep}},[e._v(" ç¡®è®¤äº§å“ä¿¡æ¯ ")])],1)],1)])]):e._e()],1)])}),He=[],Je={name:"PurchaseStepOne",components:{RecordWrapper:ve},data(){return{productId:null,product:null,products:{1:{id:1,name:"ç¨³å¥å¢é•¿ç†è´¢äº§å“",description:"ä½é£é™©ï¼Œç¨³å®šæ”¶ç›Šï¼Œé€‚åˆä¿å®ˆå‹æŠ•èµ„è€…",expectedReturn:"4.2%",minAmount:"1000å…ƒ",term:"90å¤©",image:"https://img.yzcdn.cn/vant/cat.jpeg"},2:{id:2,name:"å¹³è¡¡é…ç½®ç†è´¢äº§å“",description:"ä¸­ç­‰é£é™©ï¼Œå‡è¡¡æ”¶ç›Šï¼Œé€‚åˆç¨³å¥å‹æŠ•èµ„è€…",expectedReturn:"6.8%",minAmount:"5000å…ƒ",term:"180å¤©",image:"https://img.yzcdn.cn/vant/cat.jpeg"},3:{id:3,name:"æˆé•¿æœºä¼šç†è´¢äº§å“",description:"é«˜é£é™©é«˜æ”¶ç›Šï¼Œé€‚åˆç§¯æå‹æŠ•èµ„è€…",expectedReturn:"9.5%",minAmount:"10000å…ƒ",term:"365å¤©",image:"https://img.yzcdn.cn/vant/cat.jpeg"}}}},created(){this.loadProduct()},methods:{loadProduct(){if(this.productId=parseInt(this.$route.query.id)||parseInt(this.$route.params.id),this.product=this.products[this.productId],!this.product)return this.$toast.fail("äº§å“ä¸å­˜åœ¨"),void this.$router.back()},nextStep(){this.$router.push({name:"PurchaseStepTwo",query:{id:this.productId}})},handleRecordTimeout(){console.log("æ­¥éª¤1ï¼šå½•åˆ¶è¶…æ—¶")},handleTimeoutConfirmed(){this.$router.push("/")},onRecordStarted(){console.log("å½•åˆ¶å¼€å§‹")},onRecordDeclined(){console.log("å½•åˆ¶æ‹’ç»")}}},Ge=Je,Ke=(0,l.A)(Ge,je,He,!1,null,"4949fb18",null),Ue=Ke.exports,Ve=function(){var e=this,t=e._self._c;return t("RecordWrapper",{attrs:{"auto-start":!1,"show-controls":!1,"stop-on-destroy":!1,"require-consent":!1,metadata:{action:"purchase-step-2",productId:e.productId}},on:{"record-timeout":e.handleRecordTimeout,"timeout-confirmed":e.handleTimeoutConfirmed}},[t("div",{staticClass:"purchase-step"},[t("van-nav-bar",{attrs:{title:"å¡«å†™ä¿¡æ¯","left-arrow":"",fixed:""},on:{"click-left":function(t){return e.$router.back()}}}),e.product?t("div",{staticClass:"content"},[t("div",{staticClass:"product-info-card"},[t("div",{staticClass:"product-header"},[t("h3",{staticClass:"product-name"},[e._v(e._s(e.product.name))]),t("div",{staticClass:"product-return"},[e._v(e._s(e.product.expectedReturn))])])]),t("div",{staticClass:"steps-container"},[t("van-steps",{attrs:{active:1,direction:"horizontal"}},[t("van-step",[e._v("ç¡®è®¤äº§å“")]),t("van-step",[e._v("å¡«å†™ä¿¡æ¯")]),t("van-step",[e._v("ç¡®è®¤è´­ä¹°")]),t("van-step",[e._v("è´­ä¹°å®Œæˆ")])],1)],1),t("div",{staticClass:"step-content"},[t("div",{staticClass:"step-card"},[t("h4",{staticClass:"step-title"},[e._v("å¡«å†™è´­ä¹°ä¿¡æ¯")]),t("van-form",{ref:"purchaseForm",on:{submit:e.onFormSubmit}},[t("van-field",{attrs:{name:"amount",label:"è´­ä¹°é‡‘é¢",placeholder:"è¯·è¾“å…¥è´­ä¹°é‡‘é¢",type:"number",rules:[{required:!0,message:"è¯·å¡«å†™è´­ä¹°é‡‘é¢"}]},model:{value:e.purchaseForm.amount,callback:function(t){e.$set(e.purchaseForm,"amount",t)},expression:"purchaseForm.amount"}}),t("van-field",{attrs:{name:"bankCard",label:"é“¶è¡Œå¡å·",placeholder:"è¯·è¾“å…¥é“¶è¡Œå¡å·",rules:[{required:!0,message:"è¯·å¡«å†™é“¶è¡Œå¡å·"}]},model:{value:e.purchaseForm.bankCard,callback:function(t){e.$set(e.purchaseForm,"bankCard",t)},expression:"purchaseForm.bankCard"}}),t("van-field",{attrs:{name:"password",label:"äº¤æ˜“å¯†ç ",placeholder:"è¯·è¾“å…¥äº¤æ˜“å¯†ç ",type:"password",rules:[{required:!0,message:"è¯·å¡«å†™äº¤æ˜“å¯†ç "}]},model:{value:e.purchaseForm.password,callback:function(t){e.$set(e.purchaseForm,"password",t)},expression:"purchaseForm.password"}}),t("div",{staticClass:"step-actions"},[t("van-button",{attrs:{type:"primary",size:"large",block:"",round:""},on:{click:e.validateAndNext}},[e._v(" ä¸‹ä¸€æ­¥ ")])],1)],1)],1)])]):e._e()],1)])},Xe=[],Qe={name:"PurchaseStepTwo",components:{RecordWrapper:ve},data(){return{productId:null,product:null,purchaseForm:{amount:"",bankCard:"",password:""},products:{1:{id:1,name:"ç¨³å¥å¢é•¿ç†è´¢äº§å“",description:"ä½é£é™©ï¼Œç¨³å®šæ”¶ç›Šï¼Œé€‚åˆä¿å®ˆå‹æŠ•èµ„è€…",expectedReturn:"4.2%",minAmount:"1000å…ƒ",term:"90å¤©"},2:{id:2,name:"å¹³è¡¡é…ç½®ç†è´¢äº§å“",description:"ä¸­ç­‰é£é™©ï¼Œå‡è¡¡æ”¶ç›Šï¼Œé€‚åˆç¨³å¥å‹æŠ•èµ„è€…",expectedReturn:"6.8%",minAmount:"5000å…ƒ",term:"180å¤©"},3:{id:3,name:"æˆé•¿æœºä¼šç†è´¢äº§å“",description:"é«˜é£é™©é«˜æ”¶ç›Šï¼Œé€‚åˆç§¯æå‹æŠ•èµ„è€…",expectedReturn:"9.5%",minAmount:"10000å…ƒ",term:"365å¤©"}}}},created(){this.loadProduct(),this.loadFormData()},methods:{loadProduct(){if(this.productId=parseInt(this.$route.query.id)||parseInt(this.$route.params.id),this.product=this.products[this.productId],!this.product)return this.$toast.fail("äº§å“ä¸å­˜åœ¨"),void this.$router.back()},loadFormData(){const e=sessionStorage.getItem("purchaseForm");if(e)try{this.purchaseForm=JSON.parse(e)}catch(t){console.error("åŠ è½½è¡¨å•æ•°æ®å¤±è´¥:",t)}},saveFormData(){sessionStorage.setItem("purchaseForm",JSON.stringify(this.purchaseForm))},validateAndNext(){if(!this.purchaseForm.amount)return void this.$toast.fail("è¯·å¡«å†™è´­ä¹°é‡‘é¢");if(!this.purchaseForm.bankCard)return void this.$toast.fail("è¯·å¡«å†™é“¶è¡Œå¡å·");if(!this.purchaseForm.password)return void this.$toast.fail("è¯·å¡«å†™äº¤æ˜“å¯†ç ");const e=parseInt(this.product.minAmount.replace(/[^\d]/g,""));parseInt(this.purchaseForm.amount)<e?this.$toast.fail(`è´­ä¹°é‡‘é¢ä¸èƒ½å°‘äº${this.product.minAmount}`):this.purchaseForm.bankCard.length<16?this.$toast.fail("è¯·è¾“å…¥æ­£ç¡®çš„é“¶è¡Œå¡å·"):this.purchaseForm.password.length<6?this.$toast.fail("äº¤æ˜“å¯†ç è‡³å°‘6ä½æ•°"):(this.saveFormData(),this.$router.push({name:"PurchaseStepThree",query:{id:this.productId}}))},onFormSubmit(){this.validateAndNext()},handleRecordTimeout(){console.log("æ­¥éª¤2ï¼šå½•åˆ¶è¶…æ—¶")},handleTimeoutConfirmed(){this.$router.push("/")}},watch:{purchaseForm:{handler(){this.saveFormData()},deep:!0}}},Ye=Qe,Ze=(0,l.A)(Ye,Ve,Xe,!1,null,"3feb7eb8",null),et=Ze.exports,tt=function(){var e=this,t=e._self._c;return t("RecordWrapper",{attrs:{"auto-start":!1,"show-controls":!1,"stop-on-destroy":!1,"require-consent":!1,metadata:{action:"purchase-step-3",productId:e.productId}},on:{"record-timeout":e.handleRecordTimeout,"timeout-confirmed":e.handleTimeoutConfirmed}},[t("div",{staticClass:"purchase-step"},[t("van-nav-bar",{attrs:{title:"ç¡®è®¤è´­ä¹°","left-arrow":"",fixed:""},on:{"click-left":function(t){return e.$router.back()}}}),e.product?t("div",{staticClass:"content"},[t("div",{staticClass:"product-info-card"},[t("div",{staticClass:"product-header"},[t("h3",{staticClass:"product-name"},[e._v(e._s(e.product.name))]),t("div",{staticClass:"product-return"},[e._v(e._s(e.product.expectedReturn))])])]),t("div",{staticClass:"steps-container"},[t("van-steps",{attrs:{active:2,direction:"horizontal"}},[t("van-step",[e._v("ç¡®è®¤äº§å“")]),t("van-step",[e._v("å¡«å†™ä¿¡æ¯")]),t("van-step",[e._v("ç¡®è®¤è´­ä¹°")]),t("van-step",[e._v("è´­ä¹°å®Œæˆ")])],1)],1),t("div",{staticClass:"step-content"},[t("div",{staticClass:"step-card"},[t("h4",{staticClass:"step-title"},[e._v("ç¡®è®¤è´­ä¹°ä¿¡æ¯")]),t("van-cell-group",[t("van-cell",{attrs:{title:"äº§å“åç§°",value:e.product.name}}),t("van-cell",{attrs:{title:"è´­ä¹°é‡‘é¢",value:`Â¥${e.purchaseForm.amount}`}}),t("van-cell",{attrs:{title:"é¢„æœŸæ”¶ç›Š",value:e.expectedProfit}}),t("van-cell",{attrs:{title:"é“¶è¡Œå¡å·",value:e.maskedBankCard}})],1),t("div",{staticClass:"risk-notice"},[t("van-notice-bar",{attrs:{"left-icon":"warning-o",text:"æŠ•èµ„æœ‰é£é™©ï¼Œç†è´¢äº§å“ä¸ä¿è¯æœ¬é‡‘å’Œæ”¶ç›Šï¼Œè¿‡å¾€ä¸šç»©ä¸ä»£è¡¨æœªæ¥è¡¨ç°"}})],1),t("div",{staticClass:"step-actions"},[t("van-button",{attrs:{type:"primary",size:"large",block:"",round:"",loading:e.purchasing},on:{click:e.confirmPurchase}},[e._v(" ç¡®è®¤è´­ä¹° ")])],1)],1)])]):e._e()],1)])},st=[],rt={name:"PurchaseStepThree",components:{RecordWrapper:ve},data(){return{productId:null,product:null,purchaseForm:{amount:"",bankCard:"",password:""},purchasing:!1,products:{1:{id:1,name:"ç¨³å¥å¢é•¿ç†è´¢äº§å“",description:"ä½é£é™©ï¼Œç¨³å®šæ”¶ç›Šï¼Œé€‚åˆä¿å®ˆå‹æŠ•èµ„è€…",expectedReturn:"4.2%",minAmount:"1000å…ƒ",term:"90å¤©"},2:{id:2,name:"å¹³è¡¡é…ç½®ç†è´¢äº§å“",description:"ä¸­ç­‰é£é™©ï¼Œå‡è¡¡æ”¶ç›Šï¼Œé€‚åˆç¨³å¥å‹æŠ•èµ„è€…",expectedReturn:"6.8%",minAmount:"5000å…ƒ",term:"180å¤©"},3:{id:3,name:"æˆé•¿æœºä¼šç†è´¢äº§å“",description:"é«˜é£é™©é«˜æ”¶ç›Šï¼Œé€‚åˆç§¯æå‹æŠ•èµ„è€…",expectedReturn:"9.5%",minAmount:"10000å…ƒ",term:"365å¤©"}}}},computed:{expectedProfit(){if(!this.purchaseForm.amount||!this.product)return"Â¥0";const e=parseFloat(this.product.expectedReturn)/100,t=this.purchaseForm.amount*e;return`Â¥${t.toFixed(2)}`},maskedBankCard(){if(!this.purchaseForm.bankCard)return"";const e=this.purchaseForm.bankCard;return e.replace(/(\d{4})\d+(\d{4})/,"$1****$2")}},created(){this.loadProduct(),this.loadFormData()},methods:{loadProduct(){if(this.productId=parseInt(this.$route.query.id)||parseInt(this.$route.params.id),this.product=this.products[this.productId],!this.product)return this.$toast.fail("äº§å“ä¸å­˜åœ¨"),void this.$router.push("/")},loadFormData(){const e=sessionStorage.getItem("purchaseForm");if(e)try{this.purchaseForm=JSON.parse(e)}catch(t){console.error("åŠ è½½è¡¨å•æ•°æ®å¤±è´¥:",t),this.$toast.fail("è¡¨å•æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·é‡æ–°å¡«å†™"),this.$router.push({name:"PurchaseStepTwo",query:{id:this.productId}})}else this.$toast.fail("è¯·å…ˆå¡«å†™è´­ä¹°ä¿¡æ¯"),this.$router.push({name:"PurchaseStepTwo",query:{id:this.productId}})},async confirmPurchase(){try{const e=(await Promise.resolve().then(s.bind(s,678))).default,t=e.getInstance(),r=t.getRecordingStatus();if(!r.isRecording)return this.$toast.fail("å½•åˆ¶å·²åœæ­¢ï¼Œè¯·é‡æ–°å¼€å§‹è´­ä¹°æµç¨‹"),void this.$router.push("/")}catch(e){return console.error("æ£€æŸ¥å½•åˆ¶çŠ¶æ€å¤±è´¥:",e),void this.$toast.fail("å½•åˆ¶çŠ¶æ€æ£€æŸ¥å¤±è´¥")}this.purchasing=!0;try{await new Promise((e=>setTimeout(e,2e3)));const e="PO"+Date.now(),t=(new Date).toLocaleString(),s={orderNo:e,purchaseTime:t,productId:this.productId,productName:this.product.name,amount:this.purchaseForm.amount,expectedProfit:this.expectedProfit,bankCard:this.maskedBankCard};sessionStorage.setItem("orderInfo",JSON.stringify(s)),this.purchasing=!1,this.$router.push({name:"PurchaseStepFour",query:{id:this.productId,orderNo:e}})}catch(e){console.error("è´­ä¹°æµç¨‹å‡ºé”™:",e),this.purchasing=!1,this.$toast.fail("è´­ä¹°å¤±è´¥ï¼Œè¯·é‡è¯•")}},handleRecordTimeout(){console.log("æ­¥éª¤3ï¼šå½•åˆ¶è¶…æ—¶")},handleTimeoutConfirmed(){this.$router.push("/")}}},at=rt,ot=(0,l.A)(at,tt,st,!1,null,"166823a3",null),it=ot.exports,nt=function(){var e=this,t=e._self._c;return t("RecordWrapper",{ref:"recordWrapper",attrs:{"auto-start":!1,"show-controls":!1,"stop-on-destroy":!0,"require-consent":!1,metadata:{action:"purchase-step-4",productId:e.productId}},on:{"record-timeout":e.handleRecordTimeout,"timeout-confirmed":e.handleTimeoutConfirmed,"recording-finished":e.onRecordingFinished}},[t("div",{staticClass:"purchase-step"},[t("van-nav-bar",{attrs:{title:"è´­ä¹°å®Œæˆ","left-arrow":!1,fixed:""}}),t("div",{staticClass:"content"},[t("div",{staticClass:"steps-container"},[t("van-steps",{attrs:{active:3,direction:"horizontal"}},[t("van-step",[e._v("ç¡®è®¤äº§å“")]),t("van-step",[e._v("å¡«å†™ä¿¡æ¯")]),t("van-step",[e._v("ç¡®è®¤è´­ä¹°")]),t("van-step",[e._v("è´­ä¹°å®Œæˆ")])],1)],1),t("div",{staticClass:"step-content"},[t("div",{staticClass:"step-card success-card"},[t("div",{staticClass:"success-content"},[t("van-icon",{attrs:{name:"success",size:"50",color:"#07c160"}}),t("h3",[e._v("è´­ä¹°æˆåŠŸï¼")]),t("p",[e._v("æ‚¨å·²æˆåŠŸè´­ä¹°ç†è´¢äº§å“")]),e.orderInfo?t("van-cell-group",[t("van-cell",{attrs:{title:"è®¢å•å·",value:e.orderInfo.orderNo}}),t("van-cell",{attrs:{title:"è´­ä¹°æ—¶é—´",value:e.orderInfo.purchaseTime}}),t("van-cell",{attrs:{title:"äº§å“åç§°",value:e.orderInfo.productName}}),t("van-cell",{attrs:{title:"è´­ä¹°é‡‘é¢",value:`Â¥${e.orderInfo.amount}`}}),t("van-cell",{attrs:{title:"é¢„æœŸæ”¶ç›Š",value:e.orderInfo.expectedProfit}}),t("van-cell",{attrs:{title:"é“¶è¡Œå¡å·",value:e.orderInfo.bankCard}})],1):e._e(),t("div",{staticClass:"recording-status"},[t("h4",[e._v("å½•åˆ¶çŠ¶æ€")]),null===e.recordingResult?t("div",{staticClass:"status-loading"},[t("van-loading",{attrs:{size:"20"}}),t("span",[e._v("æ­£åœ¨å¤„ç†å½•åˆ¶æ•°æ®...")])],1):e.recordingResult&&"object"===typeof e.recordingResult&&e.recordingResult.success?t("div",{staticClass:"recording-success-section"},[t("van-notice-bar",{attrs:{type:"success",text:"å½•åˆ¶æ•°æ®å¤„ç†å¹¶ä¸Šä¼ æˆåŠŸ"}}),t("div",{staticClass:"success-info"},[t("div",{staticClass:"success-item"},[t("span",{staticClass:"label"},[e._v("äº‹ä»¶æ•°é‡:")]),t("span",{staticClass:"value"},[e._v(e._s(e.recordingResult.recordingResult?e.recordingResult.recordingResult.eventCount:e.recordingResult.data?e.recordingResult.data.finalData.totalEvents:0))])]),t("div",{staticClass:"success-item"},[t("span",{staticClass:"label"},[e._v("åŸå§‹å¤§å°:")]),t("span",{staticClass:"value"},[e._v(e._s(e.formatFileSize(e.recordingResult.data?e.recordingResult.data.sizes.original:0)))])]),t("div",{staticClass:"success-item"},[t("span",{staticClass:"label"},[e._v("å‹ç¼©å¤§å°:")]),t("span",{staticClass:"value"},[e._v(e._s(e.formatFileSize(e.recordingResult.data?e.recordingResult.data.sizes.compressed:0)))])]),t("div",{staticClass:"success-item"},[t("span",{staticClass:"label"},[e._v("å‹ç¼©ç‡:")]),t("span",{staticClass:"value"},[e._v(e._s(e.recordingResult.data?e.recordingResult.data.compressionRatio:"0%"))])]),t("div",{staticClass:"success-item"},[t("span",{staticClass:"label"},[e._v("ä¸Šä¼ çŠ¶æ€:")]),t("van-tag",{attrs:{type:e.recordingResult.uploadResult&&e.recordingResult.uploadResult.success?"success":"danger"}},[e._v(" "+e._s(e.recordingResult.uploadResult&&e.recordingResult.uploadResult.success?"æˆåŠŸ":"å¤±è´¥")+" ")])],1),e.recordingResult.uploadResult&&e.recordingResult.uploadResult.success?t("div",{staticClass:"success-item"},[t("span",{staticClass:"label"},[e._v("ä¸Šä¼ ID:")]),t("span",{staticClass:"value"},[e._v(e._s(e.recordingResult.uploadResult.uploadId||"æœªçŸ¥"))])]):e._e()]),e.recordingResult.recordingResult&&e.recordingResult.recordingResult.events?t("div",{staticClass:"replay-section"},[t("h4",[e._v("è´­ä¹°æµç¨‹å›æ”¾")]),t("div",{staticClass:"replay-controls"},[t("van-button",{attrs:{type:"primary",size:"small",disabled:e.isReplaying},on:{click:e.startReplay}},[e._v(" "+e._s(e.isReplaying?"æ­£åœ¨å›æ”¾...":"å¼€å§‹å›æ”¾")+" ")]),e.isReplaying?t("van-button",{attrs:{size:"small"},on:{click:e.stopReplay}},[e._v(" åœæ­¢å›æ”¾ ")]):e._e()],1),t("div",{staticClass:"replay-container",attrs:{id:"step-replay-container"}})]):e._e()],1):t("div",{staticClass:"recording-error-section"},[t("van-notice-bar",{attrs:{type:"danger",text:e.recordingResult?e.recordingResult.message||e.recordingResult.error||"å½•åˆ¶å¤±è´¥":"å½•åˆ¶å¤„ç†å¤±è´¥"}})],1)]),t("div",{staticClass:"step-actions"},[e.recordingResult&&"object"===typeof e.recordingResult&&e.recordingResult.success?t("van-button",{attrs:{type:"primary",size:"large",block:"",round:""},on:{click:e.goHome}},[e._v(" è¿”å›é¦–é¡µ ")]):[t("van-button",{staticStyle:{"margin-bottom":"12px"},attrs:{type:"primary",size:"large",block:"",round:""},on:{click:e.goToProducts}},[e._v(" é‡æ–°å¼€å§‹å½•åˆ¶ ")]),t("van-button",{attrs:{type:"default",size:"large",block:"",round:""},on:{click:e.goHome}},[e._v(" è¿”å›é¦–é¡µ ")])]],2)],1)])])])],1)])},lt=[],ct=s(9268),dt={name:"PurchaseStepFour",components:{RecordWrapper:ve,[ct.A.name]:ct.A},data(){return{productId:null,orderInfo:null,recordingResult:null,isReplaying:!1,replayPlayer:null}},watch:{recordingResult:{handler(e,t){console.log("è´­ä¹°å®Œæˆé¡µé¢ï¼šrecordingResultå‘ç”Ÿå˜åŒ–"),console.log("è´­ä¹°å®Œæˆé¡µé¢ï¼šæ—§å€¼:",t),console.log("è´­ä¹°å®Œæˆé¡µé¢ï¼šæ–°å€¼:",e),console.log("è´­ä¹°å®Œæˆé¡µé¢ï¼šæ–°å€¼ç±»å‹:",typeof e),e&&console.log("è´­ä¹°å®Œæˆé¡µé¢ï¼šæ–°å€¼çš„å±æ€§:",Object.keys(e))},immediate:!0,deep:!0}},async mounted(){this.loadOrderInfo(),setTimeout((()=>{this.finishRecording()}),1500)},beforeDestroy(){this.stopReplay()},methods:{loadOrderInfo(){this.productId=parseInt(this.$route.query.id)||parseInt(this.$route.params.id);const e=sessionStorage.getItem("orderInfo");if(e)try{this.orderInfo=JSON.parse(e)}catch(t){console.error("åŠ è½½è®¢å•ä¿¡æ¯å¤±è´¥:",t)}this.orderInfo||(this.$toast.fail("è®¢å•ä¿¡æ¯ä¸¢å¤±"),this.$router.push("/"))},async finishRecording(){try{if(console.log("è´­ä¹°å®Œæˆé¡µé¢ï¼šå¼€å§‹å®Œæˆå½•åˆ¶..."),this.$refs.recordWrapper&&"function"===typeof this.$refs.recordWrapper.finishRecording){console.log("è´­ä¹°å®Œæˆé¡µé¢ï¼šå‡†å¤‡è°ƒç”¨RecordWrapper.finishRecording");const e=await this.$refs.recordWrapper.finishRecording({purchaseInfo:{...this.orderInfo,timestamp:Date.now(),page:"PurchaseStepFour",action:"purchase-completed"}});console.log("è´­ä¹°å®Œæˆé¡µé¢ï¼šRecordWrapper.finishRecordingè¿”å›ç»“æœ:",e),console.log("è´­ä¹°å®Œæˆé¡µé¢ï¼šç»“æœç±»å‹:",typeof e),e&&"object"===typeof e&&(this.recordingResult=e)}else console.warn("RecordWrapperç»„ä»¶æˆ–finishRecordingæ–¹æ³•ä¸å¯ç”¨"),this.recordingResult={success:!1,error:"å½•åˆ¶ç»„ä»¶ä¸å¯ç”¨",message:"å½•åˆ¶ç»„ä»¶ä¸å¯ç”¨ï¼Œè¯·é‡æ–°å¼€å§‹å½•åˆ¶æµç¨‹"}}catch(e){console.error("è´­ä¹°å®Œæˆé¡µé¢ï¼šå®Œæˆå½•åˆ¶å¤±è´¥:",e),this.recordingResult={success:!1,error:e.message,message:"å½•åˆ¶å®Œæˆå¤±è´¥: "+e.message}}},formatFileSize(e){if(0===e)return"0 B";const t=1024,s=["B","KB","MB","GB"],r=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,r)).toFixed(2))+" "+s[r]},goToProducts(){sessionStorage.removeItem("purchaseForm"),sessionStorage.removeItem("orderInfo"),this.$router.push("/")},goHome(){sessionStorage.removeItem("purchaseForm"),sessionStorage.removeItem("orderInfo"),this.$router.push("/")},handleRecordTimeout(){console.log("æ­¥éª¤4ï¼šå½•åˆ¶è¶…æ—¶")},handleTimeoutConfirmed(){this.$router.push("/")},onRecordingFinished(e){console.log("è´­ä¹°å®Œæˆé¡µé¢ï¼šæ”¶åˆ°å½•åˆ¶å®Œæˆäº‹ä»¶:",e),console.log("è´­ä¹°å®Œæˆé¡µé¢ï¼šresultç±»å‹:",typeof e),console.log("è´­ä¹°å®Œæˆé¡µé¢ï¼šresult.success:",e?e.success:"resultä¸ºç©º"),e&&"object"===typeof e?(this.recordingResult=e,e.success?this.$toast.success("å½•åˆ¶å®Œæˆå¹¶ä¸Šä¼ æˆåŠŸ"):this.$toast.fail("å½•åˆ¶å®Œæˆå¤±è´¥: "+(e.message||e.error))):(console.error("è´­ä¹°å®Œæˆé¡µé¢ï¼šæ”¶åˆ°æ— æ•ˆçš„å½•åˆ¶ç»“æœ:",e),this.recordingResult={success:!1,error:"æ”¶åˆ°æ— æ•ˆçš„å½•åˆ¶ç»“æœ",message:"å½•åˆ¶æ•°æ®æ ¼å¼é”™è¯¯"},this.$toast.fail("å½•åˆ¶æ•°æ®æ ¼å¼é”™è¯¯"))},async startReplay(){if(this.recordingResult&&this.recordingResult.recordingResult&&this.recordingResult.recordingResult.events)try{this.isReplaying=!0;const e=document.getElementById("step-replay-container");if(!e)throw new Error("å›æ”¾å®¹å™¨æœªæ‰¾åˆ°");e.innerHTML="",e.style.width="100%",e.style.height="600px",e.style.position="relative",e.style.overflow="visible",e.style.border="1px solid #eee",e.style.borderRadius="4px",e.style.backgroundColor="#f5f5f5",console.log("PurchaseStepFourï¼šå¼€å§‹å›æ”¾ï¼Œäº‹ä»¶æ•°é‡:",this.recordingResult.recordingResult.events.length);const t=this.recordingResult.recordingResult.events;if(!Array.isArray(t)||t.length<2)throw new Error("å½•åˆ¶æ•°æ®æ ¼å¼ä¸æ­£ç¡®æˆ–äº‹ä»¶å¤ªå°‘");const s=t.some((e=>4===e.type)),r=t.some((e=>2===e.type));if(!s||!r)throw new Error("å½•åˆ¶æ•°æ®ç¼ºå°‘å¿…è¦çš„å…ƒä¿¡æ¯æˆ–å¿«ç…§");if("undefined"===typeof window.rrwebPlayer)throw new Error("rrweb-playeråº“æœªæ‰¾åˆ°ï¼Œè¯·ç¡®ä¿å·²æ­£ç¡®å¼•å…¥");const a=window.rrwebPlayer;console.log("PurchaseStepFourï¼šåˆ›å»ºrrweb-player"),this.replayPlayer=new a({target:e,props:{events:t,width:e.offsetWidth||375,height:550,autoPlay:!1,showController:!0,showWarning:!1,showDebug:!1,speed:1,speedOption:[.5,1,1.5,2,4],skipInactive:!1,mouseTail:!1,tags:{"virtual-styles":{}}}}),console.log("PurchaseStepFourï¼šrrweb-playeråˆ›å»ºæˆåŠŸ"),setTimeout((()=>{const t=e.querySelectorAll("iframe");t.forEach((e=>{e.hasAttribute("sandbox")&&e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups allow-modals"),e.style.width="100%",e.style.height="100%",e.style.border="none"})),console.log("PurchaseStepFourï¼šå·²å®Œæˆå›æ”¾å™¨åˆå§‹åŒ–")}),500),this.replayPlayer&&this.replayPlayer.$on&&(this.replayPlayer.$on("finish",(()=>{this.isReplaying=!1,console.log("PurchaseStepFourï¼šå›æ”¾å®Œæˆ")})),this.replayPlayer.$on("start",(()=>{console.log("PurchaseStepFourï¼šå›æ”¾å¼€å§‹")}))),this.$toast.success("å¼€å§‹å›æ”¾è´­ä¹°æµç¨‹")}catch(e){console.error("PurchaseStepFourï¼šå›æ”¾å¤±è´¥:",e),this.isReplaying=!1,this.$toast.fail("å›æ”¾å¤±è´¥: "+e.message);const t=document.getElementById("step-replay-container");t&&(t.innerHTML=`\n            <div style="text-align: center; padding: 50px; color: #f56c6c; background: white;">\n              <h4>å›æ”¾å¤±è´¥</h4>\n              <p style="font-size: 12px; margin-top: 10px;">${e.message}</p>\n              <p style="font-size: 10px; color: #999; margin-top: 10px;">\n                äº‹ä»¶æ•°é‡: ${this.recordingResult.recordingResult&&this.recordingResult.recordingResult.events?this.recordingResult.recordingResult.events.length:0}\n              </p>\n            </div>\n          `)}else this.$toast.fail("æ²¡æœ‰å½•åˆ¶æ•°æ®å¯å›æ”¾")},stopReplay(){if(this.replayPlayer)try{this.replayPlayer.$destroy&&this.replayPlayer.$destroy(),this.replayPlayer=null}catch(t){console.error("åœæ­¢å›æ”¾å¤±è´¥:",t)}this.isReplaying=!1;const e=document.getElementById("step-replay-container");e&&(e.innerHTML='<div style="text-align: center; padding: 50px; color: #999;">å›æ”¾å·²åœæ­¢</div>')}}},ut=dt,pt=(0,l.A)(ut,nt,lt,!1,null,"0d9f8de5",null),ht=pt.exports;r.Ay.use(u.Ay);const mt=[{path:"/",name:"ProductList",component:be,meta:{title:"äº§å“åˆ—è¡¨"}},{path:"/purchase-step/1",name:"PurchaseStepOne",component:Ue,meta:{title:"ç¡®è®¤äº§å“"}},{path:"/purchase-step/2",name:"PurchaseStepTwo",component:et,meta:{title:"å¡«å†™ä¿¡æ¯"}},{path:"/purchase-step/3",name:"PurchaseStepThree",component:it,meta:{title:"ç¡®è®¤è´­ä¹°"}},{path:"/purchase-step/4",name:"PurchaseStepFour",component:ht,meta:{title:"è´­ä¹°å®Œæˆ"}},{path:"/index",redirect:"/"},{path:"*",redirect:"/"}],gt=new u.Ay({mode:"hash",base:"/moblie-rrweb-record/",routes:mt});gt.beforeEach(((e,t,s)=>{e.meta&&e.meta.title&&(document.title=e.meta.title+" - Vueå½•åˆ¶ç³»ç»Ÿ"),s()}));var vt=gt,yt=s(4917),ft=s(4349),Rt=s(4e3),bt=s(2282),wt=s(1564),Ct=s(6070),_t=s(7396),kt=s(8393),$t=s(3598),Pt=s(8946),xt=s(3288),St=s(5183),Tt=s(8630),Ft=s(7087),zt=s(5585),Dt=s(1392),At=s(168),It=s(2458),Nt=s(6514),Ot=s(2860),Et=s(6110),Mt=s(1828),Bt=s(4806),Lt=s(4197);s(2241);r.Ay.config.productionTip=!1,r.Ay.use(yt.A),r.Ay.use(ft.A),r.Ay.use(Rt.A),r.Ay.use(bt.A),r.Ay.use(wt.A),r.Ay.use(Ct.A),r.Ay.use(_t.A),r.Ay.use(kt.A),r.Ay.use($t.A),r.Ay.use(ct.A),r.Ay.use(Pt.A),r.Ay.use(xt.A),r.Ay.use(St.A),r.Ay.use(Tt.A),r.Ay.use(Ft.A),r.Ay.use(zt.A),r.Ay.use(Dt.A),r.Ay.use(At.A),r.Ay.use(It.A),r.Ay.use(Nt.A),r.Ay.use(Ot.A),r.Ay.use(Et.A),r.Ay.use(Mt.A),r.Ay.use(Bt.A),r.Ay.use(Lt.A),new r.Ay({router:vt,render:e=>e(d)}).$mount("#app")}},t={};function s(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,s),o.exports}s.m=e,function(){var e=[];s.O=function(t,r,a,o){if(!r){var i=1/0;for(d=0;d<e.length;d++){r=e[d][0],a=e[d][1],o=e[d][2];for(var n=!0,l=0;l<r.length;l++)(!1&o||i>=o)&&Object.keys(s.O).every((function(e){return s.O[e](r[l])}))?r.splice(l--,1):(n=!1,o<i&&(i=o));if(n){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[r,a,o]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,r){var a,o,i=r[0],n=r[1],l=r[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(a in n)s.o(n,a)&&(s.m[a]=n[a]);if(l)var d=l(s)}for(t&&t(r);c<i.length;c++)o=i[c],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(d)},r=self["webpackChunkvue_record_project"]=self["webpackChunkvue_record_project"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=s.O(void 0,[504],(function(){return s(6164)}));r=s.O(r)})();
//# sourceMappingURL=app.d8229a4d.js.map